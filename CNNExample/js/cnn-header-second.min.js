!function(n){function e(e){for(var t,o,r=e[0],a=e[1],s=0,d=[];s<r.length;s++)o=r[s],i[o]&&d.push(i[o][0]),i[o]=0;for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(n[t]=a[t]);for(l&&l(e);d.length;)d.shift()()}var t={},i={6:0};function o(e){if(t[e])return t[e].exports;var i=t[e]={i:e,l:!1,exports:{}};return n[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.e=function(n){var e=[],t=i[n];if(0!==t)if(t)e.push(t[2]);else{var r=new Promise(function(e,o){t=i[n]=[e,o]});e.push(t[2]=r);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(n){return o.p+"chunks/"+({}[n]||n)+".min.js"}(n),a=function(e){s.onerror=s.onload=null,clearTimeout(l);var t=i[n];if(0!==t){if(t){var o=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src,a=new Error("Loading chunk "+n+" failed.\n("+o+": "+r+")");a.type=o,a.request=r,t[1](a)}i[n]=void 0}};var l=setTimeout(function(){a({type:"timeout",target:s})},12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(e)},o.m=n,o.c=t,o.d=function(n,e,t){o.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},o.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,e){if(1&e&&(n=o(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var i in n)o.d(t,i,function(e){return n[e]}.bind(null,i));return t},o.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(e,"a",e),e},o.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},o.p="/.asset/2.135.9/js/",o.oe=function(n){throw console.error(n),n};var r=window.webpackJsonp=window.webpackJsonp||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var s=0;s<r.length;s++)e(r[s]);var l=a;o(o.s=397)}({13:function(n,e){function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}CNN.Features=CNN.Features||{},CNN.VideoConfig=CNN.VideoConfig||{},CNN.VideoConfig.liveStream=CNN.VideoConfig.liveStream||{},CNN.GeoCheck=function(n,e){"use strict";var i,o,r,a=null;return CNN._geoCheckReadyEvent=!1,n.fn.extend({onGeoCheckReady:function(i){"function"==typeof i&&(!0===CNN._geoCheckReadyEvent?i(n):n(e).on("geoCheckReady",{handler:i},function(e){"object"===t((e=e||{}).data)&&null!==e.data&&"function"==typeof e.data.handler&&e.data.handler(n)}))},triggerGeoCheckReady:function(){CNN._geoCheckReadyEvent=!0,n(e).trigger("geoCheckReady")}}),null!==(r=CNN.Utils.getCookie("geoData"))&&(i=r.split("|")).length>4&&((a={city:"?"===i[0]?"":i[0],region:"?"===i[1]?"":i[1].toUpperCase(),postCode:"?"===i[2]?"":i[2].toUpperCase(),country:"?"===i[3]?"":i[3].toUpperCase(),continent:"?"===i[4]?"":i[4].toUpperCase()}).inGDPR=-1!==a.country.search(/^(GB|DE|FR|IT|ES|PL|RO|NL|BE|GR|CZ|PT|SE|HU|AT|BG|DK|FI|SK|IE|HR|LT|SI|LV|EE|CY|LU|MT|NO|IS|LI)$/)),0!==(o=e.getElementsByTagName("html")).length&&o[0].classList.add(a&&!0===a.inGDPR?"gdpr":"no-gdpr"),n(e).triggerGeoCheckReady(),{getData:function(){return a},inTarget:function(n){var e,t,i,o,r,s=!0;if(null!==a&&!0===Array.isArray(n)&&n.length>0)for(o=(i=a.country+":"+a.region)+":"+a.city.toLowerCase(),e=0;e<n.length;e++)"-"===(r=n[e]).charAt(0)?(r=r.slice(1),t=!1):t=!0,"*"===r?s=t:"#"===r.charAt(0)?a.continent===r.slice(1)&&(s=t):(2===r.length&&a.country===r||5===r.length&&i===r||r.length>6&&o===r)&&(s=t);return s},isReady:function(){return CNN._geoCheckReadyEvent}}}(jQuery,document)},150:function(n,e){Modernizr.addTest("ios",function(){"use strict";return!!navigator.userAgent.match(/(iPod|iPhone|iPad)/i)}),Modernizr.addTest("android",function(){"use strict";return!!navigator.userAgent.match(/android/i)}),Modernizr.addTest("windows",function(){"use strict";return!!navigator.platform.match(/Win/i)}),Modernizr.addTest("iospre10",function(){"use strict";return-1!==navigator.userAgent.search(/(iPod|iPhone|iPad).*OS [3-9]/i)}),Modernizr.addTest("iemobile",function(){"use strict";return!!navigator.userAgent.match(/iemobile/i)}),Modernizr.addTest("ieunsupported",function(){"use strict";return navigator.userAgent.search(/MSIE ([2-9]|10)\./i)>=0}),Modernizr.addTest("ie11unsupported",function(){"use strict";return navigator.userAgent.search(/Trident\/7\.0;(.*)rv:11\./i)>=0}),Modernizr.addTest("ie",function(){"use strict";return navigator.userAgent.search(/\s+(MSIE|rv:11|Edge\/\d+\.)/)>=0}),Modernizr.addTest("edge",function(){"use strict";return navigator.userAgent.search(/\s+(Edge\/\d+\.)/)>=0}),Modernizr.addTest("chrome",function(){"use strict";return!(-1===navigator.userAgent.search(/\s+(Chrome\/\d+\.)/)||!navigator.vendor||!/Google Inc/.test(navigator.vendor))})},151:function(n,e,t){var i;
/*! picturefill - v3.0.2 - 2016-02-12
 * https://scottjehl.github.io/picturefill/
 * Copyright (c) 2016 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT
 */
/*! Gecko-Picture - v1.0
 * https://github.com/scottjehl/picturefill/tree/3.0/src/plugins/gecko-picture
 * Firefox's early picture implementation (prior to FF41) is static and does
 * not react to viewport changes. This tiny module fixes this.
 */
/*! picturefill - v3.0.2 - 2016-02-12
 * https://scottjehl.github.io/picturefill/
 * Copyright (c) 2016 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT
 */
/*! Gecko-Picture - v1.0
 * https://github.com/scottjehl/picturefill/tree/3.0/src/plugins/gecko-picture
 * Firefox's early picture implementation (prior to FF41) is static and does
 * not react to viewport changes. This tiny module fixes this.
 */
!function(n){var e,t,i,o,r,a,s,l=navigator.userAgent;n.HTMLPictureElement&&/ecko/.test(l)&&l.match(/rv\:(\d+)/)&&RegExp.$1<45&&addEventListener("resize",(t=document.createElement("source"),i=function(n){var e,i,o=n.parentNode;"PICTURE"===o.nodeName.toUpperCase()?(e=t.cloneNode(),o.insertBefore(e,o.firstElementChild),setTimeout(function(){o.removeChild(e)})):(!n._pfLastSize||n.offsetWidth>n._pfLastSize)&&(n._pfLastSize=n.offsetWidth,i=n.sizes,n.sizes+=",100vw",setTimeout(function(){n.sizes=i}))},o=function(){var n,e=document.querySelectorAll("picture > img, img[srcset][sizes]");for(n=0;n<e.length;n++)i(e[n])},r=function(){clearTimeout(e),e=setTimeout(o,99)},a=n.matchMedia&&matchMedia("(orientation: landscape)"),s=function(){r(),a&&a.addListener&&a.addListener(r)},t.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?s():document.addEventListener("DOMContentLoaded",s),r))}(window),
/*! Picturefill - v3.0.2
 * http://scottjehl.github.io/picturefill
 * Copyright (c) 2015 https://github.com/scottjehl/picturefill/blob/master/Authors.txt;
 *  License: MIT
 */
function(o,r,a){"use strict";var s,l,d;r.createElement("picture");var u={},c=!1,g=function(){},p=r.createElement("img"),f=p.getAttribute,m=p.setAttribute,h=p.removeAttribute,_=r.documentElement,v={},I={algorithm:""},w=navigator.userAgent,y=/rident/.test(w)||/ecko/.test(w)&&w.match(/rv\:(\d+)/)&&RegExp.$1>35,b="currentSrc",E=/\s+\+?\d+(e\d+)?w/,T=/(\([^)]+\))?\s*(.+)/,O=o.picturefillCFG,A="font-size:100%!important;",S=!0,C={},D={},k=o.devicePixelRatio,P={px:1,in:96},R=r.createElement("a"),N=!1,M=/^[ \t\n\r\u000c]+/,U=/^[, \t\n\r\u000c]+/,x=/^[^ \t\n\r\u000c]+/,F=/[,]+$/,L=/^\d+$/,B=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,j=function(n,e,t,i){n.addEventListener?n.addEventListener(e,t,i||!1):n.attachEvent&&n.attachEvent("on"+e,t)},V=function(n){var e={};return function(t){return t in e||(e[t]=n(t)),e[t]}};function z(n){return" "===n||"\t"===n||"\n"===n||"\f"===n||"\r"===n}var G,K,q,H,Q,Y,W,Z,J,X,$,nn,en,tn,on,rn,an=(G=/^([\d\.]+)(em|vw|px)$/,K=V(function(n){return"return "+function(){for(var n=arguments,e=0,t=n[0];++e in n;)t=t.replace(n[e],n[++e]);return t}((n||"").toLowerCase(),/\band\b/g,"&&",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1>=",/max-([a-z-\s]+):/g,"e.$1<=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/gi,"")+";"}),function(n,e){var t;if(!(n in C))if(C[n]=!1,e&&(t=n.match(G)))C[n]=t[1]*P[t[2]];else try{C[n]=new Function("e",K(n))(P)}catch(n){}return C[n]}),sn=function(n,e){return n.w?(n.cWidth=u.calcListLength(e||"100vw"),n.res=n.w/n.cWidth):n.res=n.d,n},ln=function(n){if(c){var e,t,i,o=n||{};if(o.elements&&1===o.elements.nodeType&&("IMG"===o.elements.nodeName.toUpperCase()?o.elements=[o.elements]:(o.context=o.elements,o.elements=null)),i=(e=o.elements||u.qsa(o.context||r,o.reevaluate||o.reselect?u.sel:u.selShort)).length){for(u.setupRun(o),N=!0,t=0;t<i;t++)u.fillImg(e[t],o);u.teardownRun(o)}}};function dn(n,e){return n.res-e.res}function un(n,e){var t,i,o;if(n&&e)for(o=u.parseSet(e),n=u.makeUrl(n),t=0;t<o.length;t++)if(n===u.makeUrl(o[t].url)){i=o[t];break}return i}o.console&&console.warn,b in p||(b="src"),v["image/jpeg"]=!0,v["image/gif"]=!0,v["image/png"]=!0,v["image/svg+xml"]=r.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),u.ns=("pf"+(new Date).getTime()).substr(0,9),u.supSrcset="srcset"in p,u.supSizes="sizes"in p,u.supPicture=!!o.HTMLPictureElement,u.supSrcset&&u.supPicture&&!u.supSizes&&(q=r.createElement("img"),p.srcset="data:,a",q.src="data:,a",u.supSrcset=p.complete===q.complete,u.supPicture=u.supSrcset&&u.supPicture),u.supSrcset&&!u.supSizes?(H="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Q=r.createElement("img"),Y=function(){2===Q.width&&(u.supSizes=!0),l=u.supSrcset&&!u.supSizes,c=!0,setTimeout(ln)},Q.onload=Y,Q.onerror=Y,Q.setAttribute("sizes","9px"),Q.srcset=H+" 1w,data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw== 9w",Q.src=H):c=!0,u.selShort="picture>img,img[srcset]",u.sel=u.selShort,u.cfg=I,u.DPR=k||1,u.u=P,u.types=v,u.setSize=g,u.makeUrl=V(function(n){return R.href=n,R.href}),u.qsa=function(n,e){return"querySelector"in n?n.querySelectorAll(e):[]},u.matchesMedia=function(){return o.matchMedia&&(matchMedia("(min-width: 0.1em)")||{}).matches?u.matchesMedia=function(n){return!n||matchMedia(n).matches}:u.matchesMedia=u.mMQ,u.matchesMedia.apply(this,arguments)},u.mMQ=function(n){return!n||an(n)},u.calcLength=function(n){var e=an(n,!0)||!1;return e<0&&(e=!1),e},u.supportsType=function(n){return!n||v[n]},u.parseSize=V(function(n){var e=(n||"").match(T);return{media:e&&e[1],length:e&&e[2]}}),u.parseSet=function(n){return n.cands||(n.cands=function(n,e){function t(e){var t,i=e.exec(n.substring(d));if(i)return t=i[0],d+=t.length,t}var i,o,r,a,s,l=n.length,d=0,u=[];function c(){var n,t,r,a,s,l,d,c,g,p=!1,f={};for(a=0;a<o.length;a++)l=(s=o[a])[s.length-1],d=s.substring(0,s.length-1),c=parseInt(d,10),g=parseFloat(d),L.test(d)&&"w"===l?((n||t)&&(p=!0),0===c?p=!0:n=c):B.test(d)&&"x"===l?((n||t||r)&&(p=!0),g<0?p=!0:t=g):L.test(d)&&"h"===l?((r||t)&&(p=!0),0===c?p=!0:r=c):p=!0;p||(f.url=i,n&&(f.w=n),t&&(f.d=t),r&&(f.h=r),r||t||n||(f.d=1),1===f.d&&(e.has1x=!0),f.set=e,u.push(f))}function g(){for(t(M),r="",a="in descriptor";;){if(s=n.charAt(d),"in descriptor"===a)if(z(s))r&&(o.push(r),r="",a="after descriptor");else{if(","===s)return d+=1,r&&o.push(r),void c();if("("===s)r+=s,a="in parens";else{if(""===s)return r&&o.push(r),void c();r+=s}}else if("in parens"===a)if(")"===s)r+=s,a="in descriptor";else{if(""===s)return o.push(r),void c();r+=s}else if("after descriptor"===a)if(z(s));else{if(""===s)return void c();a="in descriptor",d-=1}d+=1}}for(;;){if(t(U),d>=l)return u;i=t(x),o=[],","===i.slice(-1)?(i=i.replace(F,""),c()):g()}}(n.srcset,n)),n.cands},u.getEmValue=function(){var n;if(!s&&(n=r.body)){var e=r.createElement("div"),t=_.style.cssText,i=n.style.cssText;e.style.cssText="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",_.style.cssText=A,n.style.cssText=A,n.appendChild(e),s=e.offsetWidth,n.removeChild(e),s=parseFloat(s,10),_.style.cssText=t,n.style.cssText=i}return s||16},u.calcListLength=function(n){if(!(n in D)||I.uT){var e=u.calcLength(function(n){var e,t,i,o,r,a,s,l=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,d=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(i=(t=function(n){var e,t="",i=[],o=[],r=0,a=0,s=!1;function l(){t&&(i.push(t),t="")}function d(){i[0]&&(o.push(i),i=[])}for(;;){if(""===(e=n.charAt(a)))return l(),d(),o;if(s){if("*"===e&&"/"===n[a+1]){s=!1,a+=2,l();continue}a+=1}else{if(z(e)){if(n.charAt(a-1)&&z(n.charAt(a-1))||!t){a+=1;continue}if(0===r){l(),a+=1;continue}e=" "}else if("("===e)r+=1;else if(")"===e)r-=1;else{if(","===e){l(),d(),a+=1;continue}if("/"===e&&"*"===n.charAt(a+1)){s=!0,a+=2;continue}}t+=e,a+=1}}}(n)).length,e=0;e<i;e++)if(r=(o=t[e])[o.length-1],s=r,l.test(s)&&parseFloat(s)>=0||d.test(s)||"0"===s||"-0"===s||"+0"===s){if(a=r,o.pop(),0===o.length)return a;if(o=o.join(" "),u.matchesMedia(o))return a}return"100vw"}(n));D[n]=e||P.width}return D[n]},u.setRes=function(n){var e;if(n)for(var t=0,i=(e=u.parseSet(n)).length;t<i;t++)sn(e[t],n.sizes);return e},u.setRes.res=sn,u.applySetCandidate=function(n,e){if(n.length){var t,i,o,r,a,s,l,d,c,g,p,f,m,h,_,v,w=e[u.ns],E=u.DPR;if(s=w.curSrc||e[b],(l=w.curCan||function(n,e,t){var i;return!t&&e&&(t=(t=n[u.ns].sets)&&t[t.length-1]),(i=un(e,t))&&(e=u.makeUrl(e),n[u.ns].curSrc=e,n[u.ns].curCan=i,i.res||sn(i,i.set.sizes)),i}(e,s,n[0].set))&&l.set===n[0].set&&((c=y&&!e.complete&&l.res-.1>E)||(l.cached=!0,l.res>=E&&(a=l))),!a)for(n.sort(dn),a=n[(r=n.length)-1],i=0;i<r;i++)if((t=n[i]).res>=E){a=n[o=i-1]&&(c||s!==u.makeUrl(t.url))&&(g=n[o].res,p=t.res,f=E,m=n[o].cached,h=void 0,_=void 0,v=void 0,"saveData"===I.algorithm?g>2.7?v=f+1:(_=(p-f)*(h=Math.pow(g-.6,1.5)),m&&(_+=.1*h),v=g+_):v=f>1?Math.sqrt(g*p):g,v>f)?n[o]:t;break}a&&(d=u.makeUrl(a.url),w.curSrc=d,w.curCan=a,d!==s&&u.setSrc(e,a),u.setSize(e))}},u.setSrc=function(n,e){var t;n.src=e.url,"image/svg+xml"===e.set.type&&(t=n.style.width,n.style.width=n.offsetWidth+1+"px",n.offsetWidth+1&&(n.style.width=t))},u.getSet=function(n){var e,t,i,o=!1,r=n[u.ns].sets;for(e=0;e<r.length&&!o;e++)if((t=r[e]).srcset&&u.matchesMedia(t.media)&&(i=u.supportsType(t.type))){"pending"===i&&(t=i),o=t;break}return o},u.parseSets=function(n,e,t){var i,o,r,a,s=e&&"PICTURE"===e.nodeName.toUpperCase(),d=n[u.ns];(void 0===d.src||t.src)&&(d.src=f.call(n,"src"),d.src?m.call(n,"data-pfsrc",d.src):h.call(n,"data-pfsrc")),(void 0===d.srcset||t.srcset||!u.supSrcset||n.srcset)&&(i=f.call(n,"srcset"),d.srcset=i,a=!0),d.sets=[],s&&(d.pic=!0,function(n,e){var t,i,o,r,a=n.getElementsByTagName("source");for(t=0,i=a.length;t<i;t++)(o=a[t])[u.ns]=!0,(r=o.getAttribute("srcset"))&&e.push({srcset:r,media:o.getAttribute("media"),type:o.getAttribute("type"),sizes:o.getAttribute("sizes")})}(e,d.sets)),d.srcset?(o={srcset:d.srcset,sizes:f.call(n,"sizes")},d.sets.push(o),(r=(l||d.src)&&E.test(d.srcset||""))||!d.src||un(d.src,o)||o.has1x||(o.srcset+=", "+d.src,o.cands.push({url:d.src,d:1,set:o}))):d.src&&d.sets.push({srcset:d.src,sizes:null}),d.curCan=null,d.curSrc=void 0,d.supported=!(s||o&&!u.supSrcset||r&&!u.supSizes),a&&u.supSrcset&&!d.supported&&(i?(m.call(n,"data-pfsrcset",i),n.srcset=""):h.call(n,"data-pfsrcset")),d.supported&&!d.srcset&&(!d.src&&n.src||n.src!==u.makeUrl(d.src))&&(null===d.src?n.removeAttribute("src"):n.src=d.src),d.parsed=!0},u.fillImg=function(n,e){var t,i,o,r,a,s=e.reselect||e.reevaluate;(n[u.ns]||(n[u.ns]={}),t=n[u.ns],s||t.evaled!==d)&&(t.parsed&&!e.reevaluate||u.parseSets(n,n.parentNode,e),t.supported?t.evaled=d:(i=n,r=u.getSet(i),a=!1,"pending"!==r&&(a=d,r&&(o=u.setRes(r),u.applySetCandidate(o,i))),i[u.ns].evaled=a))},u.setupRun=function(){N&&!S&&k===o.devicePixelRatio||(S=!1,k=o.devicePixelRatio,C={},D={},u.DPR=k||1,P.width=Math.max(o.innerWidth||0,_.clientWidth),P.height=Math.max(o.innerHeight||0,_.clientHeight),P.vw=P.width/100,P.vh=P.height/100,d=[P.height,P.width,k].join("-"),P.em=u.getEmValue(),P.rem=P.em)},u.supPicture?(ln=g,u.fillImg=g):(en=o.attachEvent?/d$|^c/:/d$|^c|^i/,tn=function(){var n=r.readyState||"";on=setTimeout(tn,"loading"===n?200:999),r.body&&(u.fillImgs(),(W=W||en.test(n))&&clearTimeout(on))},on=setTimeout(tn,r.body?9:99),rn=_.clientHeight,j(o,"resize",(Z=function(){S=Math.max(o.innerWidth||0,_.clientWidth)!==P.width||_.clientHeight!==rn,rn=_.clientHeight,S&&u.fillImgs()},J=99,nn=function(){var n=new Date-$;n<J?X=setTimeout(nn,J-n):(X=null,Z())},function(){$=new Date,X||(X=setTimeout(nn,J))})),j(r,"readystatechange",tn)),u.picturefill=ln,u.fillImgs=ln,u.teardownRun=g,ln._=u,o.picturefillCFG={pf:u,push:function(n){var e=n.shift();"function"==typeof u[e]?u[e].apply(u,n):(I[e]=n[0],N&&u.fillImgs({reselect:!0}))}};for(;O&&O.length;)o.picturefillCFG.push(O.shift());o.picturefill=ln,"object"==typeof n.exports?n.exports=ln:void 0===(i=function(){return ln}.call(e,t,e,n))||(n.exports=i),u.supPicture||(v["image/webp"]=function(n,e){var t=new o.Image;return t.onerror=function(){v[n]=!1,ln()},t.onload=function(){v[n]=1===t.width,ln()},t.src=e,"pending"}("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document)},152:function(n,e,t){(function(n){
/*!
 * typeahead.js 0.10.5
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2014 Twitter, Inc. and other contributors; Licensed MIT
 */
!function(e){var t=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(n){return!n||/^\s*$/.test(n)},escapeRegExChars:function(n){return n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(n){return"string"==typeof n},isNumber:function(n){return"number"==typeof n},isArray:e.isArray,isFunction:e.isFunction,isObject:e.isPlainObject,isUndefined:function(n){return void 0===n},toStr:function(n){return t.isUndefined(n)||null===n?"":n+""},bind:e.proxy,each:function(n,t){e.each(n,function(n,e){return t(e,n)})},map:e.map,filter:e.grep,every:function(n,t){var i=!0;return n?(e.each(n,function(e,o){if(!(i=t.call(null,o,e,n)))return!1}),!!i):i},some:function(n,t){var i=!1;return n?(e.each(n,function(e,o){if(i=t.call(null,o,e,n))return!1}),!!i):i},mixin:e.extend,getUniqueId:(n=0,function(){return n++}),templatify:function(n){return e.isFunction(n)?n:function(){return String(n)}},defer:function(n){setTimeout(n,0)},debounce:function(n,e,t){var i,o;return function(){var r,a,s=this,l=arguments;return r=function(){i=null,t||(o=n.apply(s,l))},a=t&&!i,clearTimeout(i),i=setTimeout(r,e),a&&(o=n.apply(s,l)),o}},throttle:function(n,e){var t,i,o,r,a,s;return a=0,s=function(){a=new Date,o=null,r=n.apply(t,i)},function(){var l=new Date,d=e-(l-a);return t=this,i=arguments,d<=0?(clearTimeout(o),o=null,a=l,r=n.apply(t,i)):o||(o=setTimeout(s,d)),r}},noop:function(){}};var n}(),i="0.10.5",o=function(){"use strict";return{nonword:e,whitespace:n,obj:{nonword:i(e),whitespace:i(n)}};function n(n){return(n=t.toStr(n))?n.split(/\s+/):[]}function e(n){return(n=t.toStr(n))?n.split(/\W+/):[]}function i(n){return function(){var e=[].slice.call(arguments,0);return function(i){var o=[];return t.each(e,function(e){o=o.concat(n(t.toStr(i[e])))}),o}}}}(),r=function(){"use strict";function n(n){this.maxSize=t.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=e.noop)}function i(){this.head=this.tail=null}function o(n,e){this.key=n,this.val=e,this.prev=this.next=null}return t.mixin(n.prototype,{set:function(n,e){var t,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key]),(t=this.hash[n])?(t.val=e,this.list.moveToFront(t)):(t=new o(n,e),this.list.add(t),this.hash[n]=t,this.size++)},get:function(n){var e=this.hash[n];if(e)return this.list.moveToFront(e),e.val},reset:function(){this.size=0,this.hash={},this.list=new i}}),t.mixin(i.prototype,{add:function(n){this.head&&(n.next=this.head,this.head.prev=n),this.head=n,this.tail=this.tail||n},remove:function(n){n.prev?n.prev.next=n.next:this.head=n.next,n.next?n.next.prev=n.prev:this.tail=n.prev},moveToFront:function(n){this.remove(n),this.add(n)}}),n}(),a=function(){"use strict";var n,e;try{(n=window.localStorage).setItem("~~~","!"),n.removeItem("~~~")}catch(e){n=null}function i(n){this.prefix=["__",n,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+t.escapeRegExChars(this.prefix))}return e=n&&window.JSON?{_prefix:function(n){return this.prefix+n},_ttlKey:function(n){return this._prefix(n)+this.ttlKey},get:function(e){return this.isExpired(e)&&this.remove(e),a(n.getItem(this._prefix(e)))},set:function(e,i,a){return t.isNumber(a)?n.setItem(this._ttlKey(e),r(o()+a)):n.removeItem(this._ttlKey(e)),n.setItem(this._prefix(e),r(i))},remove:function(e){return n.removeItem(this._ttlKey(e)),n.removeItem(this._prefix(e)),this},clear:function(){var e,t,i=[],o=n.length;for(e=0;e<o;e++)(t=n.key(e)).match(this.keyMatcher)&&i.push(t.replace(this.keyMatcher,""));for(e=i.length;e--;)this.remove(i[e]);return this},isExpired:function(e){var i=a(n.getItem(this._ttlKey(e)));return!!(t.isNumber(i)&&o()>i)}}:{get:t.noop,set:t.noop,remove:t.noop,clear:t.noop,isExpired:t.noop},t.mixin(i.prototype,e),i;function o(){return(new Date).getTime()}function r(n){return JSON.stringify(t.isUndefined(n)?null:n)}function a(n){return JSON.parse(n)}}(),s=function(){"use strict";var n=0,i={},o=6,a=new r(10);function s(n){var i;n=n||{},this.cancelled=!1,this.lastUrl=null,this._send=n.transport?(i=n.transport,function(n,o){var r=e.Deferred();return i(n,o,function(n){t.defer(function(){r.resolve(n)})},function(n){t.defer(function(){r.reject(n)})}),r}):e.ajax,this._get=n.rateLimiter?n.rateLimiter(this._get):this._get,this._cache=!1===n.cache?new r(0):a}return s.setMaxPendingRequests=function(n){o=n},s.resetCache=function(){a.reset()},t.mixin(s.prototype,{_get:function(e,t,r){var a,s=this;function l(n){r&&r(null,n),s._cache.set(e,n)}function d(){r&&r(!0)}this.cancelled||e!==this.lastUrl||((a=i[e])?a.done(l).fail(d):n<o?(n++,i[e]=this._send(e,t).done(l).fail(d).always(function(){n--,delete i[e],s.onDeckRequestArgs&&(s._get.apply(s,s.onDeckRequestArgs),s.onDeckRequestArgs=null)})):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,e,i){var o;return t.isFunction(e)&&(i=e,e={}),this.cancelled=!1,this.lastUrl=n,(o=this._cache.get(n))?t.defer(function(){i&&i(null,o)}):this._get(n,e,i),!!o},cancel:function(){this.cancelled=!0}}),s}(),l=function(){"use strict";function n(n){(n=n||{}).datumTokenizer&&n.queryTokenizer||e.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}return t.mixin(n.prototype,{bootstrap:function(n){this.datums=n.datums,this.trie=n.trie},add:function(n){var e=this;n=t.isArray(n)?n:[n],t.each(n,function(n){var o,r;o=e.datums.push(n)-1,r=i(e.datumTokenizer(n)),t.each(r,function(n){var t,i,r;for(t=e.trie,i=n.split("");r=i.shift();)(t=t.children[r]||(t.children[r]={ids:[],children:{}})).ids.push(o)})})},get:function(n){var e,o,r=this;return e=i(this.queryTokenizer(n)),t.each(e,function(n){var e,t,i,a;if(o&&0===o.length)return!1;for(e=r.trie,t=n.split("");e&&(i=t.shift());)e=e.children[i];if(!e||0!==t.length)return o=[],!1;a=e.ids.slice(0),o=o?function(n,e){var t=0,i=0,o=[];n=n.sort(s),e=e.sort(s);var r=n.length,a=e.length;for(;t<r&&i<a;)n[t]<e[i]?t++:n[t]>e[i]?i++:(o.push(n[t]),t++,i++);return o;function s(n,e){return n-e}}(o,a):a}),o?t.map(function(n){for(var e={},t=[],i=0,o=n.length;i<o;i++)e[n[i]]||(e[n[i]]=!0,t.push(n[i]));return t}(o),function(n){return r.datums[n]}):[]},reset:function(){this.datums=[],this.trie={ids:[],children:{}}},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n;function i(n){return n=t.filter(n,function(n){return!!n}),n=t.map(n,function(n){return n.toLowerCase()})}}(),d=function(){"use strict";return{local:function(n){return n.local||null},prefetch:function(n){var o,r;r={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(o=n.prefetch||null)&&(o=t.isString(o)?{url:o}:o,(o=t.mixin(r,o)).thumbprint=i+o.thumbprint,o.ajax.type=o.ajax.type||"GET",o.ajax.dataType=o.ajax.dataType||"json",!o.url&&e.error("prefetch requires url to be set"));return o},remote:function(n){var i,o;o={url:null,cache:!0,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(i=n.remote||null)&&(i=t.isString(i)?{url:i}:i,(i=t.mixin(o,i)).rateLimiter=/^throttle$/i.test(i.rateLimitBy)?(r=i.rateLimitWait,function(n){return t.throttle(n,r)}):function(n){return function(e){return t.debounce(e,n)}}(i.rateLimitWait),i.ajax.type=i.ajax.type||"GET",i.ajax.dataType=i.ajax.dataType||"json",delete i.rateLimitBy,delete i.rateLimitWait,!i.url&&e.error("remote requires url to be set"));var r;return i}}}();!function(n){"use strict";var i,r;function u(n){n&&(n.local||n.prefetch||n.remote)||e.error("one of local, prefetch, or remote is required"),this.limit=n.limit||5,this.sorter=function(n){return t.isFunction(n)?function(e){return e.sort(n)}:function(n){return n}}(n.sorter),this.dupDetector=n.dupDetector||c,this.local=d.local(n),this.prefetch=d.prefetch(n),this.remote=d.remote(n),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new l({datumTokenizer:n.datumTokenizer,queryTokenizer:n.queryTokenizer}),this.storage=this.cacheKey?new a(this.cacheKey):null}return i=n.Bloodhound,r={data:"data",protocol:"protocol",thumbprint:"thumbprint"},n.Bloodhound=u,u.noConflict=function(){return n.Bloodhound=i,u},u.tokenizers=o,t.mixin(u.prototype,{_loadPrefetch:function(n){var t,i,o=this;return(t=this._readFromStorage(n.thumbprint))?(this.index.bootstrap(t),i=e.Deferred().resolve()):i=e.ajax(n.url,n.ajax).done(function(e){o.clear(),o.add(n.filter?n.filter(e):e),o._saveToStorage(o.index.serialize(),n.thumbprint,n.ttl)}),i},_getFromRemote:function(n,e){var t,i,o=this;if(this.transport)return n=n||"",i=encodeURIComponent(n),t=this.remote.replace?this.remote.replace(this.remote.url,n):this.remote.url.replace(this.remote.wildcard,i),this.transport.get(t,this.remote.ajax,function(n,t){e(n?[]:o.remote.filter?o.remote.filter(t):t)})},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(n,e,t){this.storage&&(this.storage.set(r.data,n,t),this.storage.set(r.protocol,location.protocol,t),this.storage.set(r.thumbprint,e,t))},_readFromStorage:function(n){var e,t={};return this.storage&&(t.data=this.storage.get(r.data),t.protocol=this.storage.get(r.protocol),t.thumbprint=this.storage.get(r.thumbprint)),e=t.thumbprint!==n||t.protocol!==location.protocol,t.data&&!e?t.data:null},_initialize:function(){var n,i=this,o=this.local;return n=this.prefetch?this._loadPrefetch(this.prefetch):e.Deferred().resolve(),o&&n.done(function(){i.add(t.isFunction(o)?o():o)}),this.transport=this.remote?new s(this.remote):null,this.initPromise=n.promise()},initialize:function(n){return!this.initPromise||n?this._initialize():this.initPromise},add:function(n){this.index.add(n)},get:function(n,e){var i=this,o=[],r=!1;o=this.index.get(n),(o=this.sorter(o).slice(0,this.limit)).length<this.limit?r=this._getFromRemote(n,function(n){var r=o.slice(0);t.each(n,function(n){return!t.some(r,function(e){return i.dupDetector(n,e)})&&r.push(n),r.length<i.limit}),e&&e(i.sorter(r))}):this._cancelLastRemoteRequest(),r||(o.length>0||!this.transport)&&e&&e(o)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&s.resetCache()},ttAdapter:function(){return t.bind(this.get,this)}}),u;function c(){return!1}}(this);var u={wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'},c=function(){"use strict";var n={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return t.isMsie()&&t.mixin(n.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t.isMsie()&&t.isMsie()<=7&&t.mixin(n.input,{marginTop:"-1px"}),n}(),g=function(){"use strict";function n(n){n&&n.el||e.error("EventBus initialized without el"),this.$el=e(n.el)}return t.mixin(n.prototype,{trigger:function(n){var e=[].slice.call(arguments,1);this.$el.trigger("typeahead:"+n,e)}}),n}(),p=function(){"use strict";var e=/\s+/,t=function(){var e;e=window.setImmediate?function(e){n(function(){e()})}:function(n){setTimeout(function(){n()},0)};return e}();return{onSync:function(n,e,t){return i.call(this,"sync",n,e,t)},onAsync:function(n,e,t){return i.call(this,"async",n,e,t)},off:function(n){var t;if(!this._callbacks)return this;n=n.split(e);for(;t=n.shift();)delete this._callbacks[t];return this},trigger:function(n){var i,r,a,s,l;if(!this._callbacks)return this;n=n.split(e),a=[].slice.call(arguments,1);for(;(i=n.shift())&&(r=this._callbacks[i]);)s=o(r.sync,this,[i].concat(a)),l=o(r.async,this,[i].concat(a)),s()&&t(l);return this}};function i(n,t,i,o){var r;if(!i)return this;for(t=t.split(e),i=o?function(n,e){return n.bind?n.bind(e):function(){n.apply(e,[].slice.call(arguments,0))}}(i,o):i,this._callbacks=this._callbacks||{};r=t.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][n].push(i);return this}function o(n,e,t){return function(){for(var i,o=0,r=n.length;!i&&o<r;o+=1)i=!1===n[o].apply(e,t);return!i}}}(),f=function(n){"use strict";var e={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(i){var o;(i=t.mixin({},e,i)).node&&i.pattern&&(i.pattern=t.isArray(i.pattern)?i.pattern:[i.pattern],o=function(n,e,i){for(var o,r=[],a=0,s=n.length;a<s;a++)r.push(t.escapeRegExChars(n[a]));return o=i?"\\b("+r.join("|")+")\\b":"("+r.join("|")+")",e?new RegExp(o):new RegExp(o,"i")}(i.pattern,i.caseSensitive,i.wordsOnly),function n(e,t){var i;for(var o=0;o<e.childNodes.length;o++)3===(i=e.childNodes[o]).nodeType?o+=t(i)?1:0:n(i,t)}(i.node,function(e){var t,r,a;(t=o.exec(e.data))&&(a=n.createElement(i.tagName),i.className&&(a.className=i.className),(r=e.splitText(t.index)).splitText(t[0].length),a.appendChild(r.cloneNode(!0)),e.parentNode.replaceChild(a,r));return!!t}))}}(window.document),m=function(){"use strict";var n;function i(i){var o,r,a,s,l,d=this;(i=i||{}).input||e.error("input is missing"),o=t.bind(this._onBlur,this),r=t.bind(this._onFocus,this),a=t.bind(this._onKeydown,this),s=t.bind(this._onInput,this),this.$hint=e(i.hint),this.$input=e(i.input).on("blur.tt",o).on("focus.tt",r).on("keydown.tt",a),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=t.noop),t.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(e){n[e.which||e.keyCode]||t.defer(t.bind(d._onInput,d,e))}):this.$input.on("input.tt",s),this.query=this.$input.val(),this.$overflowHelper=(l=this.$input,e('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:l.css("font-family"),fontSize:l.css("font-size"),fontStyle:l.css("font-style"),fontVariant:l.css("font-variant"),fontWeight:l.css("font-weight"),wordSpacing:l.css("word-spacing"),letterSpacing:l.css("letter-spacing"),textIndent:l.css("text-indent"),textRendering:l.css("text-rendering"),textTransform:l.css("text-transform")}).insertAfter(l))}return n={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},i.normalizeQuery=function(n){return(n||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},t.mixin(i.prototype,p,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(e){var t=n[e.which||e.keyCode];this._managePreventDefault(t,e),t&&this._shouldTrigger(t,e)&&this.trigger(t+"Keyed",e)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(n,e){var t,i,r;switch(n){case"tab":i=this.getHint(),r=this.getInputValue(),t=i&&i!==r&&!o(e);break;case"up":case"down":t=!o(e);break;default:t=!1}t&&e.preventDefault()},_shouldTrigger:function(n,e){var t;switch(n){case"tab":t=!o(e);break;default:t=!0}return t},_checkInputValue:function(){var n,e,t,o,r;n=this.getInputValue(),o=n,r=this.query,t=!!(e=i.normalizeQuery(o)===i.normalizeQuery(r))&&this.query.length!==n.length,this.query=n,e?t&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(n){this.query=n},getInputValue:function(){return this.$input.val()},setInputValue:function(n,e){this.$input.val(n),e?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(n){this.$hint.val(n)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var n,e,t;t=(n=this.getInputValue())!==(e=this.getHint())&&0===e.indexOf(n),!(""!==n&&t&&!this.hasOverflow())&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var n=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=n},isCursorAtEnd:function(){var n,e,i;return n=this.$input.val().length,e=this.$input[0].selectionStart,t.isNumber(e)?e===n:!document.selection||((i=document.selection.createRange()).moveStart("character",-n),n===i.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),i;function o(n){return n.altKey||n.ctrlKey||n.metaKey||n.shiftKey}}(),h=function(){"use strict";var n="ttDataset",i="ttValue",o="ttDatum";function r(n){var i;(n=n||{}).templates=n.templates||{},n.source||e.error("missing source"),n.name&&(i=n.name,!/^[_a-zA-Z0-9-]+$/.test(i))&&e.error("invalid dataset name: "+n.name),this.query=null,this.highlight=!!n.highlight,this.name=n.name||t.getUniqueId(),this.source=n.source,this.displayFn=function(n){return n=n||"value",t.isFunction(n)?n:function(e){return e[n]}}(n.display||n.displayKey),this.templates=function(n,e){return{empty:n.empty&&t.templatify(n.empty),header:n.header&&t.templatify(n.header),footer:n.footer&&t.templatify(n.footer),suggestion:n.suggestion||function(n){return"<p>"+e(n)+"</p>"}}}(n.templates,this.displayFn),this.$el=e(u.dataset.replace("%CLASS%",this.name))}return r.extractDatasetName=function(t){return e(t).data(n)},r.extractValue=function(n){return e(n).data(i)},r.extractDatum=function(n){return e(n).data(o)},t.mixin(r.prototype,p,{_render:function(r,a){if(this.$el){var s,l=this;this.$el.empty(),!(s=a&&a.length)&&this.templates.empty?this.$el.html(l.templates.empty({query:r,isEmpty:!0})).prepend(l.templates.header?d():null).append(l.templates.footer?g():null):s&&this.$el.html(function(){var s,d;return s=e(u.suggestions).css(c.suggestions),d=t.map(a,function(t){var r;return(r=e(u.suggestion).append(l.templates.suggestion(t)).data(n,l.name).data(i,l.displayFn(t)).data(o,t)).children().each(function(){e(this).css(c.suggestionChild)}),r}),s.append.apply(s,d),l.highlight&&f({className:"tt-highlight",node:s[0],pattern:r}),s}()).prepend(l.templates.header?d():null).append(l.templates.footer?g():null),this.trigger("rendered")}function d(){return l.templates.header({query:r,isEmpty:!s})}function g(){return l.templates.footer({query:r,isEmpty:!s})}},getRoot:function(){return this.$el},update:function(n){var e=this;this.query=n,this.canceled=!1,this.source(n,function(t){e.canceled||n!==e.query||e._render(n,t)})},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),r}(),_=function(){"use strict";function n(n){var o,r,a,s=this;(n=n||{}).menu||e.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=t.map(n.datasets,i),o=t.bind(this._onSuggestionClick,this),r=t.bind(this._onSuggestionMouseEnter,this),a=t.bind(this._onSuggestionMouseLeave,this),this.$menu=e(n.menu).on("click.tt",".tt-suggestion",o).on("mouseenter.tt",".tt-suggestion",r).on("mouseleave.tt",".tt-suggestion",a),t.each(this.datasets,function(n){s.$menu.append(n.getRoot()),n.onSync("rendered",s._onRendered,s)})}return t.mixin(n.prototype,p,{_onSuggestionClick:function(n){this.trigger("suggestionClicked",e(n.currentTarget))},_onSuggestionMouseEnter:function(n){this._removeCursor(),this._setCursor(e(n.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){this.isEmpty=t.every(this.datasets,function(n){return n.isEmpty()}),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(n,e){n.first().addClass("tt-cursor"),!e&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(n){var e,t,i,o;this.isOpen&&(t=this._getCursor(),e=this._getSuggestions(),this._removeCursor(),-1!==(i=((i=e.index(t)+n)+1)%(e.length+1)-1)?(i<-1&&(i=e.length-1),this._setCursor(o=e.eq(i)),this._ensureVisible(o)):this.trigger("cursorRemoved"))},_ensureVisible:function(n){var e,t,i,o;t=(e=n.position().top)+n.outerHeight(!0),i=this.$menu.scrollTop(),o=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),e<0?this.$menu.scrollTop(i+e):o<t&&this.$menu.scrollTop(i+(t-o))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(n){this.$menu.css("ltr"===n?c.ltr:c.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(n){var e=null;return n.length&&(e={raw:h.extractDatum(n),value:h.extractValue(n),datasetName:h.extractDatasetName(n)}),e},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(n){t.each(this.datasets,function(e){e.update(n)})},empty:function(){t.each(this.datasets,function(n){n.clear()}),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){this.$menu.off(".tt"),this.$menu=null,t.each(this.datasets,function(n){n.destroy()})}}),n;function i(n){return new h(n)}}(),v=function(){"use strict";var n="ttAttrs";function i(i){var o,r,a;(i=i||{}).input||e.error("missing input"),this.isActivated=!1,this.autoselect=!!i.autoselect,this.minLength=t.isNumber(i.minLength)?i.minLength:1,this.$node=function(t,i){var o,r,a,s;o=e(t),r=e(u.wrapper).css(c.wrapper),a=e(u.dropdown).css(c.dropdown),(s=o.clone().css(c.hint).css((l=o,{backgroundAttachment:l.css("background-attachment"),backgroundClip:l.css("background-clip"),backgroundColor:l.css("background-color"),backgroundImage:l.css("background-image"),backgroundOrigin:l.css("background-origin"),backgroundPosition:l.css("background-position"),backgroundRepeat:l.css("background-repeat"),backgroundSize:l.css("background-size")}))).val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",!0).attr({autocomplete:"off",spellcheck:"false",tabindex:-1}),o.data(n,{dir:o.attr("dir"),autocomplete:o.attr("autocomplete"),spellcheck:o.attr("spellcheck"),style:o.attr("style")}),o.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(i?c.input:c.inputWithNoHint);var l;try{!o.attr("dir")&&o.attr("dir","auto")}catch(n){}return o.wrap(r).parent().prepend(i?s:null).append(a)}(i.input,i.withHint),o=this.$node.find(".tt-dropdown-menu"),r=this.$node.find(".tt-input"),a=this.$node.find(".tt-hint"),r.on("blur.tt",function(n){var e,i,a;e=document.activeElement,i=o.is(e),a=o.has(e).length>0,t.isMsie()&&(i||a)&&(n.preventDefault(),n.stopImmediatePropagation(),t.defer(function(){r.focus()}))}),o.on("mousedown.tt",function(n){n.preventDefault()}),this.eventBus=i.eventBus||new g({el:r}),this.dropdown=new _({menu:o,datasets:i.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new m({input:r,hint:a}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}return t.mixin(i.prototype,{_onSuggestionClicked:function(n,e){var t;(t=this.dropdown.getDatumForSuggestion(e))&&this._select(t)},_onCursorMoved:function(){var n=this.dropdown.getDatumForCursor();this.input.setInputValue(n.value,!0),this.eventBus.trigger("cursorchanged",n.raw,n.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(n,e){var t,i;t=this.dropdown.getDatumForCursor(),i=this.dropdown.getDatumForTopSuggestion(),t?(this._select(t),e.preventDefault()):this.autoselect&&i&&(this._select(i),e.preventDefault())},_onTabKeyed:function(n,e){var t;(t=this.dropdown.getDatumForCursor())?(this._select(t),e.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var n=this.input.getQuery();this.dropdown.isEmpty&&n.length>=this.minLength?this.dropdown.update(n):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var n=this.input.getQuery();this.dropdown.isEmpty&&n.length>=this.minLength?this.dropdown.update(n):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(n,e){this.input.clearHintIfInvalid(),e.length>=this.minLength?this.dropdown.update(e):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var n;this.dir!==(n=this.input.getLanguageDirection())&&(this.dir=n,this.$node.css("direction",n),this.dropdown.setLanguageDirection(n))},_updateHint:function(){var n,e,i,o,r;(n=this.dropdown.getDatumForTopSuggestion())&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(e=this.input.getInputValue(),i=m.normalizeQuery(e),o=t.escapeRegExChars(i),(r=new RegExp("^(?:"+o+")(.+$)","i").exec(n.value))?this.input.setHint(e+r[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(n){var e,t,i,o;e=this.input.getHint(),t=this.input.getQuery(),i=n||this.input.isCursorAtEnd(),e&&t!==e&&i&&((o=this.dropdown.getDatumForTopSuggestion())&&this.input.setInputValue(o.value),this.eventBus.trigger("autocompleted",o.raw,o.datasetName))},_select:function(n){this.input.setQuery(n.value),this.input.setInputValue(n.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",n.raw,n.datasetName),this.dropdown.close(),t.defer(t.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(n){n=t.toStr(n),this.isActivated?this.input.setInputValue(n):(this.input.setQuery(n),this.input.setInputValue(n,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){var e,i;this.input.destroy(),this.dropdown.destroy(),e=this.$node,i=e.find(".tt-input"),t.each(i.data(n),function(n,e){t.isUndefined(n)?i.removeAttr(e):i.attr(e,n)}),i.detach().removeData(n).removeClass("tt-input").insertAfter(e),e.remove(),this.$node=null}}),i}();!function(){"use strict";var n,i,o;n=e.fn.typeahead,i="ttTypeahead",o={initialize:function(n,o){return o=t.isArray(o)?o:[].slice.call(arguments,1),n=n||{},this.each(function(){var r,a=e(this);t.each(o,function(e){e.highlight=!!n.highlight}),r=new v({input:a,eventBus:new g({el:a}),withHint:!!t.isUndefined(n.hint)||!!n.hint,minLength:n.minLength,autoselect:n.autoselect,datasets:o}),a.data(i,r)})},open:function(){return this.each(function(){var n,t=e(this);(n=t.data(i))&&n.open()})},close:function(){return this.each(function(){var n,t=e(this);(n=t.data(i))&&n.close()})},val:function(n){return arguments.length?this.each(function(){var t,o=e(this);(t=o.data(i))&&t.setVal(n)}):function(n){var e,t;(e=n.data(i))&&(t=e.getVal());return t}(this.first())},destroy:function(){return this.each(function(){var n,t=e(this);(n=t.data(i))&&(n.destroy(),t.removeData(i))})}},e.fn.typeahead=function(n){var t;return o[n]&&"initialize"!==n?(t=this.filter(function(){return!!e(this).data(i)}),o[n].apply(t,[].slice.call(arguments,1))):o.initialize.apply(this,arguments)},e.fn.typeahead.noConflict=function(){return e.fn.typeahead=n,this}}()}(window.jQuery)}).call(this,t(153).setImmediate)},153:function(n,e,t){(function(n){var i=void 0!==n&&n||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function r(n,e){this._id=n,this._clearFn=e}e.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n&&n.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;e>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},t(154),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==n&&n.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==n&&n.clearImmediate||this&&this.clearImmediate}).call(this,t(5))},154:function(n,e,t){(function(n,e){!function(n,t){"use strict";if(!n.setImmediate){var i,o,r,a,s,l=1,d={},u=!1,c=n.document,g=Object.getPrototypeOf&&Object.getPrototypeOf(n);g=g&&g.setTimeout?g:n,"[object process]"==={}.toString.call(n.process)?i=function(n){e.nextTick(function(){f(n)})}:!function(){if(n.postMessage&&!n.importScripts){var e=!0,t=n.onmessage;return n.onmessage=function(){e=!1},n.postMessage("","*"),n.onmessage=t,e}}()?n.MessageChannel?((r=new MessageChannel).port1.onmessage=function(n){f(n.data)},i=function(n){r.port2.postMessage(n)}):c&&"onreadystatechange"in c.createElement("script")?(o=c.documentElement,i=function(n){var e=c.createElement("script");e.onreadystatechange=function(){f(n),e.onreadystatechange=null,o.removeChild(e),e=null},o.appendChild(e)}):i=function(n){setTimeout(f,0,n)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===n&&"string"==typeof e.data&&0===e.data.indexOf(a)&&f(+e.data.slice(a.length))},n.addEventListener?n.addEventListener("message",s,!1):n.attachEvent("onmessage",s),i=function(e){n.postMessage(a+e,"*")}),g.setImmediate=function(n){"function"!=typeof n&&(n=new Function(""+n));for(var e=new Array(arguments.length-1),t=0;t<e.length;t++)e[t]=arguments[t+1];var o={callback:n,args:e};return d[l]=o,i(l),l++},g.clearImmediate=p}function p(n){delete d[n]}function f(n){if(u)setTimeout(f,0,n);else{var e=d[n];if(e){u=!0;try{!function(n){var e=n.callback,i=n.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(t,i)}}(e)}finally{p(n),u=!1}}}}}("undefined"==typeof self?void 0===n?this:n:self)}).call(this,t(5),t(8))},188:function(n,e,t){t(189)(t(190))},189:function(n,e){n.exports=function(n){function e(n){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",n)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(n):"undefined"!=typeof eval?eval.call(null,n):e("EvalError: No eval function available")}catch(n){e(n)}}},190:function(n,e){n.exports="function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/*\n * CNN AdFuel Modules (AIS)\n */\nCNN = window.CNN || {};\nCNN.AdsConfig = CNN.AdsConfig || {};\n/* Only load if runtime config not set */\n\nif (CNN.AdsConfig.aisOverride) {\n  (function (doc, cnn) {\n    'use strict';\n\n    var elem = doc.createElement('script'),\n        sl = doc.getElementsByTagName('script')[0];\n    elem.type = 'text/javascript';\n    elem.src = (doc.location.protocol === 'https:' ? 'https:' : 'http:') + cnn.AdsConfig.aisOverride;\n    sl.parentNode.insertBefore(elem, sl);\n  })(document, window.CNN);\n} else {\n  CNN.AdsConfig.amazon = CNN.AdsConfig.amazon || {};\n  CNN.Features = CNN.Features || {};\n  CNN.SiteLocation = CNN.SiteLocation || {};\n  CNN.SiteLocation.vertical = CNN.SiteLocation.vertical || '';\n\n  (function createAdFuelUtilities() {\n    var MODULE_NAME = 'AdFuel Utilities';\n    var MODULE_VERSION = 'v3.1.13';\n    var cdnRoot = document.location.hostname.indexOf('cnn.com') >= 0 ? 'cdn.cnn.com' : 'i.cdn.turner.com';\n    window.googletag = window.googletag || {};\n    window.googletag.cmd = window.googletag.cmd || []; // Promise Polyfill\n    // eslint-disable-next-line\n\n    !function (e, n) {\n      (typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) === 'object' && typeof module != 'undefined' ? n() : typeof define == 'function' && define.amd ? define(n) : n();\n    }(0, function () {\n      'use strict';\n\n      function e() {}\n\n      function n(e) {\n        if (!(this instanceof n)) throw new TypeError('Promises must be constructed via new');\n        if (typeof e != 'function') throw new TypeError('not a function');\n        this._state = 0, this._handled = !1, this._value = undefined, this._deferreds = [], f(e, this);\n      }\n\n      function t(e, t) {\n        for (; e._state === 3;) {\n          e = e._value;\n        }\n\n        e._state !== 0 ? (e._handled = !0, n._immediateFn(function () {\n          var n = e._state === 1 ? t.onFulfilled : t.onRejected;\n\n          if (n !== null) {\n            var i;\n\n            try {\n              i = n(e._value);\n            } catch (f) {\n              return void r(t.promise, f);\n            }\n\n            o(t.promise, i);\n          } else (e._state === 1 ? o : r)(t.promise, e._value);\n        })) : e._deferreds.push(t);\n      }\n\n      function o(e, t) {\n        try {\n          if (t === e) throw new TypeError('A promise cannot be resolved with itself.');\n\n          if (t && (_typeof(t) === 'object' || typeof t == 'function')) {\n            var o = t.then;\n            if (t instanceof n) return e._state = 3, e._value = t, void i(e);\n            if (typeof o == 'function') return void f(function (e, n) {\n              return function () {\n                e.apply(n, arguments);\n              };\n            }(o, t), e);\n          }\n\n          e._state = 1, e._value = t, i(e);\n        } catch (u) {\n          r(e, u);\n        }\n      }\n\n      function r(e, n) {\n        e._state = 2, e._value = n, i(e);\n      }\n\n      function i(e) {\n        e._state === 2 && e._deferreds.length === 0 && n._immediateFn(function () {\n          e._handled || n._unhandledRejectionFn(e._value);\n        });\n\n        for (var o = 0, r = e._deferreds.length; r > o; o++) {\n          t(e, e._deferreds[o]);\n        }\n\n        e._deferreds = null;\n      }\n\n      function f(e, n) {\n        var t = !1;\n\n        try {\n          e(function (e) {\n            t || (t = !0, o(n, e));\n          }, function (e) {\n            t || (t = !0, r(n, e));\n          });\n        } catch (i) {\n          if (t) return;\n          t = !0, r(n, i);\n        }\n      }\n\n      var u = setTimeout;\n      n.prototype.catch = function (e) {\n        return this.then(null, e);\n      }, n.prototype.then = function (n, o) {\n        var r = new this.constructor(e);\n        return t(this, new function (e, n, t) {\n          this.onFulfilled = typeof e == 'function' ? e : null, this.onRejected = typeof n == 'function' ? n : null, this.promise = t;\n        }(n, o, r)), r;\n      }, n.prototype.finally = function (e) {\n        var n = this.constructor;\n        return this.then(function (t) {\n          return n.resolve(e()).then(function () {\n            return t;\n          });\n        }, function (t) {\n          return n.resolve(e()).then(function () {\n            return n.reject(t);\n          });\n        });\n      }, n.all = function (e) {\n        return new n(function (n, t) {\n          function o(e, f) {\n            try {\n              if (f && (_typeof(f) == 'object' || typeof f === 'function')) {\n                var u = f.then;\n                if (typeof u == 'function') return void u.call(f, function (n) {\n                  o(e, n);\n                }, t);\n              }\n\n              r[e] = f, --i == 0 && n(r);\n            } catch (c) {\n              t(c);\n            }\n          }\n\n          if (!e || typeof e.length == 'undefined') throw new TypeError('Promise.all accepts an array');\n          var r = Array.prototype.slice.call(e);\n          if (r.length === 0) return n([]);\n\n          for (var i = r.length, f = 0; r.length > f; f++) {\n            o(f, r[f]);\n          }\n        });\n      }, n.resolve = function (e) {\n        return e && _typeof(e) == 'object' && e.constructor === n ? e : new n(function (n) {\n          n(e);\n        });\n      }, n.reject = function (e) {\n        return new n(function (n, t) {\n          t(e);\n        });\n      }, n.race = function (e) {\n        return new n(function (n, t) {\n          for (var o = 0, r = e.length; r > o; o++) {\n            e[o].then(n, t);\n          }\n        });\n      }, n._immediateFn = typeof setImmediate === 'function' && function (e) {\n        setImmediate(e);\n      } || function (e) {\n        u(e, 0);\n      }, n._unhandledRejectionFn = function (e) {\n        void 0 !== console && console && console.warn('Possible Unhandled Promise Rejection:', e);\n      };\n\n      var c = function () {\n        if ('undefined' !== typeof self) return self;\n        if ('undefined' !== typeof window) return window;\n        if (void 0 !== c) return c;\n        throw Error('unable to locate global object');\n      }();\n\n      c.Promise || (c.Promise = n);\n    }); // Object.assign Polyfill\n    // eslint-disable-next-line\n\n    typeof Object.assign !== 'function' && Object.defineProperty(Object, 'assign', {\n      value: function value(e, t) {\n        'use strict';\n\n        if (e == null) throw new TypeError('Cannot convert undefined or null to object');\n\n        for (var n = Object(e), r = 1; r < arguments.length; r++) {\n          var o = arguments[r];\n          if (o != null) for (var c in o) {\n            Object.prototype.hasOwnProperty.call(o, c) && (n[c] = o[c]);\n          }\n        }\n\n        return n;\n      },\n      writable: !0,\n      configurable: !0\n    }); // Console, Event Listener and Array Polyfills\n\n    !function (t) {\n      'use strict';\n\n      function n() {\n        return a && a.call(c) || new Date().getTime();\n      }\n\n      var o = [];\n      var e = {};\n      var r = {};\n\n      var i = function i() {};\n\n      var u = '-----';\n      u += u;\n      u += u;\n      u += u;\n      u += u;\n      var f = '\\n\\n\\n\\n\\n\\n';\n      var c = window.performance;\n      var a = c && (c.now || c.mozNow || c.msNow || c.oNow || c.webkitNow);\n      t.log && typeof t.log === 'function' || (t.log = i);\n      t.profile && typeof t.profile === 'function' || (t.profile = i);\n      t.profileEnd && typeof t.profileEnd === 'function' || (t.profileEnd = i);\n      t.timeStamp && typeof t.timeStamp === 'function' || (t.timeStamp = i);\n      t.trace && typeof t.trace === 'function' || (t.trace = i);\n      t.debug && typeof t.debug === 'function' || (t.debug = t.log);\n      t.info && typeof t.info === 'function' || (t.info = t.log);\n      t.warn && typeof t.warn === 'function' || (t.warn = t.log);\n      t.error && typeof t.error === 'function' || (t.error = t.log);\n      t.dir && typeof t.dir === 'function' || (t.dir = t.log);\n      t.dirxml && typeof t.dirxml === 'function' || (t.dirxml = t.dir);\n      var l = !1;\n      (l || !t.group) && (t.group = function (nA) {\n        o.push(nA);\n        t.log(u + '\\nBEGIN GROUP: ' + nA);\n      });\n      (l || !t.groupCollapsed) && (t.groupCollapsed = t.group);\n      (l || !t.groupEnd) && (t.groupEnd = function () {\n        t.log('END GROUP: ' + o.pop() + '\\n' + u);\n      });\n      (l || !t.time) && (t.time = function (t2) {\n        e[t2] = n();\n      });\n      (l || !t.timeEnd) && (t.timeEnd = function (o2) {\n        t.log(o2 + ': ' + (n() - e[o2]).toFixed(3) + 'ms');\n        delete e[o2];\n      });\n      (l || !t.assert) && (t.assert = function (n2, o3) {\n        n2 || t.error('Assertion failed: ' + o3);\n      });\n      (l || !t.count) && (t.count = function (n3) {\n        r[n3] || (r[n3] = 0);\n        r[n3]++;\n        t.log(n3 + ': ' + r[n3]);\n      });\n      (l || !t.clear) && (t.clear = function () {\n        t.log(f);\n      });\n    }(window.console = window.console || {});\n\n    (function () {\n      // eslint-disable-next-line\n      function t(t, n) {\n        n = n || {\n          bubbles: !1,\n          cancelable: !1,\n          detail: void 0\n        };\n        var o = document.createEvent('CustomEvent');\n        return o.initCustomEvent(t, n.bubbles, n.cancelable, n.detail), o;\n      } // eslint-disable-next-line\n\n\n      return typeof window.CustomEvent === 'function' ? !1 : (t.prototype = window.Event.prototype, void (window.CustomEvent = t));\n    })();\n\n    !window.addEventListener && function (t, n, o, e, r, i, u) {\n      // eslint-disable-next-line\n      t[e] = n[e] = o[e] = function (t, n) {\n        // eslint-disable-next-line\n        var o = this; // eslint-disable-next-line\n\n        u.unshift([o, t, n, function (t) {\n          t.currentTarget = o, t.preventDefault = function () {\n            t.returnValue = !1;\n          }, t.stopPropagation = function () {\n            t.cancelBubble = !0;\n          }, t.target = t.srcElement || o, n.call(o, t);\n        }]), this.attachEvent('on' + t, u[0][3]);\n      }; // eslint-disable-next-line\n\n\n      t[r] = n[r] = o[r] = function (t, n) {\n        // eslint-disable-next-line\n        for (var o, e = 0; o = u[e]; ++e) {\n          if (o[0] == this && o[1] == t && o[2] == n) return this.detachEvent('on' + t, u.splice(e, 1)[0][3]);\n        }\n      }; // eslint-disable-next-line\n\n\n      t[i] = n[i] = o[i] = function (t) {\n        return this.fireEvent('on' + t.type, t);\n      };\n    }(window.prototype, document.prototype, Element.prototype, 'addEventListener', 'removeEventListener', 'dispatchEvent', []); // eslint-disable-next-line\n\n    Array.prototype.indexOf || (Array.prototype.indexOf = function (t, n) {\n      var o;\n      if (this === null) throw new TypeError('\"this\" is null or not defined');\n      var e = Object(this);\n      var r = e.length >>> 0;\n      if (r === 0) return -1;\n      var i = +n || 0; // eslint-disable-next-line\n\n      if (Math.abs(i) === 1 / 0 && (i = 0), i >= r) return -1;\n\n      for (o = Math.max(i >= 0 ? i : r - Math.abs(i), 0); r > o;) {\n        if (o in e && e[o] === t) return o;\n        o++;\n      }\n\n      return -1;\n    });\n    Array.isArray || (Array.isArray = function (t) {\n      return Object.prototype.toString.call(t) === '[object Array]';\n    }); // Fetch Polyfill\n\n    var support = {\n      searchParams: 'URLSearchParams' in self,\n      iterable: 'Symbol' in self && 'iterator' in Symbol,\n      blob: 'FileReader' in self && 'Blob' in self && function () {\n        try {\n          new Blob();\n          return true;\n        } catch (e) {\n          return false;\n        }\n      }(),\n      formData: 'FormData' in self,\n      arrayBuffer: 'ArrayBuffer' in self\n    };\n\n    function isDataView(obj) {\n      return obj && DataView.prototype.isPrototypeOf(obj);\n    }\n\n    if (support.arrayBuffer) {\n      var viewClasses = ['[object Int8Array]', '[object Uint8Array]', '[object Uint8ClampedArray]', '[object Int16Array]', '[object Uint16Array]', '[object Int32Array]', '[object Uint32Array]', '[object Float32Array]', '[object Float64Array]'];\n\n      var isArrayBufferView = ArrayBuffer.isView || function (obj) {\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1;\n      };\n    }\n\n    function normalizeName(name) {\n      if (typeof name !== 'string') {\n        name = String(name);\n      }\n\n      if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n        throw new TypeError('Invalid character in header field name');\n      }\n\n      return name.toLowerCase();\n    }\n\n    function normalizeValue(value) {\n      if (typeof value !== 'string') {\n        value = String(value);\n      }\n\n      return value;\n    } // Build a destructive iterator for the value list\n\n\n    function iteratorFor(items) {\n      var iterator = {\n        next: function next() {\n          var value = items.shift();\n          return {\n            done: value === undefined,\n            value: value\n          };\n        }\n      };\n\n      if (support.iterable) {\n        iterator[Symbol.iterator] = function () {\n          return iterator;\n        };\n      }\n\n      return iterator;\n    }\n\n    window.Headers = function (headers) {\n      this.map = {};\n\n      if (headers instanceof Headers) {\n        headers.forEach(function (value, name) {\n          this.append(name, value);\n        }, this);\n      } else if (Array.isArray(headers)) {\n        headers.forEach(function (header) {\n          this.append(header[0], header[1]);\n        }, this);\n      } else if (headers) {\n        Object.getOwnPropertyNames(headers).forEach(function (name) {\n          this.append(name, headers[name]);\n        }, this);\n      }\n    };\n\n    Headers.prototype.append = function (name, value) {\n      name = normalizeName(name);\n      value = normalizeValue(value);\n      var oldValue = this.map[name];\n      this.map[name] = oldValue ? oldValue + ', ' + value : value;\n    };\n\n    Headers.prototype['delete'] = function (name) {\n      delete this.map[normalizeName(name)];\n    };\n\n    Headers.prototype.get = function (name) {\n      name = normalizeName(name);\n      return this.has(name) ? this.map[name] : null;\n    };\n\n    Headers.prototype.has = function (name) {\n      return this.map.hasOwnProperty(normalizeName(name));\n    };\n\n    Headers.prototype.set = function (name, value) {\n      this.map[normalizeName(name)] = normalizeValue(value);\n    };\n\n    Headers.prototype.forEach = function (callback, thisArg) {\n      for (var name in this.map) {\n        if (this.map.hasOwnProperty(name)) {\n          callback.call(thisArg, this.map[name], name, this);\n        }\n      }\n    };\n\n    Headers.prototype.keys = function () {\n      var items = [];\n      this.forEach(function (value, name) {\n        items.push(name);\n      });\n      return iteratorFor(items);\n    };\n\n    Headers.prototype.values = function () {\n      var items = [];\n      this.forEach(function (value) {\n        items.push(value);\n      });\n      return iteratorFor(items);\n    };\n\n    Headers.prototype.entries = function () {\n      var items = [];\n      this.forEach(function (value, name) {\n        items.push([name, value]);\n      });\n      return iteratorFor(items);\n    };\n\n    if (support.iterable) {\n      Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n    }\n\n    function consumed(body) {\n      if (body.bodyUsed) {\n        return Promise.reject(new TypeError('Already read'));\n      }\n\n      body.bodyUsed = true;\n    }\n\n    function fileReaderReady(reader) {\n      return new Promise(function (resolve, reject) {\n        reader.onload = function () {\n          resolve(reader.result);\n        };\n\n        reader.onerror = function () {\n          reject(reader.error);\n        };\n      });\n    }\n\n    function readBlobAsArrayBuffer(blob) {\n      var reader = new FileReader();\n      var promise = fileReaderReady(reader);\n      reader.readAsArrayBuffer(blob);\n      return promise;\n    }\n\n    function readBlobAsText(blob) {\n      var reader = new FileReader();\n      var promise = fileReaderReady(reader);\n      reader.readAsText(blob);\n      return promise;\n    }\n\n    function readArrayBufferAsText(buf) {\n      var view = new Uint8Array(buf);\n      var chars = new Array(view.length);\n\n      for (var i = 0; i < view.length; i++) {\n        chars[i] = String.fromCharCode(view[i]);\n      }\n\n      return chars.join('');\n    }\n\n    function bufferClone(buf) {\n      if (buf.slice) {\n        return buf.slice(0);\n      } else {\n        var view = new Uint8Array(buf.byteLength);\n        view.set(new Uint8Array(buf));\n        return view.buffer;\n      }\n    }\n\n    function Body() {\n      this.bodyUsed = false;\n\n      this._initBody = function (body) {\n        this._bodyInit = body;\n\n        if (!body) {\n          this._bodyText = '';\n        } else if (typeof body === 'string') {\n          this._bodyText = body;\n        } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n          this._bodyBlob = body;\n        } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n          this._bodyFormData = body;\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this._bodyText = body.toString();\n        } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n          this._bodyArrayBuffer = bufferClone(body.buffer); // IE 10-11 can't handle a DataView body.\n\n          this._bodyInit = new Blob([this._bodyArrayBuffer]);\n        } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n          this._bodyArrayBuffer = bufferClone(body);\n        } else {\n          this._bodyText = body = Object.prototype.toString.call(body);\n        }\n\n        if (!this.headers.get('content-type')) {\n          if (typeof body === 'string') {\n            this.headers.set('content-type', 'text/plain;charset=UTF-8');\n          } else if (this._bodyBlob && this._bodyBlob.type) {\n            this.headers.set('content-type', this._bodyBlob.type);\n          } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n            this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n          }\n        }\n      };\n\n      if (support.blob) {\n        this.blob = function () {\n          var rejected = consumed(this);\n\n          if (rejected) {\n            return rejected;\n          }\n\n          if (this._bodyBlob) {\n            return Promise.resolve(this._bodyBlob);\n          } else if (this._bodyArrayBuffer) {\n            return Promise.resolve(new Blob([this._bodyArrayBuffer]));\n          } else if (this._bodyFormData) {\n            throw new Error('could not read FormData body as blob');\n          } else {\n            return Promise.resolve(new Blob([this._bodyText]));\n          }\n        };\n\n        this.arrayBuffer = function () {\n          if (this._bodyArrayBuffer) {\n            return consumed(this) || Promise.resolve(this._bodyArrayBuffer);\n          } else {\n            return this.blob().then(readBlobAsArrayBuffer);\n          }\n        };\n      }\n\n      this.text = function () {\n        var rejected = consumed(this);\n\n        if (rejected) {\n          return rejected;\n        }\n\n        if (this._bodyBlob) {\n          return readBlobAsText(this._bodyBlob);\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as text');\n        } else {\n          return Promise.resolve(this._bodyText);\n        }\n      };\n\n      if (support.formData) {\n        this.formData = function () {\n          return this.text().then(decode);\n        };\n      }\n\n      this.json = function () {\n        return this.text().then(JSON.parse);\n      };\n\n      return this;\n    } // HTTP methods whose capitalization should be normalized\n\n\n    var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n    function normalizeMethod(method) {\n      var upcased = method.toUpperCase();\n      return methods.indexOf(upcased) > -1 ? upcased : method;\n    }\n\n    window.Request = function (input, options) {\n      options = options || {};\n      var body = options.body;\n\n      if (input instanceof Request) {\n        if (input.bodyUsed) {\n          throw new TypeError('Already read');\n        }\n\n        this.url = input.url;\n        this.credentials = input.credentials;\n\n        if (!options.headers) {\n          this.headers = new Headers(input.headers);\n        }\n\n        this.method = input.method;\n        this.mode = input.mode;\n        this.signal = input.signal;\n\n        if (!body && input._bodyInit != null) {\n          body = input._bodyInit;\n          input.bodyUsed = true;\n        }\n      } else {\n        this.url = String(input);\n      }\n\n      this.credentials = options.credentials || this.credentials || 'same-origin';\n\n      if (options.headers || !this.headers) {\n        this.headers = new Headers(options.headers);\n      }\n\n      this.method = normalizeMethod(options.method || this.method || 'GET');\n      this.mode = options.mode || this.mode || null;\n      this.signal = options.signal || this.signal;\n      this.referrer = null;\n\n      if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n        throw new TypeError('Body not allowed for GET or HEAD requests');\n      }\n\n      this._initBody(body);\n    };\n\n    Request.prototype.clone = function () {\n      return new Request(this, {\n        body: this._bodyInit\n      });\n    };\n\n    function decode(body) {\n      var form = new FormData();\n      body.trim().split('&').forEach(function (bytes) {\n        if (bytes) {\n          var split = bytes.split('=');\n          var name = split.shift().replace(/\\+/g, ' ');\n          var value = split.join('=').replace(/\\+/g, ' ');\n          form.append(decodeURIComponent(name), decodeURIComponent(value));\n        }\n      });\n      return form;\n    }\n\n    function parseHeaders(rawHeaders) {\n      var headers = new Headers(); // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n      // https://tools.ietf.org/html/rfc7230#section-3.2\n\n      var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n      preProcessedHeaders.split(/\\r?\\n/).forEach(function (line) {\n        var parts = line.split(':');\n        var key = parts.shift().trim();\n\n        if (key) {\n          var value = parts.join(':').trim();\n          headers.append(key, value);\n        }\n      });\n      return headers;\n    }\n\n    Body.call(Request.prototype);\n\n    window.Response = function (bodyInit, options) {\n      if (!options) {\n        options = {};\n      }\n\n      this.type = 'default';\n      this.status = options.status === undefined ? 200 : options.status;\n      this.ok = this.status >= 200 && this.status < 300;\n      this.statusText = 'statusText' in options ? options.statusText : 'OK';\n      this.headers = new Headers(options.headers);\n      this.url = options.url || '';\n\n      this._initBody(bodyInit);\n    };\n\n    Body.call(Response.prototype);\n\n    Response.prototype.clone = function () {\n      return new Response(this._bodyInit, {\n        status: this.status,\n        statusText: this.statusText,\n        headers: new Headers(this.headers),\n        url: this.url\n      });\n    };\n\n    Response.error = function () {\n      var response = new Response(null, {\n        status: 0,\n        statusText: ''\n      });\n      response.type = 'error';\n      return response;\n    };\n\n    var redirectStatuses = [301, 302, 303, 307, 308];\n\n    Response.redirect = function (url, status) {\n      if (redirectStatuses.indexOf(status) === -1) {\n        throw new RangeError('Invalid status code');\n      }\n\n      return new Response(null, {\n        status: status,\n        headers: {\n          location: url\n        }\n      });\n    };\n\n    var DOMException = window.DOMException;\n\n    try {\n      new DOMException();\n    } catch (err) {\n      DOMException = function DOMException(message, name) {\n        this.message = message;\n        this.name = name;\n        var error = Error(message);\n        this.stack = error.stack;\n      };\n\n      DOMException.prototype = Object.create(Error.prototype);\n      DOMException.prototype.constructor = DOMException;\n    }\n\n    window.fetch = function fetch(input, init) {\n      return new Promise(function (resolve, reject) {\n        var request = new Request(input, init);\n\n        if (request.signal && request.signal.aborted) {\n          return reject(new DOMException('Aborted', 'AbortError'));\n        }\n\n        var xhr = new XMLHttpRequest();\n\n        function abortXhr() {\n          xhr.abort();\n        }\n\n        xhr.onload = function () {\n          var options = {\n            status: xhr.status,\n            statusText: xhr.statusText,\n            headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n          };\n          options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n          var body = 'response' in xhr ? xhr.response : xhr.responseText;\n          resolve(new Response(body, options));\n        };\n\n        xhr.onerror = function () {\n          reject(new TypeError('Network request failed'));\n        };\n\n        xhr.ontimeout = function () {\n          reject(new TypeError('Network request failed'));\n        };\n\n        xhr.onabort = function () {\n          reject(new DOMException('Aborted', 'AbortError'));\n        };\n\n        xhr.open(request.method, request.url, true);\n\n        if (request.credentials === 'include') {\n          xhr.withCredentials = true;\n        } else if (request.credentials === 'omit') {\n          xhr.withCredentials = false;\n        }\n\n        if ('responseType' in xhr && support.blob) {\n          xhr.responseType = 'blob';\n        }\n\n        request.headers.forEach(function (value, name) {\n          xhr.setRequestHeader(name, value);\n        });\n\n        if (request.signal) {\n          request.signal.addEventListener('abort', abortXhr);\n\n          xhr.onreadystatechange = function () {\n            // DONE (success or failure)\n            if (xhr.readyState === 4) {\n              request.signal.removeEventListener('abort', abortXhr);\n            }\n          };\n        }\n\n        xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n      });\n    };\n\n    fetch.polyfill = true;\n\n    var isFunction = function _isFunction(object) {\n      return toString.call(object) === '[object Function]';\n    };\n\n    var isObject = function _isObject(object) {\n      var type = _typeof(object);\n\n      return type === 'function' || type === 'object' && !!object;\n    };\n\n    var getURLParam = function _getURLParam(name) {\n      var nameParam = name.replace(/[\\[]/, '\\\\\\[').replace(/[\\]]/, '\\\\\\]');\n      var regexS = '[\\\\?&]' + nameParam + '=([^&#]*)';\n      var regex = new RegExp(regexS);\n\n      if (document.location.search) {\n        var results = regex.exec(document.location.search);\n\n        if (results) {\n          return results[1];\n        }\n\n        return '';\n      }\n\n      return '';\n    };\n\n    var hasCookie = function _hasCookie(name) {\n      logger.log('looking for cookie with name of: ', name);\n      if (typeof window === 'undefined') return false;\n\n      if (document.cookie) {\n        logger.log('found?', document.cookie.indexOf('; ' + name + '=') >= 0 || document.cookie.indexOf(name + '=') === 0);\n        return document.cookie.indexOf('; ' + name + '=') >= 0 || document.cookie.indexOf(name + '=') === 0;\n      }\n\n      return false;\n    };\n\n    var getViewport = function _getViewport() {\n      var viewportWidth;\n      var viewportHeight;\n\n      if (typeof window.innerWidth !== 'undefined') {\n        viewportWidth = window.innerWidth;\n        viewportHeight = window.innerHeight;\n      } else if (typeof document.documentElement !== 'undefined' && typeof document.documentElement.clientWidth !== 'undefined' && document.documentElement.clientWidth !== 0) {\n        viewportWidth = document.documentElement.clientWidth;\n        viewportHeight = document.documentElement.clientHeight;\n      } else {\n        viewportWidth = document.getElementsByTagName('body')[0].clientWidth;\n        viewportHeight = document.getElementsByTagName('body')[0].clientHeight;\n      }\n\n      return [viewportWidth, viewportHeight];\n    };\n\n    var getBrowser = function _getBrowser() {\n      logger.time('Getting Browser Information');\n      var ua = navigator.userAgent;\n      var tem;\n      var M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || [];\n\n      if (/trident/i.test(M[1])) {\n        tem = /\\brv[ :]+(\\d+)/g.exec(ua) || [];\n        return 'IE ' + (tem[1] || '');\n      }\n\n      if (M[1] === 'Chrome') {\n        tem = ua.match(/\\b(OPR|Edge)\\/(\\d+)/);\n        if (tem !== null) return tem.slice(1).join(' ').replace('OPR', 'Opera');\n      }\n\n      M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?']; // eslint-disable-next-line\n\n      if ((tem = ua.match(/version\\/(\\d+)/i)) !== null) M.splice(1, 1, tem[1]);\n      logger.timeEnd('Getting Browser Information');\n      return M.join(' ');\n    };\n\n    var readCookie = function _readCookie(name) {\n      var readTheCookie = function readTheCookie(key) {\n        if (!document.cookie) {\n          // there is no cookie, so go no further\n          return null;\n        } // there is a cookie\n\n\n        var ca = document.cookie.split(';');\n        var nameEQ = key + '=';\n\n        for (var i = 0; i < ca.length; i++) {\n          var c = ca[i];\n\n          while (c.charAt(0) === ' ') {\n            // delete spaces\n            c = c.substring(1, c.length);\n          }\n\n          if (c.indexOf(nameEQ) === 0) {\n            return c.substring(nameEQ.length, c.length);\n          }\n        }\n\n        return null;\n      };\n\n      var lsSupport = false;\n      var data = null; // Check for native support\n\n      if (localStorage) {\n        lsSupport = true;\n      } // No value supplied, return value\n\n\n      if (typeof value === 'undefined') {\n        // Get value\n        if (lsSupport) {\n          // Native support\n          data = localStorage.getItem(name);\n        }\n\n        if (!lsSupport || data === null) {\n          // Use cookie\n          data = readTheCookie(name);\n        } // Try to parse JSON...\n\n\n        try {\n          data = JSON.parse(data);\n        } catch (e) {// Do Nothing\n        }\n      }\n\n      return data;\n    };\n\n    var emptyTarget = function emptyTarget(value) {\n      return Array.isArray(value) ? [] : {};\n    };\n\n    function deepmerge(target, source, optionsArgument) {\n      var array = Array.isArray(source);\n      var options = optionsArgument || {\n        arrayMerge: combineMerge\n      };\n      var arrayMerge = options.arrayMerge || combineMerge;\n\n      if (array) {\n        return Array.isArray(target) ? arrayMerge(target, source, optionsArgument) : cloneIfNecessary(source, optionsArgument);\n      } else {\n        return mergeObject(target, source, optionsArgument);\n      }\n    }\n\n    function combineMerge(target, source, options) {\n      var destination = target.slice();\n      source.forEach(function (e, i) {\n        if (typeof destination[i] === 'undefined') {\n          var cloneRequested = clone !== false;\n          var shouldClone = cloneRequested && isMergeableObject(e);\n          destination[i] = shouldClone ? deepmerge(emptyTarget(e), e, options) : e;\n        } else if (isMergeableObject(e)) {\n          destination[i] = merge(target[i], e, options);\n        } else if (target.indexOf(e) === -1) {\n          destination.push(e);\n        }\n      });\n      return destination;\n    }\n\n    function isMergeableObject(val) {\n      var nonNullObject = val && _typeof(val) === 'object';\n      return nonNullObject && Object.prototype.toString.call(val) !== '[object RegExp]' && Object.prototype.toString.call(val) !== '[object Date]';\n    }\n\n    function cloneIfNecessary(value, optionsArgument) {\n      var clone = optionsArgument && optionsArgument.clone === true;\n      return clone && isMergeableObject(value) ? deepmerge(emptyTarget(value), value, optionsArgument) : value;\n    }\n\n    function defaultArrayMerge(target, source, optionsArgument) {\n      var destination = target.slice();\n      source.forEach(function (e, i) {\n        if (typeof destination[i] === 'undefined') {\n          destination[i] = cloneIfNecessary(e, optionsArgument);\n        } else if (isMergeableObject(e)) {\n          destination[i] = deepmerge(target[i], e, optionsArgument);\n        } else if (target.indexOf(e) === -1) {\n          destination.push(cloneIfNecessary(e, optionsArgument));\n        }\n      });\n      return destination;\n    }\n\n    function mergeObject(target, source, optionsArgument) {\n      var destination = {};\n\n      if (isMergeableObject(target)) {\n        Object.keys(target).forEach(function (key) {\n          destination[key] = cloneIfNecessary(target[key], optionsArgument);\n        });\n      }\n\n      Object.keys(source).forEach(function (key) {\n        if (!isMergeableObject(source[key]) || !target[key]) {\n          destination[key] = cloneIfNecessary(source[key], optionsArgument);\n        } else {\n          destination[key] = deepmerge(target[key], source[key], optionsArgument);\n        }\n      });\n      return destination;\n    }\n\n    deepmerge.all = function deepmergeAll(array, optionsArgument) {\n      if (!Array.isArray(array) || array.length < 2) {\n        throw new Error('first argument should be an array with at least two elements');\n      } // we are sure there are at least 2 values, so it is safe to have no initial value\n\n\n      return array.reduce(function (prev, next) {\n        return deepmerge(prev, next, optionsArgument);\n      });\n    };\n\n    var mergeDeep = function mergeDeep(target, source) {\n      return deepmerge(target, source);\n    };\n\n    var countryCode = readCookie('countryCode') || (readCookie('CG') ? readCookie('CG').substr(0, 2) : '');\n    var appId = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c';\n    var locationServiceURL = 'https://geo.ngtv.io/locate?appId=' + appId;\n\n    function getLocation() {\n      fetch(locationServiceURL).then(function (resp) {\n        return resp.json();\n      }).then(function (loc) {\n        countryCode = loc.country;\n      }).catch(function (err) {\n        logger.err(\"Could Not Get User Location: \", err);\n      });\n    }\n\n    var selectedEdition = readCookie('SelectedEdition') ? readCookie('SelectedEdition') : 'www';\n    var monetizedSizes = ['160x600', '300x250', '300x600', '320x50', '728x90', '970x90', '970x250'];\n    var invalidMappings = ['_ns_', '_nfs_'];\n    var invalidAdUnitSegments = ['super-ad-zone', 'super_ad_zone'];\n    var invalidAdUnits = ['CNN/health', 'CNN/health/healthgrades', 'CNN/health/leaf', 'CNN/health/list', 'CNN/health/photos', 'CNN/health/specials', 'CNN/health/video', 'CNN/student-news'];\n\n    var getLogger = function _getLogger(moduleName, moduleVersion, logKey, style) {\n      var log = noop;\n      var info = noop;\n      var warn = noop;\n      var time = noop;\n      var timeEnd = noop;\n      var group = noop;\n      var groupEnd = noop;\n      var error = noop;\n      var inGroup = false;\n      var args;\n      var styleFinal = style || '';\n      var logKeyFinal = logKey || moduleName.toLowerCase();\n      var debug = getURLParam('debug').split(',');\n      var debugTest = isObject(window.console) && isFunction(window.console.log) && (debug[0] === \"true\" || debug.indexOf(logKeyFinal.toLowerCase()) >= 0);\n\n      if (debugTest) {\n        log = function _logFunc()\n        /* arguments */\n        {\n          if (!inGroup) {\n            args = ['%c[' + moduleName + ' ' + moduleVersion + '] ', styleFinal];\n            args.push.apply(args, arguments);\n            window.console.log.apply(window.console, args);\n          } else {\n            args = ['%c[' + moduleName + ' ' + moduleVersion + '] ', styleFinal];\n            args.push.apply(args, arguments);\n            window.console.log.apply(window.console, args);\n          }\n        };\n\n        info = function _infoFunc()\n        /* arguments */\n        {\n          if (!inGroup) {\n            args = ['%c[' + moduleName + ' ' + moduleVersion + '] ', styleFinal];\n            args.push.apply(args, arguments);\n            window.console.info.apply(window.console, args);\n          } else {\n            args = ['%c[' + moduleName + ' ' + moduleVersion + '] ', styleFinal];\n            args.push.apply(args, arguments);\n            window.console.info.apply(window.console, args);\n          }\n        };\n\n        warn = function _warnFunc()\n        /* arguments */\n        {\n          if (!inGroup) {\n            args = ['%c[' + moduleName + ' ' + moduleVersion + '] ', styleFinal];\n            args.push.apply(args, arguments);\n            window.console.warn.apply(window.console, args);\n          } else {\n            args = ['%c[' + moduleName + ' ' + moduleVersion + '] ', styleFinal];\n            args.push.apply(args, arguments);\n            window.console.warn.apply(window.console, args);\n          }\n        };\n\n        error = function _errorFunc()\n        /* arguments */\n        {\n          if (!inGroup) {\n            args = ['%c[' + moduleName + ' ' + moduleVersion + '] ', styleFinal];\n            args.push.apply(args, arguments);\n            window.console.error.apply(window.console, args);\n          } else {\n            args = ['%c[' + moduleName + ' ' + moduleVersion + '] ', styleFinal];\n            args.push.apply(args, arguments);\n            window.console.error.apply(window.console, args);\n          }\n        };\n\n        group = function _groupFunc(groupName) {\n          if (!inGroup) {\n            var args = ['%c[' + moduleName + ' ' + moduleVersion + ']', styleFinal, groupName];\n            inGroup = true;\n            window.console.groupCollapsed.apply(window.console, args);\n          }\n        };\n\n        groupEnd = function _groupEndFunc(groupName) {\n          var args = ['%c[' + moduleName + ' ' + moduleVersion + ']', styleFinal, groupName];\n          inGroup = false;\n\n          try {\n            window.console.groupEnd.apply(window.console, args);\n          } catch (err) {// Do Nothing\n          }\n        };\n\n        time = function _timeFunc(timeTag) {\n          var timeKey = '[' + moduleName + ' ' + moduleVersion + '] - ' + timeTag;\n          group(timeTag);\n          addMark(timeKey + '-Start');\n          window.console.time(timeKey);\n        };\n\n        timeEnd = function _timeEndFunc(timeTag) {\n          var timeKey = '[' + moduleName + ' ' + moduleVersion + '] - ' + timeTag;\n          addMark(timeKey + '-End');\n          addMeasure(timeKey, timeKey + '-Start', timeKey + '-End');\n          groupEnd(timeTag);\n          window.console.timeEnd(timeKey);\n        };\n      }\n\n      var logger = {\n        log: log,\n        info: info,\n        warn: warn,\n        error: error,\n        time: time,\n        timeEnd: timeEnd,\n        group: group,\n        groupEnd: groupEnd\n      };\n      return logger;\n    };\n\n    var objectProto = Object.prototype;\n    var toString = objectProto.toString;\n\n    var noop = function noop() {};\n\n    var isIntl = false;\n    var parser = document.createElement('a');\n    parser.href = document.location.href;\n    var hostname = parser.hostname;\n    var pathname = parser.pathname;\n    var logger = getLogger(MODULE_NAME, MODULE_VERSION, 'utils', 'color: coral; padding: 2px');\n\n    var addEvent = function _addEvent(element, event, fn) {\n      if (element.addEventListener) {\n        element.addEventListener(event, fn, true);\n      } else if (element.attachEvent) {\n        element.attachEvent('on' + event, fn);\n      }\n    };\n\n    var bind = function _bind(fn, context\n    /* , function arguments */\n    ) {\n      if (!isFunction(fn)) {\n        throw new TypeError('Bind must be called on a function');\n      }\n\n      var args = Array.prototype.slice.call(arguments, 2);\n      return function bound() {\n        return fn.apply(context, args.concat(Array.prototype.slice.call(arguments)));\n      };\n    };\n\n    var re = /(([^<>()\\[\\]\\.,;:\\s@\\\"]+(\\.[^<>()\\[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()\\[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()\\[\\]\\.,;:\\s@\\\"]{2,})/i;\n\n    var piiIsPresentInQueryString = function _piiIsPresentInQueryString() {\n      if (document.location.search) {\n        var dirtyResults = document.location.search.search(re) + 1;\n        var cleanResults;\n\n        try {\n          cleanResults = decodeURIComponent(document.location.search).search(re) + 1;\n        } catch (err) {\n          cleanResults = dirtyResults;\n        }\n\n        return dirtyResults === 1 || cleanResults === 1;\n      }\n\n      return false;\n    };\n\n    var piiIsPresentInHash = function _piiIsPresentInHash() {\n      if (document.location.hash) {\n        var dirtyResults = document.location.hash.search(re) + 1;\n        var cleanResults;\n\n        try {\n          cleanResults = decodeURIComponent(document.location.hash).search(re) + 1;\n        } catch (err) {\n          cleanResults = dirtyResults;\n        }\n\n        return dirtyResults || cleanResults;\n      }\n\n      return false;\n    };\n\n    var piiIsPresentInReferrer = function _piiIsPresentInReferrer() {\n      if (document.referrer) {\n        var dirtyResults = document.referrer.search(re) + 1;\n        var cleanResults;\n\n        try {\n          cleanResults = decodeURIComponent(document.location.referrer).search(re) + 1;\n        } catch (err) {\n          cleanResults = dirtyResults;\n        }\n\n        return dirtyResults || cleanResults;\n      }\n\n      return false;\n    };\n\n    var filterDFPRequest = function _filterDFPRequest() {\n      if (piiIsPresentInQueryString() || piiIsPresentInHash() || piiIsPresentInReferrer()) {\n        if (window.AdFuel) {\n          logger.log('Filtering DFP Request due to PII in query string.');\n          var AdFuelMethods = Object.getOwnPropertyNames(window.AdFuel);\n\n          for (var x = 0; x < AdFuelMethods.length; x++) {\n            window.AdFuel[AdFuelMethods[x]] = function filteredAdFuelMethod() {};\n          }\n\n          window.googletag = null;\n        }\n\n        return true;\n      }\n\n      return false;\n    };\n\n    var piiFilter = {\n      qs: piiIsPresentInQueryString,\n      hash: piiIsPresentInHash,\n      ref: piiIsPresentInReferrer,\n      filter: filterDFPRequest\n    };\n    var base64 = {\n      _keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\n      encode: function encode(e) {\n        var t = \"\";\n        var n, r, i, s, o, u, a;\n        var f = 0;\n        e = base64._utf8_encode(e);\n\n        while (f < e.length) {\n          n = e.charCodeAt(f++);\n          r = e.charCodeAt(f++);\n          i = e.charCodeAt(f++);\n          s = n >> 2;\n          o = (n & 3) << 4 | r >> 4;\n          u = (r & 15) << 2 | i >> 6;\n          a = i & 63;\n\n          if (isNaN(r)) {\n            u = a = 64;\n          } else if (isNaN(i)) {\n            a = 64;\n          }\n\n          t = t + this._keyStr.charAt(s) + this._keyStr.charAt(o) + this._keyStr.charAt(u) + this._keyStr.charAt(a);\n        }\n\n        return t;\n      },\n      decode: function decode(e) {\n        var t = \"\";\n        var n, r, i;\n        var s, o, u, a;\n        var f = 0;\n        e = e.replace(/[^A-Za-z0-9+/=]/g, \"\");\n\n        while (f < e.length) {\n          s = this._keyStr.indexOf(e.charAt(f++));\n          o = this._keyStr.indexOf(e.charAt(f++));\n          u = this._keyStr.indexOf(e.charAt(f++));\n          a = this._keyStr.indexOf(e.charAt(f++));\n          n = s << 2 | o >> 4;\n          r = (o & 15) << 4 | u >> 2;\n          i = (u & 3) << 6 | a;\n          t = t + String.fromCharCode(n);\n\n          if (u != 64) {\n            t = t + String.fromCharCode(r);\n          }\n\n          if (a != 64) {\n            t = t + String.fromCharCode(i);\n          }\n        }\n\n        t = base64._utf8_decode(t);\n        return t;\n      },\n      _utf8_encode: function _utf8_encode(e) {\n        e = e.replace(/rn/g, \"n\");\n        var t = \"\";\n\n        for (var n = 0; n < e.length; n++) {\n          var r = e.charCodeAt(n);\n\n          if (r < 128) {\n            t += String.fromCharCode(r);\n          } else if (r > 127 && r < 2048) {\n            t += String.fromCharCode(r >> 6 | 192);\n            t += String.fromCharCode(r & 63 | 128);\n          } else {\n            t += String.fromCharCode(r >> 12 | 224);\n            t += String.fromCharCode(r >> 6 & 63 | 128);\n            t += String.fromCharCode(r & 63 | 128);\n          }\n        }\n\n        return t;\n      },\n      _utf8_decode: function _utf8_decode(e) {\n        var t = \"\";\n        var n = 0;\n        var r = c1 = c2 = 0;\n\n        while (n < e.length) {\n          r = e.charCodeAt(n);\n\n          if (r < 128) {\n            t += String.fromCharCode(r);\n            n++;\n          } else if (r > 191 && r < 224) {\n            c2 = e.charCodeAt(n + 1);\n            t += String.fromCharCode((r & 31) << 6 | c2 & 63);\n            n += 2;\n          } else {\n            c2 = e.charCodeAt(n + 1);\n            c3 = e.charCodeAt(n + 2);\n            t += String.fromCharCode((r & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\n            n += 3;\n          }\n        }\n\n        return t;\n      }\n    };\n    var versionNumBits = 6;\n    var vendorVersionMap = {\n      /**\n       * Version 1\n       */\n      1: {\n        version: 1,\n        metadataFields: ['version', 'created', 'lastUpdated', 'cmpId', 'cmpVersion', 'consentScreen', 'vendorListVersion'],\n        fields: [{\n          name: 'version',\n          type: 'int',\n          numBits: 6\n        }, {\n          name: 'created',\n          type: 'date',\n          numBits: 36\n        }, {\n          name: 'lastUpdated',\n          type: 'date',\n          numBits: 36\n        }, {\n          name: 'cmpId',\n          type: 'int',\n          numBits: 12\n        }, {\n          name: 'cmpVersion',\n          type: 'int',\n          numBits: 12\n        }, {\n          name: 'consentScreen',\n          type: 'int',\n          numBits: 6\n        }, {\n          name: 'consentLanguage',\n          type: 'language',\n          numBits: 12\n        }, {\n          name: 'vendorListVersion',\n          type: 'int',\n          numBits: 12\n        }, {\n          name: 'purposeIdBitString',\n          type: 'bits',\n          numBits: 24\n        }, {\n          name: 'maxVendorId',\n          type: 'int',\n          numBits: 16\n        }, {\n          name: 'isRange',\n          type: 'bool',\n          numBits: 1\n        }, {\n          name: 'vendorIdBitString',\n          type: 'bits',\n          numBits: function numBits(decodedObject) {\n            return decodedObject.maxVendorId;\n          },\n          validator: function validator(decodedObject) {\n            return !decodedObject.isRange;\n          }\n        }, {\n          name: 'defaultConsent',\n          type: 'bool',\n          numBits: 1,\n          validator: function validator(decodedObject) {\n            return decodedObject.isRange;\n          }\n        }, {\n          name: 'numEntries',\n          numBits: 12,\n          type: 'int',\n          validator: function validator(decodedObject) {\n            return decodedObject.isRange;\n          }\n        }, {\n          name: 'vendorRangeList',\n          type: 'list',\n          listCount: function listCount(decodedObject) {\n            return decodedObject.numEntries;\n          },\n          validator: function validator(decodedObject) {\n            return decodedObject.isRange;\n          },\n          fields: [{\n            name: 'isRange',\n            type: 'bool',\n            numBits: 1\n          }, {\n            name: 'startVendorId',\n            type: 'int',\n            numBits: 16\n          }, {\n            name: 'endVendorId',\n            type: 'int',\n            numBits: 16,\n            validator: function validator(decodedObject) {\n              return decodedObject.isRange;\n            }\n          }]\n        }]\n      }\n    };\n\n    function repeat(count, string) {\n      string = string || '0';\n      var padString = '';\n\n      for (var i = 0; i < count; i += 1) {\n        padString += string;\n      }\n\n      return padString;\n    }\n\n    function padLeft(string, padding) {\n      return repeat(Math.max(0, padding)) + string;\n    }\n\n    function decodeBitsToInt(bitString, start, length) {\n      return parseInt(bitString.substr(start, length), 2);\n    }\n\n    function decodeBitsToDate(bitString, start, length) {\n      return new Date(decodeBitsToInt(bitString, start, length) * 100);\n    }\n\n    function decodeBitsToBool(bitString, start) {\n      return parseInt(bitString.substr(start, 1), 2) === 1;\n    }\n\n    function decodeBitsToLetter(bitString) {\n      var letterCode = decodeBitsToInt(bitString);\n      return String.fromCharCode(letterCode + 65).toLowerCase();\n    }\n\n    function decodeBitsToLanguage(bitString, start, length) {\n      var languageBitString = bitString.substr(start, length);\n      return decodeBitsToLetter(languageBitString.slice(0, length / 2)) + decodeBitsToLetter(languageBitString.slice(length / 2));\n    }\n\n    function decodeField(data) {\n      var input = data.input;\n      var output = data.output;\n      var startPosition = data.startPosition;\n      var field = data.field;\n      var type = field.type;\n      var numBits = field.numBits;\n      var decoder = field.decoder;\n      var validator = field.validator;\n      var listCount = field.listCount;\n\n      if (typeof validator === 'function') {\n        if (!validator(output)) {\n          // Not decoding this field so make sure we start parsing the next field at\n          // the same point\n          return {\n            newPosition: startPosition\n          };\n        }\n      }\n\n      if (typeof decoder === 'function') {\n        return decoder(input, output, startPosition);\n      }\n\n      var bitCount = typeof numBits === 'function' ? numBits(output) : numBits;\n\n      switch (type) {\n        case 'int':\n          return {\n            fieldValue: decodeBitsToInt(input, startPosition, bitCount)\n          };\n\n        case 'bool':\n          return {\n            fieldValue: decodeBitsToBool(input, startPosition)\n          };\n\n        case 'date':\n          return {\n            fieldValue: decodeBitsToDate(input, startPosition, bitCount)\n          };\n\n        case 'bits':\n          return {\n            fieldValue: input.substr(startPosition, bitCount)\n          };\n\n        case 'list':\n          return decodeList(input, output, startPosition, field, listCount);\n\n        case 'language':\n          return {\n            fieldValue: decodeBitsToLanguage(input, startPosition, bitCount)\n          };\n\n        default:\n          throw new Error('ConsentString - Unknown field type ' + type + ' for decoding');\n      }\n    }\n\n    function decodeList(input, output, startPosition, field, listCount) {\n      var listEntryCount = 0;\n\n      if (typeof listCount === 'function') {\n        listEntryCount = listCount(output);\n      } else if (typeof listCount === 'number') {\n        listEntryCount = listCount;\n      }\n\n      var newPosition = startPosition;\n      var fieldValue = [];\n\n      for (var i = 0; i < listEntryCount; i += 1) {\n        var decodedFields = decodeFields({\n          input: input,\n          fields: field.fields,\n          startPosition: newPosition\n        });\n        newPosition = decodedFields.newPosition;\n        fieldValue.push(decodedFields.decodedObject);\n      }\n\n      return {\n        fieldValue: fieldValue,\n        newPosition: newPosition\n      };\n    }\n\n    function decodeFields(data) {\n      var input = data.input;\n      var fields = data.fields;\n      var startPosition = data.startPosition || 0;\n      var position = startPosition;\n      var decodedObject = fields.reduce(function (acc, field) {\n        var name = field.name;\n        var numBits = field.numBits;\n        var decodedField = decodeField({\n          input: input,\n          output: acc,\n          startPosition: position,\n          field: field\n        });\n        var fieldValue = decodedField.fieldValue;\n        var newPosition = decodedField.newPosition;\n\n        if (fieldValue !== undefined) {\n          acc[name] = fieldValue;\n        }\n\n        if (newPosition !== undefined) {\n          position = newPosition;\n        } else if (typeof numBits === 'number') {\n          position += numBits;\n        }\n\n        return acc;\n      }, {});\n      return {\n        decodedObject: decodedObject,\n        newPosition: position\n      };\n    }\n\n    function decodeConsentStringBitValue(bitString, definitionMap) {\n      definitionMap = definitionMap || vendorVersionMap;\n      var version = decodeBitsToInt(bitString, 0, versionNumBits);\n\n      if (typeof version !== 'number') {\n        throw new Error('ConsentString - Unknown version number in the string to decode');\n      } else if (!vendorVersionMap[version]) {\n        throw new Error('ConsentString - Unsupported version ' + version + ' in the string to decode');\n      }\n\n      var fields = definitionMap[version].fields;\n      var decodedFields = decodeFields({\n        input: bitString,\n        fields: fields\n      });\n      var decodedObject = decodedFields.decodedObject;\n      return decodedObject;\n    }\n\n    function decodeFromBase64(consentString, definitionMap) {\n      // Add padding\n      var unsafe = consentString;\n\n      while (unsafe.length % 4 !== 0) {\n        unsafe += '=';\n      } // Replace safe characters\n\n\n      unsafe = unsafe.replace(/-/g, '+').replace(/_/g, '/');\n      var bytes = base64.decode(unsafe);\n      var inputBits = '';\n\n      for (var i = 0; i < bytes.length; i += 1) {\n        var bitString = bytes.charCodeAt(i).toString(2);\n        inputBits += padLeft(bitString, 8 - bitString.length);\n      }\n\n      return decodeConsentStringBitValue(inputBits, definitionMap);\n    }\n\n    var location = null;\n    var consentStatus = false;\n    var consentChecked = false;\n    var gdprApplies = false;\n    var EU_EEA_COUNTRY_CODES = [// EU\n    'AT', // Austria\n    'BE', // Belgium\n    'BG', // Bulgaria\n    'HR', // Croatia\n    'CY', // Republic of Cypress\n    'CZ', // Czech Republic\n    'DK', // Denmark\n    'EE', // Estonia\n    'FI', // Finland\n    'FR', // France\n    'DE', // Germany\n    'GR', // Greece\n    'HU', // Hungary\n    'IE', // Ireland\n    'IT', // Italy\n    'LV', // Latvia\n    'LT', // Lithuania\n    'LU', // Luxembourg\n    'MT', // Malta\n    'NL', // Netherlands\n    'PL', // Poland\n    'PT', // Portugal\n    'RO', // Romania\n    'SK', // Slovakia\n    'SI', // Slovenia\n    'ES', // Spain\n    'SE', // Sweden\n    'GB', // United Kingdom\n    'UK', // United Kingdom Alias\n    //EEA\n    'IS', // Iceland\n    'LI', // Liechtenstein\n    'NO' // Norway\n    ]; // var getConsentObject = function _getConsentObject() {\n    //   if (hasCookie('eupubconsent') ){\n    //     logger.log('Getting Consent Object...');\n    //     var consentString = readCookie('eupubconsent');\n    //     var consentObject = decodeFromBase64(consentString)\n    //     return consentObject\n    //   }else{\n    //     logger.error('No Consent String Cookie.');\n    //     consentStatus = false;\n    //     return {purposeIdBitString: '000000000000000000000000'}\n    //   }\n    // }\n\n    var getConsentString = function _getConsentString() {\n      if (hasCookie('eupubconsent')) {\n        logger.log('Getting Consent Object...');\n        return readCookie('eupubconsent');\n      } else {\n        var consentString = '';\n\n        if (window.__cmp && typeof window.__cmp === 'function') {\n          window.__cmp('getVendorConsents', null, function (result) {\n            consentString = result.metadata;\n          });\n        }\n\n        return consentString;\n      }\n    }; // var getConsentPurposes = function _getConsentPurposes() {\n    //   logger.log('Getting Consent Purposes...');\n    //   var consentObject = getConsentObject();\n    //   var consentPurposeBits = Array.apply(null, {length: 24}).map(Function.call, function(){ return \"0\" });\n    //   if (consentObject && consentObject.purposeIdBitString){\n    //     consentPurposeBits = consentObject.purposeIdBitString.split('');\n    //   }\n    //   var consentPurposes = consentPurposeBits.map(function(bit){\n    //     if (parseInt(bit, 10) > 0) return true;\n    //     return false;\n    //   });\n    //   return consentPurposes;\n    // };\n\n\n    var getConsent = function _getConsent() {\n      if (consentChecked) return consentStatus;\n\n      if (window.CNN && window.CNN.UserConsent) {\n        logger.log('Getting Consent from UserConsent object...');\n        consentStatus = window.CNN.UserConsent.isEnabled() ? window.CNN.UserConsent.getUserConsentAdvertisingState() : true;\n        logger.log(\"Consent Granted: \", consentStatus);\n        consentChecked = true;\n        return consentStatus;\n      } else {\n        if (window.OptanonActiveGroups) {\n          logger.log('Inspecting Optanon Active Groups...');\n          var activeGroupArray = window.OptanonActiveGroups.split(',');\n          consentStatus = activeGroupArray.indexOf('4') >= 0;\n          logger.log('Consent Granted: ', consentStatus);\n          consentChecked = true;\n        } else {\n          if (window.__cmp && typeof window.__cmp === 'function') {\n            logger.log('Getting Consent from CMP API...');\n\n            window.__cmp('getVendorConsents', null, function (consentData) {\n              Object.keys(consentData.purposeConsents).forEach(function (index) {\n                if (!consentStatus) consentStatus = consentData.purposeConsents[index];\n              });\n              return consentStatus;\n            });\n\n            logger.log(\"Consent Granted: \", consentStatus);\n            consentChecked = true;\n            return consentStatus;\n          } else {\n            logger.warn(\"No CMP API... GDPR consent is implied to be false.\");\n            logger.log(\"Consent Granted: \", false);\n            consentChecked = true;\n            return false;\n          }\n        }\n      }\n    };\n\n    var getGDPRApplies = function _getGDPRApplies(appId) {\n      return new Promise(function (resolve) {\n        var countryCode;\n\n        if (hasCookie('countryCode')) {\n          countryCode = readCookie('countryCode');\n          logger.log(\"GDPR Applies: \", EU_EEA_COUNTRY_CODES.indexOf(countryCode) >= 0);\n          gdprApplies = EU_EEA_COUNTRY_CODES.indexOf(countryCode) >= 0;\n          resolve(EU_EEA_COUNTRY_CODES.indexOf(countryCode) >= 0);\n        } else {\n          if (location === null) {\n            var locationServiceURL = 'https://geo.ngtv.io/locate';\n\n            if (appId) {\n              locationServiceURL += '?appId=' + appId;\n            }\n\n            fetch(locationServiceURL).then(function (resp) {\n              return resp.json();\n            }).then(function (loc) {\n              location = loc;\n              logger.log(\"GDPR Applies: \", EU_EEA_COUNTRY_CODES.indexOf(loc.country) >= 0);\n              gdprApplies = loc.country && EU_EEA_COUNTRY_CODES.indexOf(loc.country) >= 0;\n              countryCode = loc.country;\n              resolve(loc.country && EU_EEA_COUNTRY_CODES.indexOf(loc.country) >= 0);\n            }).catch(function (err) {\n              logger.err(\"Could Not Get User Location: \", err);\n              gdprApplies = false;\n              resolve(false);\n            });\n          } else {\n            logger.log(\"GDPR Applies: \", EU_EEA_COUNTRY_CODES.indexOf(location.country) >= 0);\n            gdprApplies = location.country && EU_EEA_COUNTRY_CODES.indexOf(location.country) >= 0;\n            resolve(location.country && EU_EEA_COUNTRY_CODES.indexOf(location.country) >= 0);\n          }\n        }\n      });\n    };\n\n    var monetizedSlots = {};\n\n    var isMonetized = function _isMonetized(slot) {\n      var rktrSlotId = slot.rktr_slot_id;\n      logger.group('Checking Monetization for: ' + rktrSlotId);\n      var rktrAdId = slot.rktr_ad_id;\n      var responsive = slot.responsive;\n      var sizes = slot.sizes;\n\n      if (typeof monetizedSlots[rktrSlotId] !== 'undefined') {\n        logger.log('Slot already monetized.', monetizedSlots[rktrSlotId]);\n        logger.groupEnd('Checking Monetization for: ' + rktrSlotId);\n        return monetizedSlots[rktrSlotId];\n      }\n\n      var slotId = rktrSlotId;\n\n      if (slotId === 'page') {\n        logger.log('Skipping Page-Level Object.');\n        logger.groupEnd('Checking Monetization for: ' + rktrSlotId);\n        monetizedSlots[slotId] = {\n          isMonetized: false,\n          filteredSizes: []\n        };\n        return {\n          isMonetized: false,\n          filteredSizes: []\n        };\n      }\n\n      var monetized = true;\n      var viewportChecked = false;\n      var browser = getViewport();\n      var responsiveSizes = [];\n      var filteredSizes = [];\n      invalidMappings.forEach(function forEachMap(invalidMapping) {\n        if (slotId.indexOf(invalidMapping) > 0) {\n          logger.log('Slot includes invalid mapping: ', invalidMapping);\n          monetizedSlots[slotId] = false;\n          monetized = false;\n        }\n      });\n      invalidAdUnitSegments.forEach(function forEachSegment(invalidAdUnitSegment) {\n        if (rktrAdId && rktrAdId.indexOf(invalidAdUnitSegment) >= 0) {\n          logger.log('Slot contains an invalid Ad Unit segment: ', invalidAdUnitSegment);\n          monetized = false;\n        }\n      });\n      invalidAdUnits.forEach(function forEachAdUnit(invalidAdUnit) {\n        if (rktrAdId === invalidAdUnit) {\n          logger.log('Slot uses an invalid Ad Unit: ', invalidAdUnit);\n          monetized = false;\n        }\n      });\n\n      if (responsive && responsive.length > 0) {\n        responsive.map(function (viewport) {\n          if (!viewportChecked && parseInt(viewport[0][0], 10) < browser[0] && parseInt(viewport[0][1], 10) < browser[1]) {\n            viewportChecked = true;\n            logger.log('Checking Responsive Sizes: ', viewport, browser);\n            responsiveSizes = viewport[1];\n\n            if (viewport[1][0] === 'suppress' || responsiveSizes === 'suppress') {\n              logger.log('Slot is suppressed: ', viewport[1][0], responsiveSizes);\n              monetized = false;\n            }\n          }\n\n          return viewport;\n        });\n      }\n\n      filteredSizes = monetized && responsiveSizes.length > 0 ? responsiveSizes : sizes;\n\n      if (monetized) {\n        filteredSizes = filteredSizes.filter(function sizeFilter(size) {\n          var retSize = size;\n\n          if (retSize !== 'suppress') {\n            retSize = retSize.join('x');\n          }\n\n          return monetizedSizes.indexOf(retSize) !== -1;\n        });\n      }\n\n      if (filteredSizes.length === 0) {\n        logger.log('Slot contains no monetized sizes.', filteredSizes);\n        monetizedSlots[slotId] = false;\n        monetized = false;\n      }\n\n      logger.log('Slot is Monetized: ', monetized);\n      logger.groupEnd('Checking Monetization for: ' + rktrSlotId);\n      monetizedSlots[slotId] = {\n        isMonetized: monetized,\n        filteredSizes: filteredSizes\n      };\n      return {\n        isMonetized: monetized,\n        filteredSizes: filteredSizes\n      };\n    };\n\n    var hasOwn = function _hasOwn(object, key) {\n      return object !== null && Object.prototype.hasOwnProperty.call(object, key);\n    };\n\n    var once = function _once(fn) {\n      return function () {\n        if (fn) {\n          fn.apply(this, arguments); // eslint-disable-next-line\n\n          fn = null;\n        }\n      };\n    };\n\n    var keyMap = function _keyMap() {\n      var map = {};\n\n      var has = function has(id) {\n        return id in map;\n      };\n\n      var addKey = function addKey(id, key) {\n        if (!has(id)) {\n          map[id] = [];\n        }\n\n        map[id].push(key);\n      };\n\n      var getKeys = function getKeys(id) {\n        return has(id) ? Array.prototype.slice.call(map[id]) : [];\n      };\n\n      var clearKeys = function clearKeys(id) {\n        if (has(id)) {\n          map[id].length = 0;\n          return true;\n        }\n\n        return false;\n      };\n\n      return {\n        has: has,\n        clearKeys: clearKeys,\n        getKeys: getKeys,\n        addKey: addKey\n      };\n    }();\n\n    var roundFloat = function _roundFloat(value, toNearest, fixed) {\n      return (Math.ceil(value / toNearest) * toNearest).toFixed(fixed);\n    };\n\n    var generateCacheBuster = function _generateCacheBuster() {\n      // return_<9-digit-random-hex>\n      var cb = '';\n\n      for (var i = 0; i < 10; i++) {\n        cb += Math.floor(Math.random() * 9).toString();\n      }\n\n      return cb;\n    };\n\n    var debounce = function _debounce(func, wait, immediate) {\n      var timeout;\n      return function () {\n        var context = this;\n        var args = arguments;\n\n        var later = function later() {\n          timeout = null;\n          if (!immediate) func.apply(context, args);\n        };\n\n        var callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n        if (callNow) func.apply(context, args);\n      };\n    };\n\n    var clone = function _clone(obj) {\n      // Handle the 3 simple types, and null or undefined\n      if (obj === null || _typeof(obj) !== 'object') return obj; // Handle Date\n\n      if (obj instanceof Date) {\n        var copyDate = new Date();\n        copyDate.setTime(obj.getTime());\n        return copyDate;\n      } // Handle Array\n\n\n      if (obj instanceof Array) {\n        var copyArray = [];\n\n        for (var i = 0, len = obj.length; i < len; i++) {\n          copyArray[i] = clone(obj[i]);\n        }\n\n        return copyArray;\n      } // Handle Object\n\n\n      if (obj instanceof Object) {\n        var copyObject = {};\n\n        for (var attr in obj) {\n          if (obj.hasOwnProperty(attr)) {\n            copyObject[attr] = clone(obj[attr]);\n          }\n        }\n\n        return copyObject;\n      }\n\n      throw new Error('Unable to copy obj! Its type isn\\'t supported.');\n    };\n\n    logger.log('Hostname: ', hostname);\n    logger.log('CountryCode: ', countryCode);\n\n    if (getURLParam('isIntl') === 'true') {\n      logger.log('Faking international site. Using International PubIds.');\n      isIntl = true;\n    } else if (hostname.search(/^.*(edition|edition\\-m|arabic)\\./) >= 0) {\n      logger.log('Full international site. Using International PubIds.');\n      isIntl = true;\n    } else if (countryCode === '' || countryCode === null) {\n      if (hostname.search(/^.*(cnnespanol|cnne\\-test)\\./) >= 0) {\n        logger.log('No country code. Using International PubIds.');\n        isIntl = true;\n      } else {\n        logger.log('No country code. Domestic Site.');\n      }\n    } else if (countryCode !== 'US' && countryCode !== 'CA') {\n      if (hostname.search(/^.*(money|cnnespanol|cnne\\-test|\\.cnn)\\./) >= 0) {\n        logger.log('International country code. Using International PubIds.');\n        isIntl = true;\n      } else {\n        logger.log('International country code but domestic site.');\n      }\n    } else {\n      logger.log('Domestic site or country code.');\n    }\n\n    var merge = function merge(source, mods) {\n      var dest = {};\n      var attrname;\n\n      for (attrname in source) {\n        if (source.hasOwnProperty(attrname)) {\n          dest[attrname] = source[attrname];\n        }\n      }\n\n      for (attrname in mods) {\n        if (mods.hasOwnProperty(attrname)) {\n          dest[attrname] = mods[attrname];\n        }\n      }\n\n      return dest;\n    };\n\n    var addMark = function _addMark(name) {\n      window.performance.mark('[ADFUEL] ' + name);\n    };\n\n    var addMeasure = function _addMeasure(name, start, end) {\n      window.performance.measure('[ADFUEL] ' + name, '[ADFUEL] ' + start, '[ADFUEL] ' + end);\n    };\n\n    var getMarks = function _getMarks() {\n      return window.performance.getEntriesByType('mark').filter(function (mark) {\n        return mark.name.indexOf('[ADFUEL]');\n      });\n    };\n\n    var getMeasures = function _getMeasures() {\n      return window.performance.getEntriesByType('measure').filter(function (mark) {\n        return mark.name.indexOf('[ADFUEL]');\n      });\n    };\n\n    var metrics = {};\n\n    var getMetricTypes = function _getMetricTypes() {\n      return Object.getOwnPropertyNames(metrics);\n    };\n\n    var getMetricsByType = function getMetricsByType(type) {\n      return metrics[type] || {};\n    };\n\n    var getMetricById = function getMetricById(type, id) {\n      if (type === 'counts' && !metrics[type][id]) {\n        return 0;\n      } else if (type === 'timeline' && id === 'request_to_dfp') {\n        if (!metrics[type][id]) {\n          return [];\n        }\n      }\n\n      return metrics[type][id] || {};\n    };\n\n    var addMetric = function addMetric(metricObject) {\n      /*\n              Sample Metric Object\n              {\n              type: timeline|counts|configuration|requests|page|registries|modules|slots\n              id: <STRING>\n              data: <ANY> For type=counts this should be '+' or '-' to increment or decrement current count.\n                  For timeline metrics, data should be an object with an index property to use for updates.\n                  ie: { index: 1, options: { <some options> }, slots: [ 'ad_bnr_atf_01' ], start: <timestamp> }\n                  On update, the indexes should match:\n                  ie: { index: 1, end: <timestamp> }\n              }\n              */\n      // logger.log('Adding Metric: ', JSON.parse(JSON.stringify(metricObject)));\n      var metric;\n      var newMetric = false;\n      var data;\n\n      if (!metrics[metricObject.type]) {\n        // Metric type doesn't exist... create it.\n        metrics[metricObject.type] = {};\n      }\n\n      if (!metrics[metricObject.type][metricObject.id]) {\n        metrics[metricObject.type][metricObject.id] = [];\n        newMetric = true;\n      }\n\n      if (!newMetric) {\n        metric = getMetricById(metricObject.type, metricObject.id);\n      } else {\n        metric = [];\n      }\n\n      var currentCount = parseInt(metric, 10);\n      var metricIndex = metricObject.data.id || 1;\n\n      switch (metricObject.type) {\n        case 'counts':\n          if (metric.length === 0) {\n            metric = 0;\n          }\n\n          if (metricObject.data === '+') {\n            currentCount = currentCount + 1;\n          } else if (metricObject.data === '-') {\n            currentCount = currentCount - 1;\n          } else {\n            logger.log('Metric data contains no operator for counting metrics.', metricObject);\n            return false;\n          }\n\n          metrics[metricObject.type][metricObject.id] = currentCount; // logger.log('Metrics updated with: ', metricObject, metrics);\n\n          break;\n\n        case 'modules':\n          if (metricObject.data.callback) {\n            var module = window.AdFuel.registeredModules.filter(function filterFunc(mod) {\n              return mod.name === metricObject.id;\n            });\n\n            if (Array.isArray(module)) {\n              module = module[0];\n            }\n\n            if (metric.length === 0) {\n              metric = {};\n            }\n\n            var callbackNames = Object.getOwnPropertyNames(module.callbacks);\n            var callbackNameFromData = metricObject.data.callback + 'Callback';\n\n            if (callbackNames.indexOf(callbackNameFromData) !== -1) {\n              for (var name = 0; name < callbackNames.length; name++) {\n                if (!metric[callbackNames[name]]) {\n                  metric[callbackNames[name]] = {};\n                }\n\n                delete metricObject.data.callback;\n                metric[callbackNames[name]] = merge(metric[callbackNames[name]], metricObject.data);\n              }\n            }\n\n            metrics[metricObject.type][metricObject.id] = metric;\n          } else {\n            data = merge(metric, metricObject.data);\n            metrics[metricObject.type][metricObject.id] = data; // logger.log('Metrics updated with: ', metricObject, metrics);\n          }\n\n          break;\n\n        case 'requests':\n        case 'timeline':\n          data = {};\n\n          if (metric.length > 0) {\n            data = metric[metricIndex - 1];\n          }\n\n          data = merge(data, metricObject.data);\n          metrics[metricObject.type][metricObject.id][metricIndex - 1] = data; // logger.log('Metrics updated with: ', metricObject, metrics);\n\n          break;\n\n        case 'slots':\n        default:\n          data = merge(metric, metricObject.data);\n          metrics[metricObject.type][metricObject.id] = data; // logger.log('Metrics updated with: ', metricObject, metrics);\n\n          break;\n      }\n\n      return true;\n    }; // return this API object to modules when they register.\n\n\n    var metricApi = {\n      metrics: metrics,\n      getMetricTypes: getMetricTypes,\n      getMetricsByType: getMetricsByType,\n      getMetricById: getMetricById,\n      addMetric: addMetric\n    };\n    /**\n       * isMobile.js v0.4.1\n       *\n       * A simple library to detect Apple phones and tablets,\n       * Android phones and tablets, other mobile devices (like blackberry, mini-opera and windows phone),\n       * and any kind of seven inch device, via user agent sniffing.\n       *\n       * @author: Kai Mallea (kmallea@gmail.com)\n       *\n       * @license: http://creativecommons.org/publicdomain/zero/1.0/\n       */\n\n    var applePhone = /iPhone/i; // Case-insensitive matching\n\n    var appleIpod = /iPod/i;\n    var appleTablet = /iPad/i; // Match 'Android' AND 'Mobile'\n\n    var androidPhone = /(?=.*\\bAndroid\\b)(?=.*\\bMobile\\b)/i;\n    var androidTablet = /Android/i;\n    var amazonPhone = /(?=.*\\bAndroid\\b)(?=.*\\bSD4930UR\\b)/i;\n    var amazonTablet = /(?=.*\\bAndroid\\b)(?=.*\\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\\b)/i;\n    var windowsPhone = /Windows Phone/i; // Match 'Windows' AND 'ARM'\n\n    var windowsTablet = /(?=.*\\bWindows\\b)(?=.*\\bARM\\b)/i;\n    var otherBlackberry = /BlackBerry/i;\n    var otherBlackberry10 = /BB10/i;\n    var otherOpera = /Opera Mini/i;\n    var otherChrome = /(CriOS|Chrome)(?=.*\\bMobile\\b)/i; // Match 'Firefox' AND 'Mobile'\n\n    var otherFirefox = /(?=.*\\bFirefox\\b)(?=.*\\bMobile\\b)/i;\n    var sevenInch = new RegExp('(?:' + // Non-capturing group\n    'Nexus 7' + // Nexus 7\n    '|' + // OR\n    'BNTV250' + // B&N Nook Tablet 7 inch\n    '|' + // OR\n    'Kindle Fire' + // Kindle Fire\n    '|' + // OR\n    'Silk' + // Kindle Fire, Silk Accelerated\n    '|' + // OR\n    'GT-P1000' + // Galaxy Tab 7 inch\n    ')', // End non-capturing group\n    'i');\n\n    var match = function match(regex, userAgent) {\n      return regex.test(userAgent);\n    };\n\n    var IsMobileClass = function IsMobileClass(userAgent) {\n      var ua = userAgent || navigator.userAgent; // Facebook mobile app's integrated browser adds a bunch of strings that\n      // match everything. Strip it out if it exists.\n\n      var tmp = ua.split('[FBAN');\n\n      if (typeof tmp[1] !== 'undefined') {\n        ua = tmp[0];\n      } // Twitter mobile app's integrated browser on iPad adds a \"Twitter for\n      // iPhone\" string. Same probable happens on other tablet platforms.\n      // This will confuse detection so strip it out if it exists.\n\n\n      tmp = ua.split('Twitter');\n\n      if (typeof tmp[1] !== 'undefined') {\n        ua = tmp[0];\n      }\n\n      this.apple = {\n        phone: match(applePhone, ua),\n        ipod: match(appleIpod, ua),\n        tablet: !match(applePhone, ua) && match(appleTablet, ua),\n        device: match(applePhone, ua) || match(appleIpod, ua) || match(appleTablet, ua)\n      };\n      this.amazon = {\n        phone: match(amazonPhone, ua),\n        tablet: !match(amazonPhone, ua) && match(amazonTablet, ua),\n        device: match(amazonPhone, ua) || match(amazonTablet, ua)\n      };\n      this.android = {\n        phone: match(amazonPhone, ua) || match(androidPhone, ua),\n        tablet: !match(amazonPhone, ua) && !match(androidPhone, ua) && (match(amazonTablet, ua) || match(androidTablet, ua)),\n        device: match(amazonPhone, ua) || match(amazonTablet, ua) || match(androidPhone, ua) || match(androidTablet, ua)\n      };\n      this.windows = {\n        phone: match(windowsPhone, ua),\n        tablet: match(windowsTablet, ua),\n        device: match(windowsPhone, ua) || match(windowsTablet, ua)\n      };\n      this.other = {\n        blackberry: match(otherBlackberry, ua),\n        blackberry10: match(otherBlackberry10, ua),\n        opera: match(otherOpera, ua),\n        firefox: match(otherFirefox, ua),\n        chrome: match(otherChrome, ua),\n        device: match(otherBlackberry, ua) || match(otherBlackberry10, ua) || match(otherOpera, ua) || match(otherFirefox, ua) || match(otherChrome, ua)\n      };\n      this.seven_inch = match(sevenInch, ua);\n      this.any = this.apple.device || this.android.device || this.windows.device || this.other.device || this.seven_inch; // excludes 'other' devices and ipods, targeting touchscreen phones\n\n      this.phone = this.apple.phone || this.android.phone || this.windows.phone; // excludes 7 inch devices, classifying as phone or tablet is left to the user\n\n      this.tablet = this.apple.tablet || this.android.tablet || this.windows.tablet;\n\n      if (typeof window === 'undefined') {\n        return this;\n      }\n    };\n\n    var instantiate = function instantiate() {\n      var IM = new IsMobileClass();\n      IM.Class = IsMobileClass;\n      return IM;\n    };\n\n    var isMobile = instantiate();\n    addEvent(document, 'AdFuelCreated', filterDFPRequest);\n    var AdFuelUtils = {\n      addEvent: addEvent,\n      bind: bind,\n      cdnRoot: cdnRoot,\n      clone: clone,\n      countryCode: countryCode,\n      debounce: debounce,\n      decodeFromBase64: decodeFromBase64,\n      gdprApplies: gdprApplies,\n      getConsent: getConsent,\n      getConsentString: getConsentString,\n      getGDPRApplies: getGDPRApplies,\n      getLocation: getLocation,\n      generateCacheBuster: generateCacheBuster,\n      getBrowser: getBrowser,\n      getLogger: getLogger,\n      getURLParam: getURLParam,\n      getViewport: getViewport,\n      hasCookie: hasCookie,\n      hasOwn: hasOwn,\n      isFunction: isFunction,\n      isIntl: isIntl,\n      isMobile: isMobile,\n      isMonetized: isMonetized,\n      isObject: isObject,\n      keyMap: keyMap,\n      merge: merge,\n      mergeDeep: mergeDeep,\n      metricApi: metricApi,\n      noop: noop,\n      once: once,\n      performance: {\n        mark: addMark,\n        measure: addMeasure,\n        marks: getMarks,\n        measures: getMeasures\n      },\n      piiFilter: piiFilter,\n      readCookie: readCookie,\n      roundFloat: roundFloat,\n      selectedEdition: selectedEdition,\n      __VERSION__: MODULE_VERSION\n    };\n    window.AdFuelUtils = AdFuelUtils;\n  })(); //TODO Add arguments to this for Rocketeer support.\n  //TODO Use Rocketeer to build this file based on modules included and scrap site-specific files.\n\n\n  window.AdFuelOptions = {\n    OPTIONS_VERSION: 1.2,\n    ADFUEL: {\n      AUTO_DISPATCH: true,\n      //{{ADFUEL_AUTO_DISPATCH}}\n      DEFAULT_TIMEOUT: 800,\n      //{{ADFUEL_DEFAULT_TIMEOUT}}\n      DEFAULT_DESKTOP_TIMEOUT: 1000,\n      //{{ADFUEL_DEFAULT_DESKTOP_TIMEOUT}}\n      DEFAULT_MOBILE_TIMEOUT: 800,\n      //{{ADFUEL_DEFAULT_MOBILE_TIMEOUT}}\n      IFRAME_TITLE: 'advertisement',\n      //{{ADFUEL_IFRAME_TITLE}}\n      NETWORK_ID: '8663477',\n      //{{ADFUEL_NETWORK_ID}}\n      REFRESH_ON_FOCUS_ONLY: false,\n      //{{ADFUEL_REFRESH_ON_FOCUS_ONLY}}\n      LAZY_LOAD_FETCH_PERCENT: 500,\n      //{{ADFUEL_LAZY_LOAD_FETCH_PERCENT}}  Fetch Slots within 5 Viewports\n      LAZY_LOAD_RENDER_PERCENT: 200,\n      //{{ADFUEL_LAZY_LOAD_RENDER_PERCENT}} Render Slots within 2 Viewports\n      LAZY_LOAD_MOBILE_SCALING: 2.0 //{{ADFUEL_LAZY_LOAD_MOBILE_SCALING}} Scale the above values for mobile by 2\n\n    },\n    A9: {\n      DOM_PUB_ID: '3159',\n      //{{A9_DOM_PUB_ID}}\n      INTL_PUB_ID: '3288',\n      //{{A9_INTL_PUB_ID}}\n      DISPLAY_TIMEOUT: 750,\n      //{{A9_DISPLAY_TIMEOUT}}\n      DISPLAY_REFRESH_TIMEOUT: 750,\n      //{{A9_DISPLAY_REFRESH_TIMEOUT}}\n      VIDEO_TIMEOUT: 500,\n      //{{A9_VIDEO_TIMEOUT}}\n      VIDEO_REFRESH_TIMEOUT: 750,\n      //{{A9_VIDEO_REFRESH_TIMEOUT}}\n      DESKTOP_DISPLAY_TIMEOUT: 750,\n      //{{A9_DESKTOP_DISPLAY_TIMEOUT}}\n      DESKTOP_DISPLAY_REFRESH_TIMEOUT: 750,\n      //{{A9_DESKTOP_DISPLAY_REFRESH_TIMEOUT}}\n      DESKTOP_VIDEO_TIMEOUT: 500,\n      //{{A9_DESKTOP_VIDEO_TIMEOUT}}\n      DESKTOP_VIDEO_REFRESH_TIMEOUT: 750,\n      //{{A9_DESKTOP_VIDEO_REFRESH_TIMEOUT}}\n      MOBILE_DISPLAY_TIMEOUT: 750,\n      //{{A9_MOBILE_DISPLAY_TIMEOUT}}\n      MOBILE_DISPLAY_REFRESH_TIMEOUT: 750,\n      //{{A9_MOBILE_DISPLAY_REFRESH_TIMEOUT}}\n      MOBILE_VIDEO_TIMEOUT: 500,\n      //{{A9_MOBILE_VIDEO_TIMEOUT}}\n      MOBILE_VIDEO_REFRESH_TIMEOUT: 750 //{{A9_MOBILE_VIDEO_REFRESH_TIMEOUT}}\n\n    },\n    BEEMRAY: {\n      CUSTOMER_ID: '',\n      //{{BEEMRAY_CUSTOMER_ID}}\n      API_KEY: '' //{{BEEMRAY_API_KEY}}\n\n    },\n    CEP: {},\n    CONSOLE_TOOL: {\n      HOTKEY: ['Control', 'Shift', 'Z'] //{{CONSOLE_TOOL_HOTKEY}}\n\n    },\n    CREATIVE_REVIEW: {\n      HOTKEY: '^ d o h $' //{{CREATIVE_REVIEW_HOTKEY}}\n\n    },\n    CRITEO: {\n      MULTISIZE_FIRST: 'F',\n      MULTISIZE_LARGEST: 'L',\n      MULTISIZE_ALL: 'A',\n      MULTISIZE_METHOD: 'L',\n      //{{CRITEO_MULTISIZE_METHOD}}\n      DESKTOP_ZONES: {},\n      //{{CRITEO_DESKTOP_ZONES}}\n      MOBILE_ZONES: {},\n      //{{CRITEO_MOBILE_ZONES}}\n      TIMEOUT: 750,\n      //{{CRITEO_TIMEOUT}}\n      DESKTOP_TIMEOUT: 750,\n      //{{CRITEO_DESKTOP_TIMEOUT}}\n      MOBILE_TIMEOUT: 750 //{{CRITEO_MOBILE_TIMEOUT}}\n\n    },\n    FASTLANE: {\n      DOM_ACCOUNT_ID: 11078,\n      //{{FASTLANE_DOM_ACCOUNT_ID}}\n      INTL_ACCOUNT_ID: 11016,\n      //{{FASTLANE_INTL_ACCOUNT_ID}}\n      TIMEOUT: 750,\n      //{{FASTLANE_TIMEOUT}}\n      DESKTOP_TIMEOUT: 750,\n      //{{FASTLANE_DESKTOP_TIMEOUT}}\n      MOBILE_TIMEOUT: 750 //{{FASTLANE_MOBILE_TIMEOUT}}\n\n    },\n    GUID: {},\n    IAS: {\n      DOM_PUB_ID: 925660,\n      //{{IAS_DOM_PUB_ID}}\n      INTL_PUB_ID: 925660 //{{IAS_INTL_PUB_ID}}\n\n    },\n    IX: {\n      SCRIPT_KEY: null,\n      //{{IX_SCRIPT_KEY}}\n      SCRIPT_MAP: {}\n    },\n    IVR: {\n      DEFAULT_DISPLAY_MILLISECONDS: 35 * 1000,\n      //{{IVR_DISPLAY_MILLISECONDS}}\n      DEFAULT_DISPLAY_PERCENT: 50 //{{IVR_DISPLAY_PERCENT}}}\n\n    },\n    KRUX: {\n      DOM_CONTROLTAG: '',\n      //{{KRUX_DOM_CONTROLTAG}}\n      INTL_CONTROLTAG: '' //{{KRUX_INTL_CONTROLTAG}}\n\n    },\n    PREBID: {\n      DOM_BIDDERS: ['rubicon', 'appnexus'],\n      //{{PREBID_DOM_BIDDERS}}\n      INTL_BIDDERS: ['appnexus', 'pangaea', 'rubicon'],\n      //{{PREBID_INTL_BIDDERS}}\n      NATIVE_BIDDERS: [],\n      //{{PREBID_NATIVE_BIDDERS}}\n      DOM_ACCOUNT_IDS: {\n        rubicon: '11078',\n        //{{PREBID_RUBICON_DOM_ACCOUNT_ID}}\n        appnexus: '7745' //{{PREBID_APPNEXUS_DOM_ACCOUNT_ID}}\n\n      },\n      INTL_ACCOUNT_IDS: {\n        rubicon: '11016',\n        //{{PREBID_RUBICON_INTL_ACCOUNT_ID}}\n        appnexus: '8353',\n        //{{PREBID_APPNEXUS_INTL_ACCOUNT_ID}}\n        pangaea: '8613' //{{PREBID_PANGAEA_INTL_ACCOUNT_ID}}\n\n      },\n      RUBICON_DOM_DESKTOP_SITE_ID: 0,\n      //{{PREBID_RUBICON_DESKTOP_SITE_ID}}\n      RUBICON_INTL_DESKTOP_SITE_ID: 0,\n      //{{PREBID_RUBICON_DESKTOP_SITE_ID}}\n      RUBICON_DOM_MOBILE_SITE_ID: 0,\n      //{{PREBID_RUBICON_MOBILE_SITE_ID}}\n      RUBICON_INTL_MOBILE_SITE_ID: 0,\n      //{{PREBID_RUBICON_MOBILE_SITE_ID}}\n      RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING: {//{{PREBID_RUBICON_DOM_DESKTOP_HP_ZONE_MAP}}\n      },\n      RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING: {//{{PREBID_RUBICON_DOM_DESKTOP_ROS_ZONE_MAP}}\n      },\n      RUBICON_DOM_MOBILE_ZONE_MAPPING: {//{{PREBID_RUBICON_DOM_MOBILE_ZONE_MAP}}\n      },\n      RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING: {//{{PREBID_RUBICON_INTL_DESKTOP_HP_ZONE_MAP}}\n      },\n      RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING: {//{{PREBID_RUBICON_INTL_DESKTOP_ROS_ZONE_MAP}}\n      },\n      RUBICON_INTL_MOBILE_ZONE_MAPPING: {//{{PREBID_RUBICON_INTL_MOBILE_ZONE_MAP}}\n      },\n      TIMEOUT: 750,\n      //{{PREBID_TIMEOUT}}\n      DESKTOP_TIMEOUT: 950,\n      //{{PREBID_DESKTOP_TIMEOUT}}\n      MOBILE_TIMEOUT: 750 //{{PREBID_MOBILE_TIMEOUT}}\n\n    },\n    PROXIMIC: {},\n    SOURCEPOINT: {},\n    TRANSACTION_ID: {}\n  };\n  /* Setup vertical-specific ads options */\n\n  switch (CNN.SiteLocation.vertical) {\n    case 'business':\n      if (CNN.SiteLocation.site === 'edition') {\n        window.CNN_OPTIONS = {\n          OPTIONS_VERSION: 1.2,\n          ADFUEL: {\n            DEFAULT_DESKTOP_TIMEOUT: 1200,\n            //{{ADFUEL_DEFAULT_DESKTOP_TIMEOUT}}\n            DEFAULT_MOBILE_TIMEOUT: 800,\n            //{{ADFUEL_DEFAULT_MOBILE_TIMEOUT}}\n            SITE_OBJECT: 'CNN' //{{ADFUEL_SITE_OBJECT}}\n\n          },\n          A9: {\n            DISPLAY_TIMEOUT: 1150,\n            //{{A9_DISPLAY_TIMEOUT}}\n            DISPLAY_REFRESH_TIMEOUT: 1150,\n            //{{A9_DISPLAY_REFRESH_TIMEOUT}}\n            VIDEO_TIMEOUT: 500,\n            //{{A9_VIDEO_TIMEOUT}}\n            VIDEO_REFRESH_TIMEOUT: 1150,\n            //{{A9_VIDEO_REFRESH_TIMEOUT}}\n            DESKTOP_DISPLAY_TIMEOUT: 1150,\n            //{{A9_DESKTOP_DISPLAY_TIMEOUT}}\n            DESKTOP_DISPLAY_REFRESH_TIMEOUT: 1150,\n            //{{A9_DESKTOP_DISPLAY_REFRESH_TIMEOUT}}\n            DESKTOP_VIDEO_TIMEOUT: 500,\n            //{{A9_DESKTOP_VIDEO_TIMEOUT}}\n            DESKTOP_VIDEO_REFRESH_TIMEOUT: 1150,\n            //{{A9_DESKTOP_VIDEO_REFRESH_TIMEOUT}}\n            MOBILE_DISPLAY_TIMEOUT: 750,\n            //{{A9_MOBILE_DISPLAY_TIMEOUT}}\n            MOBILE_DISPLAY_REFRESH_TIMEOUT: 750,\n            //{{A9_MOBILE_DISPLAY_REFRESH_TIMEOUT}}\n            MOBILE_VIDEO_TIMEOUT: 500,\n            //{{A9_MOBILE_VIDEO_TIMEOUT}}\n            MOBILE_VIDEO_REFRESH_TIMEOUT: 750 //{{A9_MOBILE_VIDEO_REFRESH_TIMEOUT}}\n\n          },\n          BEEMRAY: {\n            CUSTOMER_ID: 'cnn',\n            API_KEY: '39a34d8d-dd1d-4fbf-aa96-fdc5f0329451'\n          },\n          CRITEO: {\n            DESKTOP_ZONES: {\n              '728x90': 1302537,\n              '970x90': 1302538,\n              '970x250': 1302534,\n              '300x250': 1302539,\n              '300x600': 1302535\n            },\n            MOBILE_ZONES: {\n              '300x250': 1302536\n            },\n            CRITEO_MULTISIZE_METHOD: 'L',\n            TIMEOUT: 900,\n            DESKTOP_TIMEOUT: 1150,\n            MOBILE_TIMEOUT: 750\n          },\n          GDPR: {\n            APP_ID: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uYnVzaW5lc3MiLCJhcHBJZCI6ImNubmJ1c2luZXNzLWFkZnVlbC13ZWItMmhmMHd2In0.6Z_j8q6VUqiMaMTBPdU-sbzjRYIOr-9RBLGQ2GlE1a0',\n            APPLIES: window.AdFuelUtils.getGDPRApplies('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uYnVzaW5lc3MiLCJhcHBJZCI6ImNubmJ1c2luZXNzLWFkZnVlbC13ZWItMmhmMHd2In0.6Z_j8q6VUqiMaMTBPdU-sbzjRYIOr-9RBLGQ2GlE1a0')\n          },\n          IAS: {\n            DOM_PUB_ID: 925660,\n            //{{IAS_DOM_PUB_ID}}\n            INTL_PUB_ID: 925660 //{{IAS_INTL_PUB_ID}}\n\n          },\n          IX: {\n            SCRIPT_MAP: {\n              '^((www|us|stage.next)\\\\.|(www|us|stage.next)\\\\-m\\\\.)?cnn\\\\.com': {\n                intl: '186370-111488446026291',\n                dom: '186948-131280192444057'\n              },\n              '^(edition\\\\.||edition\\\\-m\\\\.)cnn\\\\.com': {\n                intl: '186370-111488446026291',\n                dom: '186948-131280192444057'\n              }\n            }\n          },\n          KRUX: {\n            DOM_CONTROLTAG: 'tefghq6ia',\n            INTL_CONTROLTAG: 'tefghq6ia'\n          },\n          PREBID: {\n            DOM_BIDDERS: ['rubicon', 'appnexus'],\n            INTL_BIDDERS: ['appnexus', 'pangaea', 'rubicon'],\n            NATIVE_BIDDERS: ['appnexus', 'pangaea'],\n            RUBICON_DOM_DESKTOP_SITE_ID: 212778,\n            RUBICON_INTL_DESKTOP_SITE_ID: 215622,\n            RUBICON_DOM_MOBILE_SITE_ID: 212784,\n            RUBICON_INTL_MOBILE_SITE_ID: 215622,\n            RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING: {\n              'atf': 1045514,\n              'btf': 1045522\n            },\n            RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING: {\n              'atf': 1045524,\n              'btf': 1045526\n            },\n            RUBICON_DOM_MOBILE_ZONE_MAPPING: {\n              'atf': 1045538,\n              'btf': 1045538\n            },\n            RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING: {\n              'atf': 1060930,\n              'btf': 1060934\n            },\n            RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING: {\n              'atf': 1060940,\n              'btf': 1060942\n            },\n            RUBICON_INTL_MOBILE_ZONE_MAPPING: {\n              'atf': 1060936,\n              'btf': 1060938\n            },\n            TIMEOUT: 900,\n            DESKTOP_TIMEOUT: 1150,\n            //{{PREBID_DESKTOP_TIMEOUT}}\n            MOBILE_TIMEOUT: 750 //{{PREBID_MOBILE_TIMEOUT}}\n\n          }\n        };\n        window.AdFuelOptions = window.AdFuelUtils.mergeDeep(window.AdFuelOptions, window.CNN_OPTIONS);\n      } else {\n        window.CNN_OPTIONS = {\n          OPTIONS_VERSION: 1.2,\n          ADFUEL: {\n            DEFAULT_DESKTOP_TIMEOUT: 1200,\n            //{{ADFUEL_DEFAULT_DESKTOP_TIMEOUT}}\n            DEFAULT_MOBILE_TIMEOUT: 800,\n            //{{ADFUEL_DEFAULT_MOBILE_TIMEOUT}}\n            SITE_OBJECT: 'CNN' //{{ADFUEL_SITE_OBJECT}}\n\n          },\n          A9: {\n            DISPLAY_TIMEOUT: 1150,\n            //{{A9_DISPLAY_TIMEOUT}}\n            DISPLAY_REFRESH_TIMEOUT: 1150,\n            //{{A9_DISPLAY_REFRESH_TIMEOUT}}\n            VIDEO_TIMEOUT: 500,\n            //{{A9_VIDEO_TIMEOUT}}\n            VIDEO_REFRESH_TIMEOUT: 1150,\n            //{{A9_VIDEO_REFRESH_TIMEOUT}}\n            DESKTOP_DISPLAY_TIMEOUT: 1150,\n            //{{A9_DESKTOP_DISPLAY_TIMEOUT}}\n            DESKTOP_DISPLAY_REFRESH_TIMEOUT: 1150,\n            //{{A9_DESKTOP_DISPLAY_REFRESH_TIMEOUT}}\n            DESKTOP_VIDEO_TIMEOUT: 500,\n            //{{A9_DESKTOP_VIDEO_TIMEOUT}}\n            DESKTOP_VIDEO_REFRESH_TIMEOUT: 1150,\n            //{{A9_DESKTOP_VIDEO_REFRESH_TIMEOUT}}\n            MOBILE_DISPLAY_TIMEOUT: 750,\n            //{{A9_MOBILE_DISPLAY_TIMEOUT}}\n            MOBILE_DISPLAY_REFRESH_TIMEOUT: 750,\n            //{{A9_MOBILE_DISPLAY_REFRESH_TIMEOUT}}\n            MOBILE_VIDEO_TIMEOUT: 500,\n            //{{A9_MOBILE_VIDEO_TIMEOUT}}\n            MOBILE_VIDEO_REFRESH_TIMEOUT: 750 //{{A9_MOBILE_VIDEO_REFRESH_TIMEOUT}}\n\n          },\n          BEEMRAY: {\n            CUSTOMER_ID: 'cnn',\n            API_KEY: '39a34d8d-dd1d-4fbf-aa96-fdc5f0329451'\n          },\n          CRITEO: {\n            DESKTOP_ZONES: {\n              '728x90': 1302537,\n              '970x90': 1302538,\n              '970x250': 1302534,\n              '300x250': 1302539,\n              '300x600': 1302535\n            },\n            MOBILE_ZONES: {\n              '300x250': 1302536\n            },\n            CRITEO_MULTISIZE_METHOD: 'L',\n            TIMEOUT: 900,\n            DESKTOP_TIMEOUT: 1150,\n            MOBILE_TIMEOUT: 750\n          },\n          GDPR: {\n            APP_ID: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uYnVzaW5lc3MiLCJhcHBJZCI6ImNubmJ1c2luZXNzLWFkZnVlbC13ZWItMmhmMHd2In0.6Z_j8q6VUqiMaMTBPdU-sbzjRYIOr-9RBLGQ2GlE1a0',\n            APPLIES: window.AdFuelUtils.getGDPRApplies('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uYnVzaW5lc3MiLCJhcHBJZCI6ImNubmJ1c2luZXNzLWFkZnVlbC13ZWItMmhmMHd2In0.6Z_j8q6VUqiMaMTBPdU-sbzjRYIOr-9RBLGQ2GlE1a0')\n          },\n          IAS: {\n            DOM_PUB_ID: 925660,\n            //{{IAS_DOM_PUB_ID}}\n            INTL_PUB_ID: 925660 //{{IAS_INTL_PUB_ID}}\n\n          },\n          IX: {\n            SCRIPT_MAP: {\n              '^((www|us|stage.next)\\\\.|(www|us|stage.next)\\\\-m\\\\.)?cnn\\\\.com': {\n                intl: '186370-111488446026291',\n                dom: '186948-131280192444057'\n              },\n              '^(edition\\\\.||edition\\\\-m\\\\.)cnn\\\\.com': {\n                intl: '186370-111488446026291',\n                dom: '186948-131280192444057'\n              }\n            }\n          },\n          KRUX: {\n            DOM_CONTROLTAG: 'IWzCuclz',\n            INTL_CONTROLTAG: 'teff9xc7i'\n          },\n          PREBID: {\n            DOM_BIDDERS: ['rubicon', 'appnexus'],\n            INTL_BIDDERS: ['appnexus', 'pangaea', 'rubicon'],\n            NATIVE_BIDDERS: ['appnexus', 'pangaea'],\n            RUBICON_DOM_DESKTOP_SITE_ID: 212778,\n            RUBICON_INTL_DESKTOP_SITE_ID: 215622,\n            RUBICON_DOM_MOBILE_SITE_ID: 212784,\n            RUBICON_INTL_MOBILE_SITE_ID: 215622,\n            RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING: {\n              'atf': 1045514,\n              'btf': 1045522\n            },\n            RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING: {\n              'atf': 1045524,\n              'btf': 1045526\n            },\n            RUBICON_DOM_MOBILE_ZONE_MAPPING: {\n              'atf': 1045538,\n              'btf': 1045538\n            },\n            RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING: {\n              'atf': 1060930,\n              'btf': 1060934\n            },\n            RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING: {\n              'atf': 1060940,\n              'btf': 1060942\n            },\n            RUBICON_INTL_MOBILE_ZONE_MAPPING: {\n              'atf': 1060936,\n              'btf': 1060938\n            },\n            TIMEOUT: 900,\n            DESKTOP_TIMEOUT: 1150,\n            //{{PREBID_DESKTOP_TIMEOUT}}\n            MOBILE_TIMEOUT: 750 //{{PREBID_MOBILE_TIMEOUT}}\n\n          }\n        };\n        window.AdFuelOptions = window.AdFuelUtils.mergeDeep(window.AdFuelOptions, window.CNN_OPTIONS);\n      }\n\n      break;\n\n    case 'politics':\n      window.CNN_OPTIONS = {\n        OPTIONS_VERSION: 1.2,\n        ADFUEL: {\n          DEFAULT_DESKTOP_TIMEOUT: 1200,\n          //{{ADFUEL_DEFAULT_DESKTOP_TIMEOUT}}\n          DEFAULT_MOBILE_TIMEOUT: 800,\n          //{{ADFUEL_DEFAULT_MOBILE_TIMEOUT}}\n          SITE_OBJECT: 'CNN' //{{ADFUEL_SITE_OBJECT}}\n\n        },\n        A9: {\n          DISPLAY_TIMEOUT: 1150,\n          //{{A9_DISPLAY_TIMEOUT}}\n          DISPLAY_REFRESH_TIMEOUT: 1150,\n          //{{A9_DISPLAY_REFRESH_TIMEOUT}}\n          VIDEO_TIMEOUT: 500,\n          //{{A9_VIDEO_TIMEOUT}}\n          VIDEO_REFRESH_TIMEOUT: 950,\n          //{{A9_VIDEO_REFRESH_TIMEOUT}}\n          DESKTOP_DISPLAY_TIMEOUT: 1150,\n          //{{A9_DESKTOP_DISPLAY_TIMEOUT}}\n          DESKTOP_DISPLAY_REFRESH_TIMEOUT: 1150,\n          //{{A9_DESKTOP_DISPLAY_REFRESH_TIMEOUT}}\n          DESKTOP_VIDEO_TIMEOUT: 500,\n          //{{A9_DESKTOP_VIDEO_TIMEOUT}}\n          DESKTOP_VIDEO_REFRESH_TIMEOUT: 950,\n          //{{A9_DESKTOP_VIDEO_REFRESH_TIMEOUT}}\n          MOBILE_DISPLAY_TIMEOUT: 750,\n          //{{A9_MOBILE_DISPLAY_TIMEOUT}}\n          MOBILE_DISPLAY_REFRESH_TIMEOUT: 750,\n          //{{A9_MOBILE_DISPLAY_REFRESH_TIMEOUT}}\n          MOBILE_VIDEO_TIMEOUT: 500,\n          //{{A9_MOBILE_VIDEO_TIMEOUT}}\n          MOBILE_VIDEO_REFRESH_TIMEOUT: 750 //{{A9_MOBILE_VIDEO_REFRESH_TIMEOUT}}\n\n        },\n        BEEMRAY: {\n          CUSTOMER_ID: 'cnn',\n          API_KEY: '39a34d8d-dd1d-4fbf-aa96-fdc5f0329451'\n        },\n        CRITEO: {\n          DESKTOP_ZONES: {\n            '160x600': 1047134,\n            '300x250': 1047135,\n            '300x600': 1047136,\n            '728x90': 1047137,\n            'HP_970x90': 1128528,\n            'HP_970x250': 1128527,\n            'ROS_970x90': 1047140,\n            'ROS_970x250': 1047139,\n            '320x50': 1047138\n          },\n          MOBILE_ZONES: {\n            '300x250': 1090825,\n            '320x50': 1090883\n          },\n          MULTISIZE_METHOD: 'L',\n          TIMEOUT: 750,\n          DESKTOP_TIMEOUT: 1150,\n          MOBILE_TIMEOUT: 750\n        },\n        GDPR: {\n          APP_ID: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c',\n          APPLIES: window.AdFuelUtils.getGDPRApplies('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c')\n        },\n        IAS: {\n          DOM_PUB_ID: 925660,\n          //{{IAS_DOM_PUB_ID}}\n          INTL_PUB_ID: 925660 //{{IAS_INTL_PUB_ID}}\n\n        },\n        IX: {\n          CNNB: {\n            intl: '186370-111488446026291',\n            dom: '186948-131280192444057'\n          },\n          SCRIPT_MAP: {\n            '^((www|us|stage.next)\\\\.|(www|us|stage.next)\\\\-m\\\\.)?cnn\\\\.com': {\n              intl: '186370-96070407099023',\n              dom: '186948-60896576130421'\n            },\n            '^(edition\\\\.||edition\\\\-m\\\\.)cnn\\\\.com': '186370-129055748395673'\n          }\n        },\n        KRUX: {\n          DOM_CONTROLTAG: 'ITb_4eqO',\n          INTL_CONTROLTAG: 'ITb_9Zup'\n        },\n        PREBID: {\n          DOM_BIDDERS: ['rubicon', 'appnexus'],\n          INTL_BIDDERS: ['appnexus', 'pangaea', 'rubicon'],\n          NATIVE_BIDDERS: ['appnexus', 'pangaea'],\n          DOM_ACCOUNT_IDS: {\n            rubicon: '11078',\n            appnexus: '7745'\n          },\n          INTL_ACCOUNT_IDS: {\n            rubicon: '11016',\n            appnexus: '8353',\n            pangaea: '8613'\n          },\n          RUBICON_DOM_DESKTOP_SITE_ID: 26792,\n          RUBICON_INTL_DESKTOP_SITE_ID: 78582,\n          RUBICON_DOM_MOBILE_SITE_ID: 42244,\n          RUBICON_INTL_MOBILE_SITE_ID: 78584,\n          RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING: {\n            'atf': 761276,\n            'btf': 761276\n          },\n          RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING: {\n            'atf': 761276,\n            'btf': 761276\n          },\n          RUBICON_DOM_MOBILE_ZONE_MAPPING: {\n            'atf': 761278,\n            'btf': 761278\n          },\n          RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING: {\n            'atf': 369850,\n            'btf': 369850\n          },\n          RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING: {\n            'atf': 369850,\n            'btf': 369850\n          },\n          RUBICON_INTL_MOBILE_ZONE_MAPPING: {\n            'atf': 369856,\n            'btf': 369856\n          },\n          TIMEOUT: 750,\n          //{{PREBID_TIMEOUT}}\n          DESKTOP_TIMEOUT: 1150,\n          //{{PREBID_DESKTOP_TIMEOUT}}\n          MOBILE_TIMEOUT: 750 //{{PREBID_MOBILE_TIMEOUT}}\n\n        }\n      };\n      window.AdFuelOptions = window.AdFuelUtils.mergeDeep(window.AdFuelOptions, window.CNN_OPTIONS);\n      break;\n\n    case 'style':\n      window.CNN_OPTIONS = {\n        OPTIONS_VERSION: 1.2,\n        ADFUEL: {\n          DEFAULT_DESKTOP_TIMEOUT: 1200,\n          //{{ADFUEL_DEFAULT_DESKTOP_TIMEOUT}}\n          DEFAULT_MOBILE_TIMEOUT: 800,\n          //{{ADFUEL_DEFAULT_MOBILE_TIMEOUT}}\n          SITE_OBJECT: 'CNN' //{{ADFUEL_SITE_OBJECT}}\n\n        },\n        A9: {\n          DISPLAY_TIMEOUT: 1150,\n          //{{A9_DISPLAY_TIMEOUT}}\n          DISPLAY_REFRESH_TIMEOUT: 1150,\n          //{{A9_DISPLAY_REFRESH_TIMEOUT}}\n          VIDEO_TIMEOUT: 500,\n          //{{A9_VIDEO_TIMEOUT}}\n          VIDEO_REFRESH_TIMEOUT: 1150,\n          //{{A9_VIDEO_REFRESH_TIMEOUT}}\n          DESKTOP_DISPLAY_TIMEOUT: 1150,\n          //{{A9_DESKTOP_DISPLAY_TIMEOUT}}\n          DESKTOP_DISPLAY_REFRESH_TIMEOUT: 1150,\n          //{{A9_DESKTOP_DISPLAY_REFRESH_TIMEOUT}}\n          DESKTOP_VIDEO_TIMEOUT: 500,\n          //{{A9_DESKTOP_VIDEO_TIMEOUT}}\n          DESKTOP_VIDEO_REFRESH_TIMEOUT: 1150,\n          //{{A9_DESKTOP_VIDEO_REFRESH_TIMEOUT}}\n          MOBILE_DISPLAY_TIMEOUT: 750,\n          //{{A9_MOBILE_DISPLAY_TIMEOUT}}\n          MOBILE_DISPLAY_REFRESH_TIMEOUT: 750,\n          //{{A9_MOBILE_DISPLAY_REFRESH_TIMEOUT}}\n          MOBILE_VIDEO_TIMEOUT: 500,\n          //{{A9_MOBILE_VIDEO_TIMEOUT}}\n          MOBILE_VIDEO_REFRESH_TIMEOUT: 750 //{{A9_MOBILE_VIDEO_REFRESH_TIMEOUT}}\n\n        },\n        BEEMRAY: {\n          CUSTOMER_ID: 'cnn',\n          API_KEY: '39a34d8d-dd1d-4fbf-aa96-fdc5f0329451'\n        },\n        CRITEO: {\n          DESKTOP_ZONES: {\n            '160x600': 1047134,\n            '300x250': 1047135,\n            '300x600': 1047136,\n            '728x90': 1047137,\n            'HP_970x90': 1128528,\n            'HP_970x250': 1128527,\n            'ROS_970x90': 1047140,\n            'ROS_970x250': 1047139,\n            '320x50': 1047138\n          },\n          MOBILE_ZONES: {\n            '300x250': 1090825,\n            '320x50': 1090883\n          },\n          MULTISIZE_METHOD: 'L',\n          TIMEOUT: 750,\n          DESKTOP_TIMEOUT: 950,\n          MOBILE_TIMEOUT: 750\n        },\n        GDPR: {\n          APP_ID: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c',\n          APPLIES: window.AdFuelUtils.getGDPRApplies('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c')\n        },\n        IAS: {\n          DOM_PUB_ID: 925660,\n          //{{IAS_DOM_PUB_ID}}\n          INTL_PUB_ID: 925660 //{{IAS_INTL_PUB_ID}}\n\n        },\n        IX: {\n          SCRIPT_MAP: {\n            '^((www|us|stage.next)\\\\.|(www|us|stage.next)\\\\-m\\\\.)?cnn\\\\.com': {\n              intl: '186370-96070407099023',\n              dom: '186948-60896576130421'\n            },\n            '^(edition\\\\.||edition\\\\-m\\\\.)cnn\\\\.com': '186370-129055748395673'\n          }\n        },\n        KRUX: {\n          DOM_CONTROLTAG: 'ITb_4eqO',\n          INTL_CONTROLTAG: 'ITb_9Zup'\n        },\n        PREBID: {\n          DOM_BIDDERS: ['rubicon', 'appnexus'],\n          INTL_BIDDERS: ['appnexus', 'pangaea', 'rubicon'],\n          NATIVE_BIDDERS: ['appnexus', 'pangaea'],\n          DOM_ACCOUNT_IDS: {\n            rubicon: '11078',\n            appnexus: '7745'\n          },\n          INTL_ACCOUNT_IDS: {\n            rubicon: '11016',\n            appnexus: '8353',\n            pangaea: '8613'\n          },\n          RUBICON_DOM_DESKTOP_SITE_ID: 26792,\n          RUBICON_INTL_DESKTOP_SITE_ID: 78582,\n          RUBICON_DOM_MOBILE_SITE_ID: 42244,\n          RUBICON_INTL_MOBILE_SITE_ID: 78584,\n          RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING: {\n            'atf': 106536,\n            'btf': 154308\n          },\n          RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING: {\n            'atf': 106830,\n            'btf': 107752\n          },\n          RUBICON_DOM_MOBILE_ZONE_MAPPING: {\n            'atf': 185914,\n            'btf': 185914\n          },\n          RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING: {\n            'atf': 650180,\n            'btf': 650180\n          },\n          RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING: {\n            'atf': 650180,\n            'btf': 650180\n          },\n          RUBICON_INTL_MOBILE_ZONE_MAPPING: {\n            'atf': 369856,\n            'btf': 369856\n          },\n          TIMEOUT: 750,\n          //{{PREBID_TIMEOUT}}\n          DESKTOP_TIMEOUT: 1150,\n          //{{PREBID_DESKTOP_TIMEOUT}}\n          MOBILE_TIMEOUT: 750 //{{PREBID_MOBILE_TIMEOUT}}\n\n        }\n      };\n      window.AdFuelOptions = window.AdFuelUtils.mergeDeep(window.AdFuelOptions, window.CNN_OPTIONS);\n      break;\n\n    default:\n      if (CNN.SiteLocation.site === 'edition') {\n        window.CNN_OPTIONS = {\n          OPTIONS_VERSION: 1.2,\n          ADFUEL: {\n            DEFAULT_DESKTOP_TIMEOUT: 1200,\n            //{{ADFUEL_DEFAULT_DESKTOP_TIMEOUT}}\n            DEFAULT_MOBILE_TIMEOUT: 800,\n            //{{ADFUEL_DEFAULT_MOBILE_TIMEOUT}}\n            SITE_OBJECT: 'CNN' //{{ADFUEL_SITE_OBJECT}}\n\n          },\n          A9: {\n            DISPLAY_TIMEOUT: 1150,\n            //{{A9_DISPLAY_TIMEOUT}}\n            DISPLAY_REFRESH_TIMEOUT: 1150,\n            //{{A9_DISPLAY_REFRESH_TIMEOUT}}\n            VIDEO_TIMEOUT: 500,\n            //{{A9_VIDEO_TIMEOUT}}\n            VIDEO_REFRESH_TIMEOUT: 1150,\n            //{{A9_VIDEO_REFRESH_TIMEOUT}}\n            DESKTOP_DISPLAY_TIMEOUT: 1150,\n            //{{A9_DESKTOP_DISPLAY_TIMEOUT}}\n            DESKTOP_DISPLAY_REFRESH_TIMEOUT: 1150,\n            //{{A9_DESKTOP_DISPLAY_REFRESH_TIMEOUT}}\n            DESKTOP_VIDEO_TIMEOUT: 500,\n            //{{A9_DESKTOP_VIDEO_TIMEOUT}}\n            DESKTOP_VIDEO_REFRESH_TIMEOUT: 1150,\n            //{{A9_DESKTOP_VIDEO_REFRESH_TIMEOUT}}\n            MOBILE_DISPLAY_TIMEOUT: 750,\n            //{{A9_MOBILE_DISPLAY_TIMEOUT}}\n            MOBILE_DISPLAY_REFRESH_TIMEOUT: 750,\n            //{{A9_MOBILE_DISPLAY_REFRESH_TIMEOUT}}\n            MOBILE_VIDEO_TIMEOUT: 500,\n            //{{A9_MOBILE_VIDEO_TIMEOUT}}\n            MOBILE_VIDEO_REFRESH_TIMEOUT: 750 //{{A9_MOBILE_VIDEO_REFRESH_TIMEOUT}}\n\n          },\n          BEEMRAY: {\n            CUSTOMER_ID: 'cnn',\n            API_KEY: '39a34d8d-dd1d-4fbf-aa96-fdc5f0329451'\n          },\n          CRITEO: {\n            DESKTOP_ZONES: {\n              '160x600': 1047134,\n              '300x250': 1047135,\n              '300x600': 1047136,\n              '728x90': 1047137,\n              'HP_970x90': 1128528,\n              'HP_970x250': 1128527,\n              'ROS_970x90': 1047140,\n              'ROS_970x250': 1047139,\n              '320x50': 1047138\n            },\n            MOBILE_ZONES: {\n              '300x250': 1302583,\n              '320x50': 1090883\n            },\n            MULTISIZE_METHOD: 'L',\n            TIMEOUT: 750,\n            DESKTOP_TIMEOUT: 1150,\n            MOBILE_TIMEOUT: 750\n          },\n          GDPR: {\n            APP_ID: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c',\n            APPLIES: window.AdFuelUtils.getGDPRApplies('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c')\n          },\n          IAS: {\n            DOM_PUB_ID: 925660,\n            //{{IAS_DOM_PUB_ID}}\n            INTL_PUB_ID: 925660 //{{IAS_INTL_PUB_ID}}\n\n          },\n          IX: {\n            SCRIPT_MAP: {\n              '^((www|us|stage.next)\\\\.|(www|us|stage.next)\\\\-m\\\\.)?cnn\\\\.com': {\n                intl: '186370-96070407099023',\n                dom: '186948-60896576130421'\n              },\n              '^(edition\\\\.||edition\\\\-m\\\\.)cnn\\\\.com': '186370-129055748395673'\n            }\n          },\n          KRUX: {\n            DOM_CONTROLTAG: 'teff18ls8',\n            INTL_CONTROLTAG: 'teff18ls8'\n          },\n          PREBID: {\n            DOM_BIDDERS: ['rubicon', 'appnexus'],\n            INTL_BIDDERS: ['appnexus', 'pangaea', 'rubicon'],\n            NATIVE_BIDDERS: ['appnexus', 'pangaea'],\n            DOM_ACCOUNT_IDS: {\n              rubicon: '11078',\n              appnexus: '7745'\n            },\n            INTL_ACCOUNT_IDS: {\n              rubicon: '11016',\n              appnexus: '8353',\n              pangaea: '8613'\n            },\n            RUBICON_DOM_DESKTOP_SITE_ID: 26792,\n            RUBICON_INTL_DESKTOP_SITE_ID: 78582,\n            RUBICON_DOM_MOBILE_SITE_ID: 42244,\n            RUBICON_INTL_MOBILE_SITE_ID: 78584,\n            RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING: {\n              'atf': 106536,\n              'btf': 154308,\n              'politics': 761276,\n              'style': 0\n            },\n            RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING: {\n              'atf': 106830,\n              'btf': 107752,\n              'politics': 761276,\n              'style': 0\n            },\n            RUBICON_DOM_MOBILE_ZONE_MAPPING: {\n              'atf': 185914,\n              'btf': 185914,\n              'politics': 761278,\n              'style': 0\n            },\n            RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING: {\n              'atf': 650178,\n              'btf': 650178,\n              'politics': 761276,\n              'style': 650180\n            },\n            RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING: {\n              'atf': 369850,\n              'btf': 369850,\n              'politics': 761276,\n              'style': 650180\n            },\n            RUBICON_INTL_MOBILE_ZONE_MAPPING: {\n              'atf': 369856,\n              'btf': 369856,\n              'politics': 369856,\n              'style': 369856\n            },\n            TIMEOUT: 750,\n            //{{PREBID_TIMEOUT}}\n            DESKTOP_TIMEOUT: 1150,\n            //{{PREBID_DESKTOP_TIMEOUT}}\n            MOBILE_TIMEOUT: 750 //{{PREBID_MOBILE_TIMEOUT}}\n\n          }\n        };\n        window.AdFuelOptions = window.AdFuelUtils.mergeDeep(window.AdFuelOptions, window.CNN_OPTIONS);\n      } else {\n        window.CNN_OPTIONS = {\n          OPTIONS_VERSION: 1.2,\n          ADFUEL: {\n            DEFAULT_DESKTOP_TIMEOUT: 1200,\n            //{{ADFUEL_DEFAULT_DESKTOP_TIMEOUT}}\n            DEFAULT_MOBILE_TIMEOUT: 800,\n            //{{ADFUEL_DEFAULT_MOBILE_TIMEOUT}}\n            SITE_OBJECT: 'CNN' //{{ADFUEL_SITE_OBJECT}}\n\n          },\n          A9: {\n            DISPLAY_TIMEOUT: 1150,\n            //{{A9_DISPLAY_TIMEOUT}}\n            DISPLAY_REFRESH_TIMEOUT: 1150,\n            //{{A9_DISPLAY_REFRESH_TIMEOUT}}\n            VIDEO_TIMEOUT: 500,\n            //{{A9_VIDEO_TIMEOUT}}\n            VIDEO_REFRESH_TIMEOUT: 1150,\n            //{{A9_VIDEO_REFRESH_TIMEOUT}}\n            DESKTOP_DISPLAY_TIMEOUT: 1150,\n            //{{A9_DESKTOP_DISPLAY_TIMEOUT}}\n            DESKTOP_DISPLAY_REFRESH_TIMEOUT: 1150,\n            //{{A9_DESKTOP_DISPLAY_REFRESH_TIMEOUT}}\n            DESKTOP_VIDEO_TIMEOUT: 500,\n            //{{A9_DESKTOP_VIDEO_TIMEOUT}}\n            DESKTOP_VIDEO_REFRESH_TIMEOUT: 1150,\n            //{{A9_DESKTOP_VIDEO_REFRESH_TIMEOUT}}\n            MOBILE_DISPLAY_TIMEOUT: 750,\n            //{{A9_MOBILE_DISPLAY_TIMEOUT}}\n            MOBILE_DISPLAY_REFRESH_TIMEOUT: 750,\n            //{{A9_MOBILE_DISPLAY_REFRESH_TIMEOUT}}\n            MOBILE_VIDEO_TIMEOUT: 500,\n            //{{A9_MOBILE_VIDEO_TIMEOUT}}\n            MOBILE_VIDEO_REFRESH_TIMEOUT: 750 //{{A9_MOBILE_VIDEO_REFRESH_TIMEOUT}}\n\n          },\n          BEEMRAY: {\n            CUSTOMER_ID: 'cnn',\n            API_KEY: '39a34d8d-dd1d-4fbf-aa96-fdc5f0329451'\n          },\n          CRITEO: {\n            DESKTOP_ZONES: {\n              '160x600': 1047134,\n              '300x250': 1047135,\n              '300x600': 1047136,\n              '728x90': 1047137,\n              'HP_970x90': 1128528,\n              'HP_970x250': 1128527,\n              'ROS_970x90': 1047140,\n              'ROS_970x250': 1047139,\n              '320x50': 1047138\n            },\n            MOBILE_ZONES: {\n              '300x250': 1090825,\n              '320x50': 1090883\n            },\n            MULTISIZE_METHOD: 'L',\n            TIMEOUT: 750,\n            DESKTOP_TIMEOUT: 1150,\n            MOBILE_TIMEOUT: 750\n          },\n          GDPR: {\n            APP_ID: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c',\n            APPLIES: window.AdFuelUtils.getGDPRApplies('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwbGF0Zm9ybSI6IndlYiIsInByb2R1Y3QiOiJhZGZ1ZWwiLCJuZXR3b3JrIjoiY25uIiwiYXBwSWQiOiJjbm4tYWRmdWVsLXdlYi14bWQ2dTkifQ.N-lYZh_mvCV2gChDusNhd85B2BD7AiCIcNY2Gr5Rc6c')\n          },\n          IAS: {\n            DOM_PUB_ID: 925660,\n            //{{IAS_DOM_PUB_ID}}\n            INTL_PUB_ID: 925660 //{{IAS_INTL_PUB_ID}}\n\n          },\n          IX: {\n            SCRIPT_MAP: {\n              '^((www|us|stage.next)\\\\.|(www|us|stage.next)\\\\-m\\\\.)?cnn\\\\.com': {\n                intl: '186370-96070407099023',\n                dom: '186948-60896576130421'\n              },\n              '^(edition\\\\.||edition\\\\-m\\\\.)cnn\\\\.com': '186370-129055748395673'\n            }\n          },\n          KRUX: {\n            DOM_CONTROLTAG: 'ITb_4eqO',\n            INTL_CONTROLTAG: 'teff71jyu'\n          },\n          PREBID: {\n            DOM_BIDDERS: ['rubicon', 'appnexus'],\n            INTL_BIDDERS: ['appnexus', 'pangaea', 'rubicon'],\n            NATIVE_BIDDERS: ['appnexus', 'pangaea'],\n            DOM_ACCOUNT_IDS: {\n              rubicon: '11078',\n              appnexus: '7745'\n            },\n            INTL_ACCOUNT_IDS: {\n              rubicon: '11016',\n              appnexus: '8353',\n              pangaea: '8613'\n            },\n            RUBICON_DOM_DESKTOP_SITE_ID: 26792,\n            RUBICON_INTL_DESKTOP_SITE_ID: 78582,\n            RUBICON_DOM_MOBILE_SITE_ID: 42244,\n            RUBICON_INTL_MOBILE_SITE_ID: 78584,\n            RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING: {\n              'atf': 106536,\n              'btf': 154308,\n              'politics': 761276,\n              'style': 0\n            },\n            RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING: {\n              'atf': 106830,\n              'btf': 107752,\n              'politics': 761276,\n              'style': 0\n            },\n            RUBICON_DOM_MOBILE_ZONE_MAPPING: {\n              'atf': 185914,\n              'btf': 185914,\n              'politics': 761278,\n              'style': 0\n            },\n            RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING: {\n              'atf': 650178,\n              'btf': 650178,\n              'politics': 761276,\n              'style': 650180\n            },\n            RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING: {\n              'atf': 369850,\n              'btf': 369850,\n              'politics': 761276,\n              'style': 650180\n            },\n            RUBICON_INTL_MOBILE_ZONE_MAPPING: {\n              'atf': 369856,\n              'btf': 369856,\n              'politics': 369856,\n              'style': 369856\n            },\n            TIMEOUT: 750,\n            //{{PREBID_TIMEOUT}}\n            DESKTOP_TIMEOUT: 1150,\n            //{{PREBID_DESKTOP_TIMEOUT}}\n            MOBILE_TIMEOUT: 750 //{{PREBID_MOBILE_TIMEOUT}}\n\n          }\n        };\n        window.AdFuelOptions = window.AdFuelUtils.mergeDeep(window.AdFuelOptions, window.CNN_OPTIONS);\n      }\n\n  }\n\n  if (CNN.Features.enableIndexExchange === true) {\n    (function createIndexExchangeWrapperModule() {\n      var MODULE_NAME = 'IndexExchange Wrapper Module';\n      var MODULE_VERSION = 'v3.1.1'; // Stub out AdFuelUtils in case it's not on the page.\n\n      window.AdFuelUtils = window.AdFuelUtils || {\n        addEvent: function addEvent() {},\n        getLogger: function getLogger() {}\n      }; // Stub out AdFuelOptions in case it's not on the page.\n\n      window.AdFuelOptions = window.AdFuelOptions || {};\n      window.AdFuelOptions.IX = window.AdFuelOptions.IX || {};\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'ix', 'color: #58f53f; padding: 2px');\n      var scriptLoaded = false;\n\n      function includeWrapper(scriptUrl) {\n        logger.log('Script Loaded: ', scriptLoaded, scriptUrl);\n\n        if (!scriptLoaded && scriptUrl !== '' && scriptUrl !== null && typeof scriptUrl !== 'undefined') {\n          logger.log('Adding Script... ', scriptUrl);\n          scriptLoaded = true;\n          var a = document;\n          var b = a.createElement('script');\n          var c = a.getElementsByTagName('head')[0];\n          var d = /^(complete|loaded)$/;\n          var e = false;\n          b.type = 'text/javascript';\n          b.src = scriptUrl;\n\n          b.onload = b.onreadystatechange = function () {\n            if (!e && !('readyState' in b && d.test(b.readyState))) {\n              b.onload = b.onreadystatechange = null;\n              logger.timeEnd('Loading IndexExchangeWrapper...');\n              e = true;\n              logger.log('Script Loaded...');\n            }\n          };\n\n          logger.time('Loading IndexExchangeWrapper...');\n          c.appendChild(b);\n        }\n      }\n\n      function setGeoTargeting(forceIntl) {\n        function setGeoTarget() {\n          if (window.AdFuelUtils.isIntl) {\n            logger.log('Setting IX Geo Target: EU');\n            window.AdFuel.addPageLevelTarget('iom_geo', 'EU');\n          } else if (forceIntl) {\n            logger.log('Setting IX Geo Target: EU');\n            window.AdFuel.addPageLevelTarget('iom_geo', 'EU');\n          } else {\n            logger.log('Setting IX Geo Target: US');\n            window.AdFuel.addPageLevelTarget('iom_geo', 'US');\n          }\n        }\n\n        window.googletag.cmd.push(setGeoTarget);\n      }\n\n      function registerModuleWithAdFuel() {\n        logger.log('Registering Module...');\n        window.AdFuel.registerModule(MODULE_NAME, {}, MODULE_VERSION, window.AdFuelOptions.IX);\n      }\n\n      function init() {\n        var scriptKey = window.AdFuelOptions.IX.SCRIPT_KEY || '';\n\n        if (scriptKey === '') {\n          var scriptMap = window.AdFuelOptions.IX.SCRIPT_MAP || {};\n          Object.keys(scriptMap).forEach(function (regex) {\n            var test = new RegExp(regex);\n\n            if (window.location.hostname.search(test) === 0) {\n              if (typeof scriptMap[regex] === 'string') {\n                scriptKey = scriptMap[regex];\n              } else {\n                if (window.AdFuelUtils.isIntl) {\n                  scriptKey = scriptMap[regex].intl;\n                } else {\n                  scriptKey = scriptMap[regex].dom;\n                }\n              }\n            }\n          });\n        }\n\n        window.AdFuelOptions.GDPR ? window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n          if (applies && !window.AdFuelUtils.getConsent()) {\n            logger.log('Disabling IndexExchange due to GDPR restrictions.');\n          } else {\n            logger.log('Script Key: ', scriptKey);\n            var forceIntl = false;\n\n            if (scriptKey !== '' && scriptKey !== null && typeof scriptKey !== 'undefined') {\n              var scriptUrl = '//js-sec.indexww.com/ht/p/' + scriptKey + '.js';\n              includeWrapper(scriptUrl);\n              setGeoTargeting(forceIntl);\n\n              if (window.AdFuel && window.AdFuel.cmd) {\n                window.AdFuel.cmd.push(registerModuleWithAdFuel);\n              } else if (window.AdFuel) {\n                registerModuleWithAdFuel();\n              } else {\n                window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n              }\n            } else {\n              logger.log('No Script Key.  Skipping initialization.');\n            }\n          }\n        }) : '';\n      }\n\n      init();\n    })();\n  }\n\n  if (CNN.Features.enableCriteoAds === true) {\n    (function createCriteoModule() {\n      var MODULE_NAME = 'Criteo Module';\n      var MODULE_VERSION = 'v3.2.1';\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'criteo', 'color: #58f53f; padding: 2px');\n      window.Criteo = window.Criteo || {};\n      window.Criteo.events = window.Criteo.events || [];\n      var scriptLoaded = false;\n      var adapterLoaded = false;\n      var MaxPlacements = 8;\n      var MultisizeMethod = window.AdFuelOptions.CRITEO.MULTISIZE_METHOD;\n      var zones_in_slot = {};\n      var slot_max_area = {};\n      var RequestedCriteoAdUnits = {\n        placements: []\n      };\n      var DesktopZones = window.AdFuelOptions.CRITEO.DESKTOP_ZONES;\n      var MobileZones = window.AdFuelOptions.CRITEO.MOBILE_ZONES;\n\n      function includeCriteoLibrary() {\n        if (!scriptLoaded) {\n          window.AdFuelOptions.GDPR ? window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n            if (applies && !window.AdFuelUtils.getConsent()) {\n              logger.log('Disabling Criteo due to GDPR restrictions.');\n            } else {\n              logger.log('Including Criteo Library...');\n              scriptLoaded = true;\n              var a = document;\n              var b = a.createElement('script');\n              var c = a.getElementsByTagName('script')[0];\n              b.type = 'text/javascript';\n              b.async = true;\n              b.src = '//static.criteo.net/js/ld/publishertag.js';\n              c.parentNode.insertBefore(b, c);\n            }\n          }) : '';\n        }\n      }\n\n      function includeYieldmoAdapter() {\n        if (!adapterLoaded) {\n          logger.log('Including Yieldmo Adapter...');\n          adapterLoaded = true;\n          var a = document;\n          var b = a.createElement('script');\n          var c = a.getElementsByTagName('script')[0];\n          b.type = 'text/javascript';\n          b.async = true;\n          b.src = '//static.yieldmo.com/ym-cdb-adapter.js';\n          c.parentNode.insertBefore(b, c);\n        }\n      }\n\n      function preQueueCallback(asset, callback) {\n        logger.time('Building Criteo Placements');\n        var CriteoAdUnits = {\n          'placements': []\n        },\n            slotid,\n            x;\n\n        for (x = 0; x < asset.length; x++) {\n          var slot = asset[x];\n\n          if (slot.rktr_slot_id !== 'page' && (slot.monetization ? slot.monetization.isMonetized : false)) {\n            var slot_sizes = slot.monetization.filteredSizes;\n            var adUnit = slot.rktr_ad_id;\n            slotid = slot.rktr_slot_id;\n            zones_in_slot[slotid] = [];\n            slot_max_area[slotid] = 0;\n            var siteAdUnit = adUnit.split('/')[0];\n\n            for (var y = 0; y < slot_sizes.length; y++) {\n              var sizeArray = slot_sizes[y];\n              var width = sizeArray[0] || null;\n              var height = sizeArray[1] || null;\n              var area = width !== null ? width * height : 0;\n              var size_name = width !== null ? width + 'x' + height : sizeArray.join('x');\n              var zoneid = DesktopZones[size_name] ? DesktopZones[size_name] : DesktopZones['ROS_' + size_name] ? DesktopZones['ROS_' + size_name] : null;\n              if (siteAdUnit === 'CNN' && adUnit.indexOf('homepage') > 0) zoneid = DesktopZones['HP_' + size_name] || zoneid;\n\n              if (['300x250', '320x50'].indexOf(size_name) !== -1 && window.AdFuelUtils.isMobile.any) {\n                logger.log('Using Mobile zoneId for size: ', size_name);\n                zoneid = MobileZones[size_name] || null;\n              }\n\n              if (zoneid !== null) {\n                slot_max_area[slotid] = area > slot_max_area[slotid] ? area : slot_max_area[slotid];\n                var data = {\n                  'slotid': slotid,\n                  'zoneid': zoneid,\n                  'width': width,\n                  'height': height,\n                  'area': area\n                };\n\n                if (zones_in_slot[slotid].indexOf(data) === -1) {\n                  logger.log('Pushing data...', data);\n                  zones_in_slot[slotid].push(data);\n                } else {\n                  logger.log('Skipping... Already exists...', data);\n                }\n              }\n            }\n          }\n        }\n\n        var count = 0;\n\n        for (slotid in zones_in_slot) {\n          if (zones_in_slot.hasOwnProperty(slotid)) {\n            var zones = zones_in_slot[slotid];\n\n            for (x = 0; x < zones.length; x++) {\n              var zone = zones[x];\n              if (count >= MaxPlacements) break;\n              if (MultisizeMethod === window.AdFuelOptions.CRITEO.MULTISIZE_LARGEST && zone.area !== slot_max_area[zone.slotid]) continue;\n              var placement = {\n                'slotid': slotid,\n                'zoneid': zone.zoneid\n              };\n              var exists = false;\n              CriteoAdUnits.placements.forEach(function forEachPlacementFunc(cPlacement) {\n                if (cPlacement.slotid === placement.slotid && cPlacement.zoneid === placement.zoneid) exists = true;\n              });\n              RequestedCriteoAdUnits.placements.forEach(function forEachRequestedPlacementFunc(rPlacement) {\n                if (rPlacement.slotid === placement.slotid && rPlacement.zoneid === placement.zoneid) exists = true;\n              });\n\n              if (!exists) {\n                if (adapterLoaded && placement.zoneid === 1302583) {\n                  logger.log('Adding Yieldmo.criteoCallback as nativeCallback...');\n\n                  placement['nativeCallback'] = function (json) {\n                    window.Yieldmo.criteoCallback(json, slotid);\n                  };\n                } else if (adapterLoaded) {\n                  logger.log('Adding noop nativeCallback...');\n\n                  placement['nativeCallback'] = function () {};\n                } else {\n                  logger.log('Not adding nativeCallback...');\n                }\n\n                logger.log('Placement does not yet exist.  Adding to collection.', placement);\n                CriteoAdUnits.placements.push(placement);\n              }\n\n              count++;\n              if (MultisizeMethod === window.AdFuelOptions.CRITEO.MULTISIZE_FIRST) break;\n            }\n          }\n        }\n\n        function eventFunction() {\n          logger.log('Setting LineItem Ranges...');\n          window.Criteo.SetLineItemRanges('0..5:0.01;5..30:0.05;30..100:1.00');\n          logger.log('Previously Requested: ', RequestedCriteoAdUnits);\n          window.AdFuelUtils.metricApi.addMetric({\n            type: 'vendor',\n            id: 'Criteo',\n            data: zones_in_slot\n          });\n          CriteoAdUnits.placements.forEach(function (placement, index) {\n            var matched = false;\n            RequestedCriteoAdUnits.placements.forEach(function (requested) {\n              if (requested.slotid === placement.slotid) {\n                matched = true;\n              }\n            });\n\n            if (matched) {\n              CriteoAdUnits.placements.splice(index, 1);\n            }\n          });\n          logger.log('Requesting Bids...', CriteoAdUnits);\n          RequestedCriteoAdUnits.placements = RequestedCriteoAdUnits.placements.concat(CriteoAdUnits.placements);\n          window.Criteo.RequestBids(CriteoAdUnits, function (bids) {\n            callback(null, bids);\n          }, window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.CRITEO.MOBILE_TIMEOUT || window.AdFuelOptions.CRITEO.TIMEOUT : window.AdFuelOptions.CRITEO.DESKTOP_TIMEOUT || window.AdFuelOptions.CRITEO.TIMEOUT);\n        }\n\n        if (CriteoAdUnits.placements.length > 0) {\n          window.Criteo.events.push(eventFunction);\n        } else callback();\n\n        logger.timeEnd('Building Criteo Placements');\n      }\n\n      function preDispatchCallback(asset, callback) {\n        try {\n          window.googletag.cmd.push(function () {\n            logger.log('Setting DFP KeyValue Targeting...');\n\n            if (window.Criteo && window.Criteo.SetDFPKeyValueTargeting) {\n              window.Criteo.SetDFPKeyValueTargeting();\n            }\n          });\n        } catch (e) {\n          logger.error(e);\n        }\n\n        callback();\n      }\n\n      function preRefreshCallback(asset, callback) {\n        var internalCallback = preDispatchCallback.bind(null, asset, callback);\n\n        function eventFunc() {\n          if (RequestedCriteoAdUnits.placements.length > 0) {\n            logger.log('Setting LineItem Ranges...');\n            window.Criteo.SetLineItemRanges('0..3:0.01;3..8:0.05;8..20:0.50;20..30:1.00');\n            logger.log('Requesting Bids...', RequestedCriteoAdUnits);\n            window.AdFuelUtils.metricApi.addMetric({\n              type: 'vendor',\n              id: 'Criteo',\n              data: zones_in_slot\n            });\n            window.Criteo.RequestBids(RequestedCriteoAdUnits, internalCallback, window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.CRITEO.MOBILE_TIMEOUT || window.AdFuelOptions.CRITEO.TIMEOUT : window.AdFuelOptions.CRITEO.DESKTOP_TIMEOUT || window.AdFuelOptions.CRITEO.TIMEOUT);\n          }\n        }\n\n        window.Criteo.events.push(eventFunc);\n      }\n\n      function registerModuleWithAdFuel() {\n        logger.log('Registering Module...');\n        window.AdFuel.registerModule(MODULE_NAME, {\n          //when dispatching or refreshing slots, set criteo targeting\n          preQueueCallback: preQueueCallback,\n          preDispatchCallback: preDispatchCallback,\n          preRefreshCallback: preRefreshCallback\n        }, MODULE_VERSION, window.AdFuelOptions.CRITEO);\n      }\n\n      function init() {\n        logger.log('Initializing Module...');\n        includeCriteoLibrary();\n\n        if (window.AdFuelUtils.isMobile.any && window.AdFuelOptions.ADFUEL.SITE_OBJECT === 'CNN') {// if CNN and on a mobile device...\n          // includeYieldmoAdapter();\n        }\n\n        if (window.AdFuel && window.AdFuel.cmd) {\n          window.AdFuel.cmd.push(registerModuleWithAdFuel);\n        } else if (window.AdFuel) {\n          //AdFuel loaded first\n          registerModuleWithAdFuel();\n        } else {\n          //wait for AdFuel to load\n          window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n        }\n      }\n\n      init();\n    })();\n  }\n\n  if (CNN.Features.enableAmazonDisplayAds === true) {\n    /*\n        Amazon A9 Module - Version 3.2.0\n        - GDPR Updates (CSD-1883) (v3.2.0)\n    */\n    (function createA9AdFuelModule() {\n      'use strict';\n\n      var MODULE_NAME = 'Amazon A9 Module';\n      var MODULE_VERSION = 'v3.2.0';\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'a9', 'color: #58f53f; padding: 2px');\n      var blocked = false;\n      var a9bids; // display a9 bid cache\n\n      var bidSlots = []; // slots sent to a9 for auction\n\n      var refreshSlots = []; // slots sent to a9 on refresh\n\n      var defaultTimeout = window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.A9.MOBILE_VIDEO_TIMEOUT || window.AdFuelOptions.A9.VIDEO_TIMEOUT : window.AdFuelOptions.A9.DESKTOP_VIDEO_TIMEOUT || window.AdFuelOptions.A9.VIDEO_TIMEOUT;\n      var defaultRefreshTimeout = window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.A9.MOBILE_VIDEO_REFRESH_TIMEOUT || window.AdFuelOptions.A9.VIDEO_REFRESH_TIMEOUT : window.AdFuelOptions.A9.DESKTOP_VIDEO_REFRESH_TIMEOUT || window.AdFuelOptions.A9.VIDEO_REFRESH_TIMEOUT;\n\n      function getTargetingData(timeout) {\n        if (blocked) {\n          return new Promise(function (resolve) {\n            resolve({\n              'amznbid': '',\n              'amzniid': ''\n            });\n          });\n        } else {\n          timeout = timeout || defaultTimeout;\n          var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n\n          if (timeoutOverride) {\n            timeout = timeoutOverride;\n            logger.log('Overriding Max Duration Time: ', timeout);\n          }\n\n          var timeoutFunction = function timeoutFunction(resolve, reject) {\n            window.targetingTimeoutId = setTimeout(function () {\n              logger.log('getTargetingData timed out after ' + timeout + 'ms.');\n              clearTimeout(window.targetingTimeoutId);\n              reject('getTargetingData timed out after ' + timeout + 'ms.');\n            }, timeout);\n          };\n\n          var wrappedFunction = function wrappedFunction(resolve) {\n            logger.log('Getting Video targeting...');\n\n            var innerFunction = function innerFunction(bids) {\n              clearTimeout(window.targetingTimeoutId);\n              var targetBid = {};\n              bids.forEach(function (bid) {\n                if (bid.slotID.indexOf('aps-preroll') >= 0) {\n                  targetBid = bid;\n                }\n              });\n              var result = {\n                'amznbid': targetBid.amznbid || '',\n                'amzniid': targetBid.amzniid || ''\n              };\n              logger.log('Returning Targeting: ', result);\n              return result;\n            };\n\n            window.A9VideoAPI._targetingPromise.then(function (bids) {\n              resolve(innerFunction(bids));\n            });\n          };\n\n          var wrappedCallback = new Promise(wrappedFunction);\n          var timeoutCallback = new Promise(timeoutFunction); // Returns a race between the timeout and the passed in promise\n\n          return Promise.race([timeoutCallback, wrappedCallback]);\n        }\n      }\n\n      function getRefreshedTargetingData(slotName, timeout) {\n        if (blocked) {\n          return new Promise(function (resolve) {\n            resolve({\n              'amznbid': '',\n              'amzniid': ''\n            });\n          });\n        } else {\n          timeout = timeout || defaultRefreshTimeout;\n          slotName = slotName ? slotName + (window.AdFuelUtils.isMobile.phone ? '-mobile' : '') : window.AdFuelUtils.isMobile.phone ? 'aps-midroll-mobile' : 'aps-midroll';\n          var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n          var slotNameOverride = window.AdFuelUtils.getURLParam('slotname');\n\n          if (timeoutOverride) {\n            timeout = timeoutOverride;\n            logger.log('Overriding Max Duration Time: ', timeout);\n          }\n\n          if (slotNameOverride) {\n            logger.log('Overriding Slot Name: ', slotName);\n            slotName = slotNameOverride;\n          }\n\n          var timeoutFunction = function timeoutFunction(resolve, reject) {\n            window.targetingTimeoutId = setTimeout(function () {\n              logger.log('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n              clearTimeout(window.targetingTimeoutId);\n              reject('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n            }, timeout);\n          };\n\n          var wrappedFunction = function wrappedFunction(resolve) {\n            window.A9VideoAPI._refreshedTargetingPromise = new Promise(function (resolve) {\n              window.apstag.fetchBids({\n                si_section: 'video',\n                slots: [{\n                  slotID: slotName,\n                  mediaType: 'video'\n                }],\n                timeout: timeout\n              }, resolve);\n            });\n\n            var innerFunction = function innerFunction(bids) {\n              clearTimeout(window.targetingTimeoutId);\n              var targetBid = {};\n              bids.forEach(function (bid) {\n                if (bid.slotID === slotName) {\n                  targetBid = bid;\n                }\n              });\n              var result = {\n                'amznbid': targetBid.amznbid || '',\n                'amzniid': targetBid.amzniid || ''\n              };\n              logger.log('Returning Refreshed Targeting: ', result);\n              resolve(result);\n            };\n\n            logger.log('Refreshing Video targeting...');\n\n            window.A9VideoAPI._refreshedTargetingPromise.then(innerFunction);\n          };\n\n          var wrappedCallback = new Promise(wrappedFunction);\n          var timeoutCallback = new Promise(timeoutFunction); // Returns a race between the timeout and the passed in promise\n\n          return Promise.race([timeoutCallback, wrappedCallback]);\n        }\n      }\n\n      function getPreRollTargetingData(timeout) {\n        if (blocked) {\n          return new Promise(function (resolve) {\n            resolve({\n              'amznbid': '',\n              'amzniid': ''\n            });\n          });\n        } else {\n          timeout = timeout || defaultTimeout;\n          var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n          var slotNameOverride = window.AdFuelUtils.getURLParam('slotname');\n          var slotName = 'aps-preroll' + (window.AdFuelUtils.isMobile.phone ? '-mobile' : '');\n\n          if (timeoutOverride) {\n            timeout = timeoutOverride;\n            logger.log('Overriding Max Duration Time: ', timeout);\n          }\n\n          if (slotNameOverride) {\n            logger.log('Overriding Slot Name: ', slotName);\n            slotName = slotNameOverride;\n          }\n\n          var timeoutFunction = function timeoutFunction(resolve, reject) {\n            window.targetingTimeoutId = setTimeout(function () {\n              logger.log('getTargetingData timed out after ' + timeout + 'ms.');\n              clearTimeout(window.targetingTimeoutId);\n              reject('getTargetingData timed out after ' + timeout + 'ms.');\n            }, timeout);\n          };\n\n          var wrappedFunction = function wrappedFunction(resolve) {\n            logger.log('Getting A9 Video targeting...');\n\n            var innerFunction = function innerFunction(bids) {\n              clearTimeout(window.targetingTimeoutId);\n              var targetBid = {};\n              bids.forEach(function forEachBid(bid) {\n                if (bid.slotID === (slotNameOverride ? slotNameOverride : window.AdFuelUtils.isMobile.phone ? 'aps-preroll-mobile' : 'aps-preroll')) {\n                  targetBid = bid;\n                }\n              });\n              var result = {\n                'amznbid': targetBid.amznbid || '',\n                'amzniid': targetBid.amzniid || ''\n              };\n              logger.log('Returning Targeting: ', result);\n              return result;\n            };\n\n            window.A9VideoAPI._preRollTargetingPromise.then(function (bids) {\n              resolve(innerFunction(bids));\n            });\n          };\n\n          var wrappedCallback = new Promise(wrappedFunction);\n          var timeoutCallback = new Promise(timeoutFunction); // Returns a race between the timeout and the passed in promise\n\n          return Promise.race([timeoutCallback, wrappedCallback]);\n        }\n      }\n\n      function getRefreshedPreRollTargetingData(timeout) {\n        if (blocked) {\n          return new Promise(function (resolve) {\n            resolve({\n              'amznbid': '',\n              'amzniid': ''\n            });\n          });\n        } else {\n          timeout = timeout || defaultRefreshTimeout;\n          var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n          var slotNameOverride = window.AdFuelUtils.getURLParam('slotname');\n          var slotName = 'aps-preroll' + (window.AdFuelUtils.isMobile.phone ? '-mobile' : '');\n\n          if (timeoutOverride) {\n            timeout = timeoutOverride;\n            logger.log('Overriding Max Duration Time: ', timeout);\n          }\n\n          if (slotNameOverride) {\n            logger.log('Overriding Slot Name: ', slotNameOverride);\n            slotName = slotNameOverride;\n          }\n\n          var timeoutFunction = function timeoutFunction(resolve, reject) {\n            window.targetingTimeoutId = setTimeout(function () {\n              logger.log('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n              clearTimeout(window.targetingTimeoutId);\n              reject('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n            }, timeout);\n          };\n\n          var wrappedFunction = function wrappedFunction(resolve) {\n            window.A9VideoAPI._refreshedPreRollTargetingPromise = new Promise(function (resolve) {\n              window.apstag.fetchBids({\n                si_section: 'video',\n                slots: [{\n                  slotID: slotName,\n                  mediaType: 'video'\n                }],\n                timeout: defaultRefreshTimeout\n              }, resolve);\n            });\n\n            var innerFunction = function innerFunction(bids) {\n              clearTimeout(window.targetingTimeoutId);\n              var targetBid = {};\n              bids.forEach(function forEachBid(bid) {\n                if (bid.slotID === (slotNameOverride ? slotNameOverride : window.AdFuelUtils.isMobile.phone ? 'aps-midroll-mobile' : 'aps-midroll')) {\n                  targetBid = bid;\n                }\n              });\n              var result = {\n                'amznbid': targetBid.amznbid || '',\n                'amzniid': targetBid.amzniid || ''\n              };\n              logger.log('Returning Targeting: ', result);\n              resolve(result);\n            };\n\n            logger.log('Refreshing Video targeting...');\n\n            window.A9VideoAPI._refreshedPreRollTargetingPromise.then(innerFunction);\n          };\n\n          var wrappedCallback = new Promise(wrappedFunction);\n          var timeoutCallback = new Promise(timeoutFunction); // Returns a race between the timeout and the passed in promise\n\n          return Promise.race([timeoutCallback, wrappedCallback]);\n        }\n      }\n\n      function getMidRollTargetingData(timeout) {\n        if (blocked) {\n          return new Promise(function (resolve) {\n            resolve({\n              'amznbid': '',\n              'amzniid': ''\n            });\n          });\n        } else {\n          timeout = timeout || defaultRefreshTimeout;\n          var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n          var slotNameOverride = window.AdFuelUtils.getURLParam('slotname');\n          var slotName = 'aps-midroll' + (window.AdFuelUtils.isMobile.phone ? '-mobile' : '');\n\n          if (timeoutOverride) {\n            timeout = timeoutOverride;\n            logger.log('Overriding Max Duration Time: ', timeout);\n          }\n\n          if (slotNameOverride) {\n            logger.log('Overriding Slot Name: ', slotNameOverride);\n            slotName = slotNameOverride;\n          }\n\n          var timeoutFunction = function timeoutFunction(resolve, reject) {\n            window.targetingTimeoutId = setTimeout(function () {\n              logger.log('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n              clearTimeout(window.targetingTimeoutId);\n              reject('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n            }, timeout);\n          };\n\n          var wrappedFunction = function wrappedFunction(resolve) {\n            window.A9VideoAPI._midRollTargetingPromise = new Promise(function (resolve) {\n              window.apstag.fetchBids({\n                si_section: 'video',\n                slots: [{\n                  slotID: slotName,\n                  mediaType: 'video'\n                }],\n                timeout: defaultRefreshTimeout\n              }, resolve);\n            });\n\n            var innerFunction = function innerFunction(bids) {\n              clearTimeout(window.targetingTimeoutId);\n              var targetBid = {};\n              bids.forEach(function forEachBid(bid) {\n                if (bid.slotID === (slotNameOverride ? slotNameOverride : window.AdFuelUtils.isMobile.phone ? 'aps-midroll-mobile' : 'aps-midroll')) {\n                  targetBid = bid;\n                }\n              });\n              var result = {\n                'amznbid': targetBid.amznbid || '',\n                'amzniid': targetBid.amzniid || ''\n              };\n              logger.log('Returning Targeting: ', result);\n              resolve(result);\n            };\n\n            logger.log('Refreshing Video targeting...');\n\n            window.A9VideoAPI._midRollTargetingPromise.then(innerFunction);\n          };\n\n          var wrappedCallback = new Promise(wrappedFunction);\n          var timeoutCallback = new Promise(timeoutFunction); // Returns a race between the timeout and the passed in promise\n\n          return Promise.race([timeoutCallback, wrappedCallback]);\n        }\n      }\n\n      function getRefreshedMidRollTargetingData(timeout) {\n        if (blocked) {\n          return new Promise(function (resolve) {\n            resolve({\n              'amznbid': '',\n              'amzniid': ''\n            });\n          });\n        } else {\n          timeout = timeout || defaultRefreshTimeout;\n          var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n          var slotNameOverride = window.AdFuelUtils.getURLParam('slotname');\n          var slotName = 'aps-midroll' + (window.AdFuelUtils.isMobile.phone ? '-mobile' : '');\n\n          if (timeoutOverride) {\n            timeout = timeoutOverride;\n            logger.log('Overriding Max Duration Time: ', timeout);\n          }\n\n          if (slotNameOverride) {\n            logger.log('Overriding Slot Name: ', slotNameOverride);\n            slotName = slotNameOverride;\n          }\n\n          var timeoutFunction = function timeoutFunction(resolve, reject) {\n            window.targetingTimeoutId = setTimeout(function () {\n              logger.log('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n              clearTimeout(window.targetingTimeoutId);\n              reject('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n            }, timeout);\n          };\n\n          var wrappedFunction = function wrappedFunction(resolve) {\n            window.A9VideoAPI._refreshedMidRollTargetingPromise = new Promise(function (resolve) {\n              window.apstag.fetchBids({\n                si_section: 'video',\n                slots: [{\n                  slotID: slotName,\n                  mediaType: 'video'\n                }],\n                timeout: defaultRefreshTimeout\n              }, resolve);\n            });\n\n            var innerFunction = function innerFunction(bids) {\n              clearTimeout(window.targetingTimeoutId);\n              var targetBid = {};\n              bids.forEach(function forEachBid(bid) {\n                if (bid.slotID === (slotNameOverride ? slotNameOverride : window.AdFuelUtils.isMobile.phone ? 'aps-midroll-mobile' : 'aps-midroll')) {\n                  targetBid = bid;\n                }\n              });\n              var result = {\n                'amznbid': targetBid.amznbid || '',\n                'amzniid': targetBid.amzniid || ''\n              };\n              resolve(result);\n            };\n\n            logger.log('Refreshing Video targeting...');\n\n            window.A9VideoAPI._refreshedMidRollTargetingPromise.then(innerFunction);\n          };\n\n          var wrappedCallback = new Promise(wrappedFunction);\n          var timeoutCallback = new Promise(timeoutFunction); // Returns a race between the timeout and the passed in promise\n\n          return Promise.race([timeoutCallback, wrappedCallback]);\n        }\n      }\n\n      function keyGPTSlots(slots) {\n        return slots.reduce(function (o, slot) {\n          var slotId = slot.getSlotElementId();\n          o[slotId] = slot;\n          return o;\n        }, {});\n      }\n\n      function handleA9Bids(bids, gptSlots, done) {\n        logger.time('Handling Bids');\n        window.googletag.cmd.push(function () {\n          logger.log('Handling Bids:', bids, gptSlots);\n          var slots = keyGPTSlots(gptSlots);\n          var vendorData = {};\n          bids.forEach(function (bid) {\n            var gptSlot = slots[bid.slotID] || null;\n\n            if (gptSlot !== null) {\n              var targets = {};\n              window.apstag.targetingKeys('display').forEach(function (key) {\n                if (window.AdFuelUtils.getURLParam('debug') === 'true') {\n                  logger.log('[AdFuelModule - Amazon A9] Setting A9 Targeting: ', {\n                    key: key,\n                    value: bid[key]\n                  });\n                }\n\n                targets[key] = bid[key];\n                gptSlot.setTargeting(key, bid[key]);\n              });\n              vendorData[bid.slotId] = targets;\n            }\n          });\n          window.AdFuelUtils.metricApi.addMetric({\n            type: 'vendor',\n            id: 'Amazon A9',\n            data: vendorData\n          });\n          window.googletag.pubads().addEventListener('slotRenderEnded', function (e) {\n            var gptSlots = keyGPTSlots(window.googletag.pubads().getSlots());\n            var gptSlot = gptSlots[e.slot.getSlotElementId()];\n            window.apstag.targetingKeys('display').forEach(function (key) {\n              gptSlot.setTargeting(key, '');\n            });\n          });\n        });\n        logger.timeEnd('Handling Bids');\n        done();\n      }\n\n      function preQueueCallback(asset, done) {\n        if (asset.length > 0) {\n          var processBids = function processBids(bids) {\n            a9bids = bids;\n            done();\n          };\n\n          logger.time('Slot Building');\n          var si_section = '';\n\n          for (var x = 0; x < asset.length; x++) {\n            var slot = asset[x];\n\n            if (slot.monetization.isMonetized) {\n              if (si_section === '') {\n                var adUnitArray = slot.rktr_ad_id.split('/');\n\n                if (adUnitArray.length > 1 && adUnitArray[1] !== 'homepage') {\n                  si_section = adUnitArray[0] + (adUnitArray[1] ? '/' + adUnitArray[1] : '');\n                }\n              }\n\n              var obj = {\n                slotID: slot.rktr_slot_id,\n                sizes: slot.monetization.filteredSizes\n              };\n              logger.log('A9 Slot Object: ', obj);\n              bidSlots.push(obj);\n            }\n          }\n\n          logger.timeEnd('Slot Building');\n\n          if (bidSlots.length > 0) {\n            var a9Slots = window.AdFuelUtils.clone(bidSlots);\n            var fetchBidsConfig = {\n              slots: a9Slots,\n              timeout: window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.A9.MOBILE_DISPLAY_TIMEOUT || window.AdFuelOptions.A9.DISPLAY_TIMEOUT : window.AdFuelOptions.A9.DESKTOP_DISPLAY_TIMEOUT || window.AdFuelOptions.A9.DISPLAY_TIMEOUT\n            };\n\n            if (si_section !== '') {\n              fetchBidsConfig.si_section = si_section;\n            }\n\n            logger.log('Fetching Bids: ', fetchBidsConfig);\n            window.apstag.fetchBids(fetchBidsConfig, processBids);\n            refreshSlots = window.AdFuelUtils.clone(a9Slots);\n            bidSlots.length = 0;\n          } else {\n            logger.log('No valid slots.');\n          }\n        } else {\n          done();\n        }\n      }\n\n      function preDispatchCallback(asset, done) {\n        window.googletag.cmd.push(function () {\n          var gptSlots = window.googletag.pubads().getSlots();\n          if (a9bids) handleA9Bids(a9bids, gptSlots, done);\n\n          if (!a9bids) {\n            logger.log('No Bids.');\n            done();\n          }\n        });\n      }\n\n      function preRefreshCallback(asset, done) {\n        a9bids = null;\n        logger.time('Refreshing Bids');\n        var si_section = '';\n        asset.forEach(function (slot) {\n          if (si_section === '') {\n            var adUnitArray = slot.rktr_ad_id.split('/');\n            si_section = adUnitArray[0] + (adUnitArray[1] ? '/' + adUnitArray[1] : '');\n          }\n        });\n        var fetchBidsConfig = {\n          slots: refreshSlots,\n          timeout: window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.A9.MOBILE_DISPLAY_REFRESH_TIMEOUT || window.AdFuelOptions.A9.DISPLAY_REFRESH_TIMEOUT : window.AdFuelOptions.A9.DESKTOP_DISPLAY_REFRESH_TIMEOUT || window.AdFuelOptions.A9.DISPLAY_REFRESH_TIMEOUT\n        };\n\n        if (si_section !== '') {\n          fetchBidsConfig.si_section = si_section;\n        }\n\n        if (refreshSlots.length > 0) {\n          logger.log('Fetching Bids... ', fetchBidsConfig);\n          window.apstag.fetchBids(fetchBidsConfig, function (bids) {\n            a9bids = bids;\n            logger.timeEnd('Refreshing Bids');\n            var gptSlots = window.googletag.pubads().getSlots();\n            handleA9Bids(a9bids, gptSlots, done);\n          });\n        } else {\n          logger.log('No slots to refresh: ', asset, refreshSlots);\n          logger.timeEnd('Refreshing Bids');\n        }\n      }\n\n      function registerModuleWithAdFuel() {\n        if (!blocked) {\n          logger.log('Registering module with AdFuel');\n          window.AdFuel.registerModule(MODULE_NAME, {\n            preQueueCallback: preQueueCallback,\n            preDispatchCallback: preDispatchCallback,\n            preRefreshCallback: preRefreshCallback\n          }, MODULE_VERSION, window.AdFuelOptions.A9);\n        } else {\n          logger.log('A9 Module Registration is Blocked!', blocked);\n        }\n      }\n\n      function configureA9Library() {\n        window.AdFuelOptions.GDPR.APPLIES.then(function (gdprApplies) {\n          var consentGranted = window.AdFuelUtils.getConsent();\n          logger.log('Exposing AdFuelVideoAPI.A9 and A9VideoAPI');\n          window.AdFuelVideoAPI = window.AdFuelVideoAPI || {};\n          window.AdFuelVideoAPI.A9 = window.A9VideoAPI = {\n            getTargetingData: getTargetingData,\n            getRefreshedTargetingData: getRefreshedTargetingData,\n            getPreRollTargetingData: getPreRollTargetingData,\n            getMidRollTargetingData: getMidRollTargetingData,\n            getRefreshedPreRollTargetingData: getRefreshedPreRollTargetingData,\n            getRefreshedMidRollTargetingData: getRefreshedMidRollTargetingData,\n            __VERSION__: MODULE_VERSION\n          };\n          var pubId = window.AdFuelOptions.A9.DOM_PUB_ID;\n\n          if (window.AdFuelUtils.isIntl) {\n            pubId = window.AdFuelOptions.A9.INTL_PUB_ID;\n          }\n\n          logger.log('Final Pub ID: ', pubId);\n          var bidTimeout = window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.A9.MOBILE_VIDEO_TIMEOUT || window.AdFuelOptions.A9.VIDEO_TIMEOUT : window.AdFuelOptions.A9.DESKTOP_VIDEO_TIMEOUT || window.AdFuelOptions.A9.VIDEO_TIMEOUT;\n          var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n\n          if (timeoutOverride) {\n            bidTimeout = timeoutOverride;\n            logger.log('Overriding Max Duration Time: ', bidTimeout);\n          }\n\n          var slotName = window.AdFuelUtils.isMobile.phone ? 'aps-preroll-mobile' : 'aps-preroll';\n          var slotNameOverride = window.AdFuelUtils.getURLParam('slotname');\n\n          if (slotNameOverride) {\n            slotName = slotNameOverride;\n            logger.log('Overriding Slot Name: ', slotName);\n          }\n\n          var a9Config = {\n            pubID: pubId,\n            adServer: 'googletag',\n            videoAdServer: 'freeWheel'\n          };\n\n          if (consentGranted || !gdprApplies) {\n            var consent = window.AdFuelUtils.getConsentString();\n            a9Config.gdpr = {\n              enabled: true,\n              consent: consent\n            };\n            !function (a9, a, p, s, t, A, g) {\n              if (a[a9]) return;\n\n              function q(c, r) {\n                a[a9]._Q.push([c, r]);\n              }\n\n              a[a9] = {\n                init: function init() {\n                  q('i', arguments);\n                },\n                fetchBids: function fetchBids() {\n                  q('f', arguments);\n                },\n                _Q: []\n              };\n              A = p.createElement(s);\n              A.async = !0;\n              A.src = t;\n              g = p.getElementsByTagName(s)[0];\n              g.parentNode.insertBefore(A, g);\n            }('apstag', window, document, 'script', '//c.amazon-adsystem.com/aax2/apstag.js');\n            window.apstag.init(a9Config);\n            window.A9VideoAPI._preRollTargetingPromise = window.A9VideoAPI._targetingPromise = new Promise(function (resolve) {\n              window.apstag.fetchBids({\n                si_section: 'video',\n                slots: [{\n                  slotID: slotName,\n                  mediaType: 'video'\n                }],\n                timeout: bidTimeout\n              }, resolve);\n            });\n\n            if (window.AdFuel && window.AdFuel.cmd) {\n              //AdFuel loaded first\n              window.AdFuel.cmd.push(registerModuleWithAdFuel);\n            } else if (window.AdFuel) {\n              registerModuleWithAdFuel();\n            } else {\n              //wait for AdFuel to load\n              window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n            }\n          } else {\n            logger.log('A9 is blocked due to GDPR restrictions.');\n            blocked = true;\n          }\n        });\n      }\n\n      function init() {\n        logger.log('Initializing Module...');\n        configureA9Library();\n      }\n\n      init();\n    })();\n  }\n\n  if (CNN.Features.enablePrebid === true) {\n    /*\n        Prebid Module - Version 3.2.0\n        - 3.2.0: Addition of Native Bidding\n        - 3.2.1: Fix for GDPR on CNN\n    */\n    (function createPrebidAdFuelModule() {\n      'use strict';\n\n      var MODULE_NAME = 'Prebid Module';\n      var MODULE_VERSION = 'v3.2.1';\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'prebid', 'color: #58f53f; padding: 2px');\n      var isIntl = window.AdFuelUtils.isIntl || false;\n      var cdnRoot = window.AdFuelUtils.cdnRoot || 'i.cdn.turner.com';\n      var PREBID_TIMEOUT = window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.PREBID.MOBILE_TIMEOUT || window.AdFuelOptions.PREBID.TIMEOUT : window.AdFuelOptions.PREBID.DESKTOP_TIMEOUT || window.AdFuelOptions.PREBID.TIMEOUT;\n      var PREBID_VIDEO_TIMEOUT = 500;\n      var PREBID_VIDEO_REFRESH_TIMEOUT = 1000;\n      var DOM_BIDDERS = window.AdFuelOptions.PREBID.DOM_BIDDERS;\n      var INTL_BIDDERS = window.AdFuelOptions.PREBID.INTL_BIDDERS;\n      var NATIVE_BIDDERS = window.AdFuelOptions.PREBID.NATIVE_BIDDERS || [];\n      var DOM_ACCOUNT_IDS = window.AdFuelOptions.PREBID.DOM_ACCOUNT_IDS;\n      var INTL_ACCOUNT_IDS = window.AdFuelOptions.PREBID.INTL_ACCOUNT_IDS;\n      var RUBICON_ACCOUNT_ID = isIntl ? INTL_ACCOUNT_IDS.rubicon : DOM_ACCOUNT_IDS.rubicon;\n      var APPNEXUS_ACCOUNT_ID = isIntl ? INTL_ACCOUNT_IDS.appnexus : DOM_ACCOUNT_IDS.appnexus;\n      var PANGAEA_ACCOUNT_ID = isIntl ? INTL_ACCOUNT_IDS.pangaea : '';\n      var RUBICON_DOM_DESKTOP_SITE_ID = window.AdFuelOptions.PREBID.RUBICON_DOM_DESKTOP_SITE_ID;\n      var RUBICON_INTL_DESKTOP_SITE_ID = window.AdFuelOptions.PREBID.RUBICON_INTL_DESKTOP_SITE_ID;\n      var RUBICON_DOM_MOBILE_SITE_ID = window.AdFuelOptions.PREBID.RUBICON_DOM_MOBILE_SITE_ID;\n      var RUBICON_INTL_MOBILE_SITE_ID = window.AdFuelOptions.PREBID.RUBICON_INTL_MOBILE_SITE_ID;\n      var RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING = window.AdFuelOptions.PREBID.RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING;\n      var RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING = window.AdFuelOptions.PREBID.RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING;\n      var RUBICON_DOM_MOBILE_ZONE_MAPPING = window.AdFuelOptions.PREBID.RUBICON_DOM_MOBILE_ZONE_MAPPING;\n      var RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING = window.AdFuelOptions.PREBID.RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING;\n      var RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING = window.AdFuelOptions.PREBID.RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING;\n      var RUBICON_INTL_MOBILE_ZONE_MAPPING = window.AdFuelOptions.PREBID.RUBICON_INTL_MOBILE_ZONE_MAPPING;\n      var RUBICON_SIZE_MAPPING = {\n        '728x90': 2,\n        '160x600': 9,\n        '300x600': 10,\n        '300x250': 15,\n        '320x50': 43,\n        '970x90': 55,\n        '970x250': 57\n      };\n      var PREBID_VIDEO_TARGETING = {\n        hb_uuid: '',\n        hb_bidder: '',\n        hb_adid: '',\n        hb_pb: '',\n        hb_size: '',\n        hb_source: ''\n      };\n      var PREBID_VIDEO_REFRESHED_TARGETING = {\n        hb_uuid: '',\n        hb_bidder: '',\n        hb_adid: '',\n        hb_pb: '',\n        hb_size: '',\n        hb_source: ''\n      };\n      window.pbjs = window.pbjs || {};\n      window.pbjs.que = window.pbjs.que || [];\n\n      function getVideoBids() {\n        return new Promise(function (resolve) {\n          logger.log(\"Building Video AdUnit...\");\n          var videoBid = {\n            code: 'video1',\n            mediaTypes: {\n              video: {\n                context: 'instream',\n                playerSize: [640, 480]\n              }\n            },\n            bids: [{\n              bidder: 'appnexus',\n              params: {\n                invCode: 'cnn_homepage_video1',\n                member: APPNEXUS_ACCOUNT_ID,\n                video: {\n                  skippable: true,\n                  playback_methods: ['auto_play_sound_off']\n                }\n              }\n            }]\n          };\n          logger.log(\"Adding Video AdUnit: \", videoBid);\n          window.pbjs.que.push(function () {\n            window.pbjs.addAdUnits(videoBid);\n            logger.log('Requesting Video Bids...', videoBid);\n\n            var videoBidsBackHandler = function videoBidsBackHandler(bids) {\n              var uuid = '';\n              logger.log('Removing Video Ad Unit: ', videoBid);\n              window.pbjs.removeAdUnit('video1');\n\n              try {\n                var highestCmpBids = window.pbjs.getHighestCpmBids(['video1']);\n\n                if (highestCmpBids.length > 0) {\n                  logger.log('Found highest cmp bid for \\'video\\'...');\n                  var targetBid = highestCmpBids[0];\n\n                  if (targetBid.videoCacheKey) {\n                    logger.log('Returning Video Cache Key...');\n                    uuid = targetBid.videoCacheKey;\n                  }\n                }\n              } catch (err) {\n                logger.warn('Could not get highest cmp bid for \\'video1\\'...', err);\n              }\n\n              if (Object.keys(bids).length > 0) {\n                logger.log('Received Bids...');\n                PREBID_VIDEO_TARGETING = window.pbjs.getAdserverTargeting().video1;\n                PREBID_VIDEO_TARGETING.hb_uuid = uuid;\n              }\n\n              resolve(PREBID_VIDEO_TARGETING);\n            };\n\n            window.pbjs.requestBids({\n              bidsBackHandler: videoBidsBackHandler,\n              timeout: PREBID_VIDEO_TIMEOUT\n            });\n            logger.log('Removing Video Ad Unit: ', videoBid);\n            window.pbjs.removeAdUnit('video1');\n          });\n        });\n      }\n\n      function getRefreshedVideoBids() {\n        return new Promise(function (resolve) {\n          logger.log(\"Building Video AdUnit...\");\n          var videoBid = {\n            code: 'video1',\n            mediaTypes: {\n              video: {\n                context: 'instream',\n                playerSize: [640, 480]\n              }\n            },\n            bids: [{\n              bidder: 'appnexus',\n              params: {\n                invCode: 'cnn_homepage_video1',\n                member: APPNEXUS_ACCOUNT_ID,\n                video: {\n                  skippable: true,\n                  playback_methods: ['auto_play_sound_off']\n                }\n              }\n            }]\n          };\n          logger.log(\"Adding Video AdUnit: \", videoBid);\n          window.pbjs.que.push(function () {\n            window.pbjs.addAdUnits(videoBid);\n            logger.log('Requesting Video Bids...', videoBid);\n\n            var videoBidsBackHandler = function videoBidsBackHandler(bids) {\n              var uuid = '';\n              logger.log('Removing Video Ad Unit: ', videoBid);\n              window.pbjs.removeAdUnit('video1');\n\n              try {\n                var highestCmpBids = window.pbjs.getHighestCpmBids(['video1']);\n\n                if (highestCmpBids.length > 0) {\n                  logger.log('Found highest cmp bid for \\'video\\'...');\n                  var targetBid = highestCmpBids[0];\n\n                  if (targetBid.videoCacheKey) {\n                    logger.log('Returning Video Cache Key...');\n                    uuid = targetBid.videoCacheKey;\n                  }\n                }\n              } catch (err) {\n                logger.warn('Could not get highest cmp bid for \\'video1\\'...', err);\n              }\n\n              if (Object.keys(bids).length > 0) {\n                logger.log('Received Bids...');\n                PREBID_VIDEO_REFRESHED_TARGETING = window.pbjs.getAdserverTargeting().video1;\n                PREBID_VIDEO_REFRESHED_TARGETING.hb_uuid = uuid;\n              }\n\n              resolve(PREBID_VIDEO_REFRESHED_TARGETING);\n            };\n\n            window.pbjs.requestBids({\n              bidsBackHandler: videoBidsBackHandler,\n              timeout: PREBID_VIDEO_REFRESH_TIMEOUT\n            });\n            logger.log('Removing Video Ad Unit: ', videoBid);\n            window.pbjs.removeAdUnit('video1');\n          });\n        });\n      }\n\n      function buildPrebidAdUnits(asset) {\n        logger.time('AdUnit Building');\n        var nativeAdUnits = [];\n        var bannerAdUnits = [];\n\n        for (var x = 0; x < asset.length; x++) {\n          var invCodeArray = asset[x].rktr_ad_id.split('/');\n          var pos = asset[x].targeting.filter(function filterFunction(target) {\n            return true;\n          })[0][1][0];\n          logger.log('Pos: ', pos);\n          var invCode = invCodeArray[0].toLowerCase() + (invCodeArray[1] ? '_' + invCodeArray[1].toLowerCase() : '');\n          var nativeAdUnitMock = {\n            code: '',\n            mediaTypes: {\n              native: {\n                title: {\n                  required: true,\n                  len: 80\n                },\n                body: {\n                  required: true\n                },\n                image: {\n                  required: true\n                },\n                sponsoredBy: {\n                  required: true\n                },\n                clickUrl: {\n                  required: true\n                },\n                icon: {\n                  required: true\n                },\n                cta: {\n                  required: false\n                }\n              },\n              banner: {\n                sizes: []\n              }\n            },\n            bids: []\n          };\n          var bannerAdUnitMock = {\n            code: '',\n            mediaTypes: {\n              banner: {\n                sizes: []\n              }\n            },\n            bids: []\n          };\n          var bidMocks = {\n            rubicon: {\n              bidder: 'rubicon',\n              // Fastlane (US and EU) and AppNexus (EU ONLY)\n              params: {\n                accountId: RUBICON_ACCOUNT_ID,\n                // Toggle based on location\n                siteId: 26792,\n                // Get From Mapping\n                zoneId: 231942,\n                // Get From Mapping\n                position: \"btf\" // Parse from Div Id\n\n              }\n            },\n            appnexus: {\n              bidder: 'appnexus',\n              params: {\n                invCode: invCode,\n                // Optional - Supplied from AppNexus\n                member: APPNEXUS_ACCOUNT_ID // Optional - Supplied from AppNexus\n\n              }\n            },\n            pangaea: {\n              bidder: 'pangaea',\n              params: {\n                invCode: invCode,\n                member: PANGAEA_ACCOUNT_ID\n              }\n            }\n          };\n          logger.log('Checking slot and sizes for validity: ', asset[x].rktr_slot_id || 'N/A');\n\n          if (asset[x].monetization.isMonetized) {\n            var buildBidsForAdUnitMock = function buildBidsForAdUnitMock() {\n              var BIDDERS = isIntl ? INTL_BIDDERS : DOM_BIDDERS;\n\n              for (var bIndex = 0; bIndex < BIDDERS.length; bIndex++) {\n                var bidder = BIDDERS[bIndex];\n                var nativeBidMock = Object.assign({}, bidMocks[bidder]);\n                var bannerBidMock = Object.assign({}, bidMocks[bidder]);\n                logger.log('starting Banner bidMock: ', JSON.parse(JSON.stringify(bannerBidMock)));\n                logger.log('starting Native bidMock: ', JSON.parse(JSON.stringify(nativeBidMock)));\n                if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeAdUnitMock.code = asset[x].originalElementId || asset[x].rktr_slot_id;\n                bannerAdUnitMock.code = asset[x].originalElementId || asset[x].rktr_slot_id;\n                if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeAdUnitMock.mediaTypes.banner.sizes = asset[x].sizes;\n\n                switch (bidder) {\n                  case 'appnexus':\n                    bannerBidMock.params.invCode = invCode + '_' + posValue;\n                    if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeBidMock.params.invCode = invCode + '_' + posValue;\n                    break;\n\n                  case 'pangaea':\n                    bannerBidMock.params.invCode = invCode + '_' + posValue;\n                    if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeBidMock.params.invCode = invCode + '_' + posValue;\n                    break;\n\n                  case 'rubicon':\n                    bannerBidMock.params.siteId = isIntl ? window.AdFuelUtils.isMobile.any ? RUBICON_INTL_MOBILE_SITE_ID : RUBICON_INTL_DESKTOP_SITE_ID : window.AdFuelUtils.isMobile.any ? RUBICON_DOM_MOBILE_SITE_ID : RUBICON_DOM_DESKTOP_SITE_ID;\n                    if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeBidMock.params.siteId = isIntl ? window.AdFuelUtils.isMobile.any ? RUBICON_INTL_MOBILE_SITE_ID : RUBICON_INTL_DESKTOP_SITE_ID : window.AdFuelUtils.isMobile.any ? RUBICON_DOM_MOBILE_SITE_ID : RUBICON_DOM_DESKTOP_SITE_ID;\n\n                    if (window.AdFuelUtils.isMobile.any) {\n                      bannerBidMock.params.zoneId = isIntl ? RUBICON_INTL_MOBILE_ZONE_MAPPING[position] ? RUBICON_INTL_MOBILE_ZONE_MAPPING[position] : RUBICON_INTL_MOBILE_ZONE_MAPPING : RUBICON_DOM_MOBILE_ZONE_MAPPING[position] ? RUBICON_DOM_MOBILE_ZONE_MAPPING[position] : RUBICON_DOM_MOBILE_ZONE_MAPPING;\n                      if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeBidMock.params.zoneId = isIntl ? RUBICON_INTL_MOBILE_ZONE_MAPPING[position] ? RUBICON_INTL_MOBILE_ZONE_MAPPING[position] : RUBICON_INTL_MOBILE_ZONE_MAPPING : RUBICON_DOM_MOBILE_ZONE_MAPPING[position] ? RUBICON_DOM_MOBILE_ZONE_MAPPING[position] : RUBICON_DOM_MOBILE_ZONE_MAPPING;\n                    } else {\n                      if (isHomepage) {\n                        bannerBidMock.params.zoneId = isIntl ? RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING[position] ? RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING[position] : RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING : RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING[position] ? RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING[position] : RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING;\n                        if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeBidMock.params.zoneId = isIntl ? RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING[position] ? RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING[position] : RUBICON_INTL_DESKTOP_HP_ZONE_MAPPING : RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING[position] ? RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING[position] : RUBICON_DOM_DESKTOP_HP_ZONE_MAPPING;\n                      } else {\n                        bannerBidMock.params.zoneId = isIntl ? RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING[position] ? RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING[position] : RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING : RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING[position] ? RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING[position] : RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING;\n                        if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeBidMock.params.zoneId = isIntl ? RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING[position] ? RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING[position] : RUBICON_INTL_DESKTOP_ROS_ZONE_MAPPING : RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING[position] ? RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING[position] : RUBICON_DOM_DESKTOP_ROS_ZONE_MAPPING;\n                      }\n                    }\n\n                    bannerBidMock.params.position = position;\n                    bannerBidMock.params.sizes = sizeMapArray;\n                    if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeBidMock.params.position = position;\n                    if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeBidMock.params.sizes = sizeMapArray;\n                    break;\n\n                  default:\n                    break;\n                }\n\n                logger.log('ending Banner bidMock: ', JSON.parse(JSON.stringify(bannerBidMock)));\n                logger.log('ending Native bidMock: ', JSON.parse(JSON.stringify(nativeBidMock)));\n                bannerAdUnitMock.bids.push(bannerBidMock);\n                if (NATIVE_BIDDERS.indexOf(bidder) >= 0) nativeAdUnitMock.bids.push(nativeBidMock);\n              }\n            };\n\n            var sizeMapArray = [];\n\n            for (var sIndex = 0; sIndex < asset[x].monetization.filteredSizes.length; sIndex++) {\n              sizeMapArray.push(RUBICON_SIZE_MAPPING[asset[x].monetization.filteredSizes[sIndex].join('x')]);\n            }\n\n            var posValue = '';\n            var position = 'atf';\n            var slotTargets = asset[x].targeting || [];\n\n            for (var tIndex = 0; tIndex < slotTargets.length; tIndex++) {\n              var target = slotTargets[tIndex];\n\n              if (target[0] === 'pos') {\n                if (Array.isArray(target[1])) {\n                  logger.log('Setting POS for ' + asset[x].rktr_slot_id, target[1][0]);\n                  posValue = target[1][0];\n                  position = target[1][0].split('_')[1];\n                } else {\n                  logger.log('Setting POS for ' + asset[x].rktr_slot_id, target[1]);\n                  posValue = target[1];\n                  position = target[1].split('_')[1];\n                }\n              }\n            }\n\n            var isHomepage = asset[x].rktr_ad_id.indexOf('/homepage') >= 0 || asset[x].rktr_ad_id.indexOf('/business/landing') >= 0;\n            logger.log('Starting Banner AdUnitMock: ', JSON.parse(JSON.stringify(bannerAdUnitMock)));\n            logger.log('Starting Native AdUnitMock: ', JSON.parse(JSON.stringify(nativeAdUnitMock)));\n            bannerAdUnitMock.code = asset[x].originalElementId || asset[x].rktr_slot_id;\n            bannerAdUnitMock.mediaTypes.banner.sizes = asset[x].monetization.filteredSizes;\n            buildBidsForAdUnitMock(isIntl);\n            logger.log('Ending Banner AdUnitMock: ', JSON.parse(JSON.stringify(bannerAdUnitMock)));\n            logger.log('Ending Native AdUnitMock: ', JSON.parse(JSON.stringify(nativeAdUnitMock)));\n            bannerAdUnits.push(bannerAdUnitMock);\n            nativeAdUnits.push(nativeAdUnitMock);\n          }\n        }\n\n        logger.timeEnd('AdUnit Building');\n        logger.log(\"Final Ad Units: \", JSON.parse(JSON.stringify({\n          native: nativeAdUnits,\n          banner: bannerAdUnits\n        })));\n        return {\n          native: nativeAdUnits,\n          banner: bannerAdUnits\n        };\n      }\n\n      function preQueueCallback(asset, done) {\n        if (asset.length > 0) {\n          var pbQueueFunction = function pbQueueFunction() {\n            var callbackExecuted = false;\n\n            if (adUnits.banner.length > 0) {\n              logger.log(\"Adding Banner Ad Units...\", JSON.parse(JSON.stringify(adUnits.banner)));\n              window.pbjs.addAdUnits(adUnits.banner);\n            }\n\n            if (adUnits.native.length > 0) {\n              logger.log(\"Adding Native Ad Units...\", JSON.parse(JSON.stringify(adUnits.native)));\n              window.pbjs.addAdUnits(adUnits.native);\n            }\n\n            logger.log(\"Requesting Bids...\");\n            logger.time('Requesting Bids...');\n\n            var bidsBackHandlerFunc = function bidsBackHandlerFunc(bids) {\n              var ast = window.pbjs.getAdserverTargeting();\n              logger.log(\"Display Bids: \", bids, ast);\n              logger.timeEnd('Requesting Bids...');\n              clearTimeout(window.fallbackTimeout);\n\n              if (!callbackExecuted) {\n                done();\n                callbackExecuted = true;\n              }\n            };\n\n            window.pbjs.aliasBidder('appnexus', 'pangaea');\n\n            if (adUnits.banner.length > 0 || adUnits.native.length > 0) {\n              window.pbjs.requestBids({\n                bidsBackHandler: bidsBackHandlerFunc\n              });\n\n              for (var i = 0; i < adUnits.banner.length; i++) {\n                logger.log('Removing Banner Ad Unit: ', adUnits.banner[i].code);\n                window.pbjs.removeAdUnit(adUnits.banner[i].code);\n              }\n\n              ;\n\n              for (var i = 0; i < adUnits.native.length; i++) {\n                logger.log('Removing Native Ad Unit: ', adUnits.native[i].code);\n                window.pbjs.removeAdUnit(adUnits.native[i].code);\n              }\n\n              ;\n              window.fallbackTimeout = setTimeout(function () {\n                logger.log(\"Timed out...\");\n                clearTimeout(window.fallbackTimeout);\n\n                if (!callbackExecuted) {\n                  done();\n                  callbackExecuted = true;\n                }\n              }, PREBID_TIMEOUT);\n              adUnits.banner.length = 0;\n              adUnits.native.length = 0;\n            }\n          };\n\n          var adUnits = buildPrebidAdUnits(asset);\n          window.pbjs.que.push(pbQueueFunction);\n        } else {\n          done();\n        }\n      }\n\n      function preDispatchCallback(asset, done) {\n        logger.log(\"Setting Targeting...\");\n\n        function innerFunc() {\n          logger.log(\"Page Slots: \", Object.keys(window.AdFuel.pageSlots));\n          window.pbjs.que.push(function () {\n            window.pbjs.setTargetingForGPTAsync(Object.keys(window.AdFuel.pageSlots));\n          });\n          done();\n        }\n\n        window.googletag.cmd.push(innerFunc);\n      }\n\n      function preRefreshCallback(asset, done) {\n        Object.keys(window.AdFuel.pageSlots).forEach(function (pageSlot) {\n          window.pbjs.que.push(function () {\n            logger.log('Removing Ad Unit: ', pageSlot);\n            window.pbjs.removeAdUnit(pageSlot);\n          });\n        });\n\n        if (asset.length > 0) {\n          var pbQueueFunction = function pbQueueFunction() {\n            if (adUnits.length > 0) {\n              var callbackExecuted = false;\n              logger.log(\"Adding Ad Units...\", JSON.parse(JSON.stringify(adUnits)));\n              window.pbjs.addAdUnits(adUnits);\n              logger.log(\"Requesting Bids...\");\n              logger.time('Requesting Bids...');\n\n              var bidsBackHandlerFunc = function bidsBackHandlerFunc(bids) {\n                var ast = window.pbjs.getAdserverTargeting();\n                logger.log(\"Display Bids: \", bids, ast);\n                logger.timeEnd('Requesting Bids...');\n                clearTimeout(window.fallbackTimeout);\n\n                if (!callbackExecuted) {\n                  done();\n                  callbackExecuted = true;\n                }\n              };\n\n              window.pbjs.aliasBidder('appnexus', 'pangaea');\n              window.pbjs.requestBids({\n                bidsBackHandler: bidsBackHandlerFunc\n              });\n\n              for (var i = 0; i < adUnits.length; i++) {\n                logger.log('Removing Ad Unit: ', adUnits[i].code);\n                window.pbjs.removeAdUnit(adUnits[i].code);\n              }\n\n              ;\n              window.fallbackTimeout = setTimeout(function () {\n                logger.log(\"Timed out...\");\n                clearTimeout(window.fallbackTimeout);\n\n                if (!callbackExecuted) {\n                  done();\n                  callbackExecuted = true;\n                }\n              }, PREBID_TIMEOUT);\n              adUnits.length = 0;\n            }\n          };\n\n          var adUnits = buildPrebidAdUnits(asset);\n          logger.log('Pre-Refresh Asset: ', asset);\n          var refreshedPageSlots = asset.map(function (pageSlot) {\n            logger.log('Page Slot: ', pageSlot, pageSlot.rktr_slot_id);\n            return pageSlot.rktr_slot_id;\n          });\n          logger.log('Refreshed Page Slots: ', refreshedPageSlots);\n          window.pbjs.que.push(pbQueueFunction);\n          window.pbjs.que.push(function () {\n            window.pbjs.setTargetingForGPTAsync(Object.keys(window.AdFuel.pageSlots));\n          });\n          done();\n        } else {\n          done();\n        }\n      }\n\n      function setGeoTargeting(forceIntl) {\n        logger.log(\"Setting GeoTargeting... \", window.AdFuelUtils.countryCode);\n\n        function setGeoTarget() {\n          if (window.AdFuelUtils.isIntl) {\n            logger.log('Setting Geo Target: EU');\n            window.AdFuel.addPageLevelTarget('hbg', 'EU');\n          } else if (forceIntl) {\n            logger.log('Setting Geo Target: EU');\n            window.AdFuel.addPageLevelTarget('hbg', 'EU');\n          } else {\n            logger.log('Setting Geo Target: US');\n            window.AdFuel.addPageLevelTarget('hbg', 'US');\n          }\n        }\n\n        window.googletag.cmd.push(setGeoTarget);\n      }\n\n      function registerModuleWithAdFuel() {\n        logger.log('Registering ' + MODULE_NAME + ' module with AdFuel');\n        window.AdFuel.setOptions({\n          queueCallbackTimeoutInMilliseconds: PREBID_TIMEOUT\n        });\n        window.AdFuel.registerModule(MODULE_NAME, {\n          preQueueCallback: preQueueCallback,\n          preDispatchCallback: preDispatchCallback,\n          preRefreshCallback: preRefreshCallback\n        }, MODULE_VERSION, window.AdFuelOptions.PREBID);\n      }\n\n      function configurePrebidLibrary() {\n        var priceBuckets = {\n          buckets: [{\n            'precision': 2,\n            'min': 0,\n            'max': 5,\n            'increment': 0.01\n          }, {\n            'precision': 2,\n            'min': 5,\n            'max': 30,\n            'increment': 0.05\n          }, {\n            'precision': 2,\n            'min': 30,\n            'max': 50,\n            'increment': 1.00\n          }]\n        };\n        var sendAllBids = true; //isIntl ? false : true;\n\n        var innerFunc = function innerFunc() {\n          var prebidConfig = {\n            priceGranularity: priceBuckets,\n            debug: false,\n            enableSendAllBids: sendAllBids,\n            bidderTimeout: PREBID_TIMEOUT,\n            cache: {\n              url: 'https://prebid.adnxs.com/pbc/v1/cache'\n            }\n          };\n          window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n            if (applies) {\n              logger.log('Setting consentManagement config...');\n              if (!window.CNN || !window.CNN.UserConsent) prebidConfig.consentManagement = {\n                cmpApi: 'iab',\n                timeout: 100,\n                allowAuctionWithoutConsent: false\n              };\n            }\n\n            ;\n            logger.log(\"Setting config...\", prebidConfig);\n            window.pbjs.setConfig(prebidConfig);\n\n            if (!isIntl) {\n              window.pbjs.bidderSettings = {\n                rubicon: {\n                  alwaysUseBid: true,\n                  adserverTargeting: [{\n                    key: \"hb_db_rubicon\",\n                    val: function val(bidResponse) {\n                      var keyvalue;\n\n                      if (bidResponse.adserverTargeting && bidResponse.adserverTargeting['rpfl_' + (isIntl ? INTL_ACCOUNT_IDS['rubicon'] : DOM_ACCOUNT_IDS['rubicon'])]) {\n                        keyvalue = bidResponse.adserverTargeting['rpfl_' + (isIntl ? INTL_ACCOUNT_IDS['rubicon'] : DOM_ACCOUNT_IDS['rubicon'])];\n                      } else if (bidResponse.rubiconTargeting && bidResponse.rubiconTargeting['rpfl_' + (isIntl ? INTL_ACCOUNT_IDS['rubicon'] : DOM_ACCOUNT_IDS['rubicon'])]) {\n                        keyvalue = bidResponse.rubiconTargeting['rpfl_' + (isIntl ? INTL_ACCOUNT_IDS['rubicon'] : DOM_ACCOUNT_IDS['rubicon'])];\n                      } else {\n                        return;\n                      }\n\n                      var deal_tier = keyvalue.substring(keyvalue.indexOf('_') + 1);\n                      return deal_tier;\n                    }\n                  }]\n                }\n              };\n            }\n\n            setGeoTargeting();\n          });\n        };\n\n        window.pbjs.que.push(innerFunc);\n        window.AdFuelVideoAPI = window.AdFuelVideoAPI || {};\n        window.AdFuelVideoAPI.Prebid = window.PrebidVideoAPI = {\n          getTargetingData: function getTargetingData() {\n            window.PrebidVideoAPI._targetingPromise = new Promise(function (resolve) {\n              getVideoBids().then(function () {\n                resolve(PREBID_VIDEO_TARGETING);\n              });\n            });\n            return window.PrebidVideoAPI._targetingPromise;\n          },\n          getRefreshedTargetingData: function getRefreshedTargetingData() {\n            window.PrebidVideoAPI._refreshedTargetingPromise = new Promise(function (resolve) {\n              getRefreshedVideoBids().then(function () {\n                resolve(PREBID_VIDEO_TARGETING);\n              });\n            });\n            return window.PrebidVideoAPI._refreshedTargetingPromise;\n          },\n          getPreRollTargetingData: function getPreRollTargetingData() {\n            window.PrebidVideoAPI._preRollTargetingPromise = new Promise(function (resolve) {\n              getVideoBids().then(function () {\n                resolve(PREBID_VIDEO_TARGETING);\n              });\n            });\n            return window.PrebidVideoAPI._preRollTargetingPromise;\n          },\n          getMidRollTargetingData: function getMidRollTargetingData() {\n            window.PrebidVideoAPI._midRollTargetingPromise = new Promise(function (resolve) {\n              getRefreshedVideoBids().then(function () {\n                resolve(PREBID_VIDEO_TARGETING);\n              });\n            });\n            return window.PrebidVideoAPI._midRollTargetingPromise;\n          },\n          getRefreshedPreRollTargetingData: function getRefreshedPreRollTargetingData() {\n            window.PrebidVideoAPI._refreshedPreRollTargetingPromise = new Promise(function (resolve) {\n              getRefreshedVideoBids().then(function () {\n                resolve(PREBID_VIDEO_TARGETING);\n              });\n            });\n            return window.PrebidVideoAPI._refreshedPreRollTargetingPromise;\n          },\n          getRefreshedMidRollTargetingData: function getRefreshedMidRollTargetingData() {\n            window.PrebidVideoAPI._refreshedMidRollTargetingPromise = new Promise(function (resolve) {\n              getRefreshedVideoBids().then(function () {\n                resolve(PREBID_VIDEO_TARGETING);\n              });\n            });\n            return window.PrebidVideoAPI._refreshedMidRollTargetingPromise;\n          },\n          __VERSION__: MODULE_VERSION\n        };\n\n        if (!document.getElementById('PrebidScript')) {\n          var a = document;\n          var b = a.createElement('script');\n          var c = a.getElementsByTagName('script')[0];\n          var d = 'https:' === document.location.protocol;\n          b.type = 'text/javascript';\n          b.id = \"PrebidScript\";\n          b.src = '//' + cdnRoot + '/ads/adfuel/modules/prebid-1.32.0.js';\n          c.parentNode.insertBefore(b, c);\n        }\n\n        var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n\n        if (timeoutOverride) {\n          PREBID_TIMEOUT = timeoutOverride;\n          logger.log('Overriding Max Duration Time: ', PREBID_TIMEOUT);\n        }\n      }\n\n      function init() {\n        configurePrebidLibrary();\n\n        if (window.AdFuel && window.AdFuel.cmd) {\n          //AdFuel loaded first\n          window.AdFuel.cmd.push(registerModuleWithAdFuel);\n        } else if (window.AdFuel) {\n          registerModuleWithAdFuel();\n        } else {\n          window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n        }\n      }\n\n      logger.log('Initializing Module...');\n      init();\n    })();\n  }\n\n  (function createGUIDModule() {\n    var MODULE_NAME = 'Turner GUID Module';\n    var MODULE_VERSION = 'v3.1.1'; // Stub out AdFuelUtils in case it's not on the page.\n\n    window.AdFuelUtils = window.AdFuelUtils || {\n      addEvent: function addEvent() {},\n      getLogger: function getLogger() {},\n      readCookie: function readCookie() {}\n    }; // Stub out AdFuelOptions in case it's not on the page.\n\n    window.AdFuelOptions = window.AdFuelOptions || {};\n    window.AdFuelOptions.GUID = window.AdFuelOptions.GUID || {};\n    var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'guid', 'color: #d2b000; padding: 2px');\n    var enableGuid = true;\n    window.AdFuelOptions.GDPR ? window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n      if (applies && !window.AdFuelUtils.getConsent()) {\n        logger.log('Disabling GUID due to GDPR restrictions.');\n        enableGuid = false;\n      }\n\n      if (enableGuid) {\n        var processCookie = function processCookie() {\n          if (window) {\n            window.turner_getGuid = t_getGuid;\n          }\n\n          function registerModuleWithAdFuel() {\n            //todo: remove AdFuel.readCookie(\"ug\") once everyone is on new ais.js\n            window.AdFuel.registerModule(MODULE_NAME, {}, MODULE_VERSION, window.AdFuelOptions.GUID);\n            var guid = window.turner_getGuid();\n            logger.log('setting guid targeting', {\n              guid: guid\n            });\n            window.AdFuel.addPageLevelTarget('guid', guid);\n          }\n\n          if (window.AdFuel) {\n            //AdFuel loaded first\n            registerModuleWithAdFuel();\n          } else {\n            //wait for AdFuel to load\n            window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n          }\n        };\n\n        var init = function init() {\n          logger.log('Initializing Module...');\n\n          if (window.AdFuelUtils.hasCookie('ugs')) {\n            processCookie();\n          } else {\n            //execute script to set cookie\n            var guid_url = '//www.ugdturner.com/xd.sjs';\n            var a = document;\n            var b = a.createElement('script');\n            var c = a.getElementsByTagName('script')[0];\n            var d = /^(complete|loaded)$/;\n            var e = false;\n            b.type = 'text/javascript';\n            b.async = true;\n            b.src = guid_url;\n\n            b.onload = b.onreadystatechange = function () {\n              if (!e && !('readyState' in b && d.test(b.readyState))) {\n                b.onload = b.onreadystatechange = null;\n                e = true;\n                processCookie();\n              }\n            };\n\n            c.parentNode.insertBefore(b, c);\n          }\n        };\n\n        //used by freewheel helper\n        var t_getGuid = function t_getGuid() {\n          return window.AdFuelUtils.readCookie('ug');\n        };\n\n        init();\n      }\n    }) : '';\n  })();\n\n  (function createTransactionIDModule() {\n    var MODULE_NAME = 'Transaction ID Module';\n    var MODULE_VERSION = 'v3.1.1'; // Stub out AdFuelUtils in case it's not on the page.\n\n    window.AdFuelUtils = window.AdFuelUtils || {\n      addEvent: function addEvent() {},\n      getLogger: function getLogger() {}\n    }; // Stub out AdFuelOptions in case it's not on the page.\n\n    window.AdFuelOptions = window.AdFuelOptions || {};\n    window.AdFuelOptions.TRANSACTIONID = window.AdFuelOptions.TRANSACTIONID || {};\n    var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'transid', 'color: #d2b000; padding: 2px');\n    window.cnnad_transactionID = null; //referenced by registries\n\n    window.cnnad_getTransactionID = function cnnad_getTransactionID() {\n      if (!window.cnnad_transactionID) {\n        window.cnnad_transactionID = Math.round(new Date().getTime() / 1000) + '' + Math.floor(Math.random() * 9007199254740992);\n      }\n\n      return window.cnnad_transactionID;\n    };\n\n    window.turner_getTransactionId = window.cnnad_getTransactionID;\n    window.turner_getTransactionId();\n\n    function registerModuleWithAdfuel() {\n      var transId = window.turner_getTransactionId();\n      logger.log('setting transid targeting', {\n        transId: transId\n      });\n      window.AdFuel.registerModule(MODULE_NAME, {}, MODULE_VERSION, {});\n      window.AdFuel.addPageLevelTarget('transId', transId);\n    }\n\n    var init = function init() {\n      window.AdFuelOptions.GDPR ? window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n        if (applies && !window.AdFuelUtils.getConsent()) {\n          logger.log('Disabling Transaction ID due to GDPR restrictions.');\n        } else {\n          logger.log('Initializing Module...');\n\n          if (window.AdFuel) {\n            //AdFuel loaded first\n            registerModuleWithAdfuel();\n          } else {\n            //wait for AdFuel to load\n            window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdfuel);\n          }\n        }\n      }) : '';\n    };\n\n    init();\n  })();\n\n  if (CNN.Features.enableCreativeReview === true) {\n    (function createCreativeReviewModule() {\n      var MODULE_NAME = 'Creative Review Module';\n      var MODULE_VERSION = 'v3.0.3'; // Stub out AdFuelUtils in case it's not on the page.\n\n      window.AdFuelUtils = window.AdFuelUtils || {\n        addEvent: function addEvent() {},\n        getViewport: function getViewport() {},\n        getBrowser: function getBrowser() {},\n        getURLParam: function getURLParam() {},\n        getLogger: function getLogger() {},\n        metricApi: {\n          addMetric: function addMetric() {}\n        }\n      }; // Stub out AdFuelOptions in case it's not on the page.\n\n      window.AdFuelOptions = window.AdFuelOptions || {};\n      window.AdFuelOptions.CREATIVE_REVIEW = window.AdFuelOptions.CREATIVE_REVIEW || {\n        HOTKEY: '^ d o h $'\n      };\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'adreview', 'color: #00e1e1; padding: 2px');\n\n      function checkHash() {\n        if (location.hash.indexOf('doh') >= 0) {\n          if (toolRendered) {\n            _renderTool();\n          }\n\n          _renderTool();\n        } else if (toolRendered) {\n          _renderTool();\n        }\n      }\n\n      var deviceInfo = null;\n      var locationInfo = null;\n\n      function setDevice() {\n        if (deviceInfo !== null) {\n          return deviceInfo;\n        }\n\n        logger.time('Getting Device Information');\n        var viewport = window.AdFuelUtils.getViewport();\n        deviceInfo = {\n          availHeight: screen.availHeight,\n          availLeft: screen.availLeft,\n          availTop: screen.availTop,\n          availWidth: screen.availWidth,\n          colorDepth: screen.colorDepth,\n          height: screen.height,\n          orientation: {\n            angle: screen.orientation ? screen.orientation.angle : 0,\n            onchange: screen.orientation ? screen.orientation.onchange : null,\n            type: screen.orientation ? screen.orientation.type : null\n          },\n          pixelDepth: screen.pixelDepth,\n          width: screen.width,\n          os: window.navigator.platform ? window.navigator.platform : 'Unknown',\n          browser: window.AdFuelUtils.getBrowser(),\n          class: 'Desktop',\n          viewport: viewport.join('x')\n        };\n\n        if (window.AdFuelUtils.isMobile.amazon.device) {\n          deviceInfo.os = 'Amazon';\n\n          if (window.AdFuelUtils.isMobile.amazon.phone) {\n            deviceInfo.class = 'Phone';\n          }\n\n          if (window.AdFuelUtils.isMobile.amazon.tablet) {\n            deviceInfo.class = 'Tablet';\n          }\n        }\n\n        if (window.AdFuelUtils.isMobile.android.device) {\n          deviceInfo.os = 'Android';\n\n          if (window.AdFuelUtils.isMobile.android.phone) {\n            deviceInfo.class = 'Phone';\n          }\n\n          if (window.AdFuelUtils.isMobile.android.tablet) {\n            deviceInfo.class = 'Tablet';\n          }\n        }\n\n        if (window.AdFuelUtils.isMobile.apple.device) {\n          deviceInfo.os = 'iOS';\n\n          if (window.AdFuelUtils.isMobile.apple.ipod) {\n            deviceInfo.class = 'iPod';\n          }\n\n          if (window.AdFuelUtils.isMobile.apple.phone) {\n            deviceInfo.class = 'Phone';\n          }\n\n          if (window.AdFuelUtils.isMobile.apple.tablet) {\n            deviceInfo.class = 'Tablet';\n          }\n        }\n\n        if (window.AdFuelUtils.isMobile.windows.device) {\n          deviceInfo.os = 'Windows';\n\n          if (window.AdFuelUtils.isMobile.windows.phone) {\n            deviceInfo.class = 'Phone';\n          }\n\n          if (window.AdFuelUtils.isMobile.windows.tablet) {\n            deviceInfo.class = 'Tablet';\n          }\n        }\n\n        if (window.AdFuelUtils.isMobile.other.blackberry) {\n          deviceInfo.os = 'Blackberry';\n          deviceInfo.class = 'Phone';\n        }\n\n        if (window.AdFuelUtils.isMobile.other.blackberry10) {\n          deviceInfo.os = 'Blackberry10';\n          deviceInfo.class = 'Phone';\n        }\n\n        if (window.AdFuelUtils.isMobile.other.chrome) {\n          deviceInfo.os = 'Chrome';\n          deviceInfo.class = 'Phone';\n        }\n\n        if (window.AdFuelUtils.isMobile.other.firefox) {\n          deviceInfo.os = 'Firefox';\n          deviceInfo.class = 'Phone';\n        }\n\n        if (window.AdFuelUtils.isMobile.other.opera) {\n          deviceInfo.os = 'Opera';\n          deviceInfo.class = 'Phone';\n        }\n\n        window.AdFuelUtils.metricApi.addMetric({\n          type: 'modules',\n          id: 'User Sciences',\n          data: deviceInfo\n        });\n        logger.timeEnd('Getting Device Information');\n        return deviceInfo;\n      } // var hostname = document.location.hostname;\n\n\n      var cdnRoot =\n      /*hostname.indexOf('cnn.com') >= 0 ? 'www.i.cdn.cnn.com' : */\n      'i.cdn.turner.com';\n      var fileUploadOK = window.File && window.FileReader && window.FileList && window.Blob;\n      var toolRendered = false;\n      var _appliedTargeting = [];\n      var sites = ['', 'Adult Swim', 'Bleacher Report', 'Cartoon Network', 'CNN', 'CNN Arabic', 'CNN Espanol', 'CNN International', 'CNN Money', 'ELEAGUE', 'Great Big Story', 'HLN', 'NBA', 'NBA International', 'NCAA', 'PGA', 'Ryder Cup', 'TBS', 'TCM', 'Team Coco', 'TNT', 'TruTV'];\n      var firstPanelElements = [{\n        type: 'inputText',\n        name: 'Name',\n        value: '',\n        label: 'Your Name',\n        required: true\n      }, {\n        type: 'inputEmail',\n        name: 'Email',\n        value: '',\n        label: 'Your Email',\n        required: true\n      }, {\n        type: 'fileUpload',\n        name: 'Screenshot',\n        value: '',\n        label: 'Upload Screenshot',\n        required: false\n      }];\n      var secondPanelElements = [{\n        type: 'listLabel',\n        name: 'Reason',\n        label: 'Issue Being Reported',\n        required: false\n      }, {\n        type: 'list',\n        name: 'Issue(s)',\n        required: false,\n        items: [{\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'block list violation',\n          label: 'Ad violates block list',\n          required: false\n        }, {\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'video plays in display ad',\n          label: 'Video plays in ad',\n          required: false\n        }, {\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'ad disrupts content',\n          label: 'Ad disrupts content',\n          required: false\n        }, {\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'ad incorrectly sized',\n          label: 'Ad incorrectly sized',\n          required: false\n        }, {\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'download initiated',\n          label: 'Ad initiates download',\n          required: false\n        }, {\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'blank ad',\n          label: 'Blank ad',\n          required: false\n        }, {\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'low quality',\n          label: 'Low-quality ad',\n          required: false\n        }, {\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'audio auto-starts',\n          label: 'Audio auto-starts',\n          required: false\n        }, {\n          type: 'checkbox',\n          name: 'Issue',\n          value: 'broken ad',\n          label: 'Broken ad',\n          required: false\n        }]\n      }];\n      var thirdPanelElements = [{\n        type: 'select',\n        name: 'Brand',\n        label: 'Affected Brand',\n        required: true,\n        options: sites\n      }, {\n        type: 'textarea',\n        name: 'Comments',\n        label: 'Issue Description',\n        required: true\n      }];\n      var head = document.getElementsByTagName('head')[0];\n      var body = document.getElementsByTagName('body')[0];\n\n      function checkbox(name, value, text) {\n        var el = document.createElement('div');\n        var cb = document.createElement('input');\n        cb.type = 'checkbox';\n        cb.name = name;\n        cb.id = name + '_' + value;\n        cb.style['float'] = 'left';\n        cb.style['margin-right'] = '2px';\n        cb.style['position'] = 'relative';\n        cb.style['top'] = '3px';\n        cb.value = value;\n        var lab = document.createElement('div');\n        lab.style.width = 'calc(100% - 18px)';\n        lab.appendChild(document.createTextNode(text));\n        el.appendChild(cb);\n        el.appendChild(lab);\n        return el;\n      }\n\n      function element(name, text, className) {\n        var el = document.createElement(name);\n        el.innerHTML = text;\n        el.className = className;\n        return el;\n      }\n\n      function button(item) {\n        var el = document.createElement('button');\n        el.onclick = item.action;\n        el.id = item.name;\n        el.appendChild(document.createTextNode(item.value));\n        el.className = 'btn btn-sm btn-primary';\n        return el;\n      }\n\n      function _renderTool() {\n        var container, iconStylesheet, toolContainer, toolFiller, toolStylesheet;\n\n        if (!toolRendered) {\n          // Load stylesheets and add elements to page.\n          body = document.getElementsByTagName('body')[0];\n          var isSecure = 'https:' === document.location.protocol;\n          iconStylesheet = document.createElement('link');\n          iconStylesheet.type = 'text/css';\n          iconStylesheet.rel = 'stylesheet';\n          iconStylesheet.href = (isSecure ? 'https:' : 'http:') + '//fonts.googleapis.com/icon?family=Material+Icons';\n          iconStylesheet.id = 'material-icons-font';\n          toolStylesheet = document.createElement('link');\n          toolStylesheet.rel = 'stylesheet';\n          toolStylesheet.href = (isSecure ? 'https:' : 'http:') + '//' + cdnRoot + '/ads/adfuel/css/creativeReview-3.0.css'; // toolStylesheet.href = '/css/creativeReview-3.0.css';\n\n          toolStylesheet.id = 'adfuel-creative-review-stylesheet';\n          container = document.createElement('div');\n          container.className = 'adfuel-creative-review-button-container adfuel-open-creative-review-button-container';\n          var actionButton = document.createElement('a');\n          actionButton.className = 'adfuel-creative-review-button';\n          var buttonIcon = document.createElement('i');\n          buttonIcon.className = 'adfuel-creative-review-button-icon material-icons';\n          buttonIcon.innerHTML = 'view_module';\n          buttonIcon.innerText = 'view_module';\n          toolFiller = document.createElement('div');\n          toolFiller.className = 'adfuel-creative-review-filler';\n          toolContainer = document.createElement('div');\n          toolContainer.className = 'adfuel-creative-review';\n          actionButton.appendChild(buttonIcon);\n          container.appendChild(actionButton);\n          head.appendChild(iconStylesheet);\n          head.appendChild(toolStylesheet);\n          body.appendChild(container);\n          body.appendChild(toolFiller);\n          body.appendChild(toolContainer);\n\n          if (locationInfo === null) {\n            (function (callback) {\n              'use strict';\n\n              var a = document,\n                  b = a.createElement('script'),\n                  c = a.getElementsByTagName('script')[0],\n                  d = /^(complete|loaded)$/,\n                  e = false,\n                  f = 'https:' === document.location.protocol;\n              b.type = 'text/javascript';\n              b.async = true;\n              b.src = (f ? 'https:' : 'http:') + '//www.geoplugin.net/javascript.gp';\n\n              b.onload = b.onreadystatechange = function () {\n                if (!e && !('readyState' in b && d.test(b.readyState))) {\n                  b.onload = b.onreadystatechange = null;\n                  e = true;\n                  callback();\n                }\n              };\n\n              c.parentNode.insertBefore(b, c);\n            })(function () {\n              var geoCountry, geoCity, geoRegion, geoLat, geoLong;\n              var valueSet = false;\n\n              if (window.geoplugin_countryCode) {\n                geoCountry = window.geoplugin_countryCode();\n                valueSet = true;\n              }\n\n              if (window.geoplugin_city) {\n                geoCity = window.geoplugin_city();\n                valueSet = true;\n              }\n\n              if (window.geoplugin_region) {\n                geoRegion = window.geoplugin_region();\n                valueSet = true;\n              }\n\n              if (window.geoplugin_latitude) {\n                geoLat = window.geoplugin_latitude();\n                valueSet = true;\n              }\n\n              if (window.geoplugin_longitude) {\n                geoLong = window.geoplugin_longitude();\n                valueSet = true;\n              }\n\n              if (valueSet === true) {\n                locationInfo = {\n                  city: geoCity,\n                  region: geoRegion,\n                  country: geoCountry,\n                  latitude: geoLat,\n                  longitude: geoLong\n                };\n                window.AdFuelUtils.metricApi.addMetric({\n                  type: 'configuration',\n                  id: 'actual_user_location',\n                  data: {\n                    city: geoCity,\n                    region: geoRegion,\n                    country: geoCountry,\n                    latitude: geoLat,\n                    longitude: geoLong\n                  }\n                });\n              }\n            });\n          }\n\n          _buildToolContainer(toolContainer);\n\n          window.AdFuelUtils.addEvent(actionButton, 'click', _openTool);\n          toolRendered = true;\n        } else {\n          // Remove stylesheets and elements from page.\n          iconStylesheet = document.getElementById('material-icons-font');\n          toolStylesheet = document.getElementById('adfuel-creative-review-stylesheet');\n          container = document.querySelector('div.adfuel-creative-review-button-container');\n          toolFiller = document.querySelector('div.adfuel-creative-review-filler');\n          toolContainer = document.querySelector('div.adfuel-creative-review');\n          head.removeChild(iconStylesheet);\n          head.removeChild(toolStylesheet);\n          body.removeChild(container);\n          body.removeChild(toolFiller);\n          body.removeChild(toolContainer);\n          toolRendered = false;\n        }\n      }\n\n      function _buildToolContainer(container) {\n        var closeContainer = document.createElement('div');\n        closeContainer.className = 'adfuel-creative-review-button-container';\n        closeContainer.id = 'adfuel-close-creative-review-button-container';\n        var actionButton = document.createElement('a');\n        actionButton.className = 'adfuel-creative-review-button-plain';\n        actionButton.id = 'adfuel-close-creative-review-button';\n        var buttonIcon = document.createElement('i');\n        buttonIcon.className = 'adfuel-creative-review-button-icon material-icons';\n        buttonIcon.innerHTML = buttonIcon.innerText = 'close';\n        var consoleBanner = document.createElement('div');\n        consoleBanner.id = 'adfuel-creative-review-banner';\n        var consoleTabContainer = document.createElement('div');\n        consoleTabContainer.className = 'adfuel-creative-review-tab-link-container';\n        actionButton.appendChild(buttonIcon);\n        closeContainer.appendChild(actionButton);\n        window.AdFuelUtils.addEvent(actionButton, 'click', _closeTool);\n        consoleBanner.appendChild(closeContainer);\n        var title = document.createElement('div');\n        title.className = 'adfuel-creative-review-banner-title';\n        var titleText = 'AdFuel Creative Review';\n        var titleContainer = document.createElement('div');\n        titleContainer.appendChild(document.createTextNode(titleText));\n        var subtitle = document.createElement('div');\n        subtitle.className = 'adfuel-creative-review-banner-subtitle';\n        subtitle.innerHTML = 'Report an issue on this page by submitting the form below.&nbsp;&nbsp;&nbsp;A copy will be sent to the email address provided.';\n        titleContainer.appendChild(subtitle);\n        title.appendChild(titleContainer);\n        consoleBanner.appendChild(title);\n        consoleBanner.appendChild(consoleTabContainer);\n        container.appendChild(consoleBanner);\n        return;\n      }\n\n      function _openTool() {\n        var toolFiller = document.querySelector('div.adfuel-creative-review-filler');\n        var toolContainer = document.querySelector('div.adfuel-creative-review');\n        var openContainer = document.querySelector('div.adfuel-creative-review-button-container');\n        var closeContainer = document.querySelector('div#adfuel-close-creative-review-button-container');\n        openContainer.style.display = 'none';\n        closeContainer.style.display = 'inline-block';\n        toolFiller.style.display = 'block';\n        toolContainer.style.display = 'inline-block';\n\n        _buildToolContent(toolContainer);\n\n        _showToolContent();\n\n        return;\n      }\n\n      function _closeTool() {\n        logger.log('Closing Tool...');\n        var openContainer = document.querySelector('div.adfuel-creative-review-button-container');\n        var openButton = document.querySelector('body > div.adfuel-creative-review-button-container > a');\n        var toolFiller = document.querySelector('div.adfuel-creative-review-filler');\n        var toolContainer = document.querySelector('div.adfuel-creative-review');\n        logger.log('Closing Tool...', toolFiller, toolContainer);\n        toolFiller.style.display = 'none';\n        toolContainer.style.display = 'none';\n\n        if (openContainer && openButton) {\n          openContainer.style.display = 'inline-block';\n          openButton.style.display = 'inline-block';\n          window.AdFuelUtils.addEvent(openButton, 'click', _openTool);\n          window.AdFuel.openTool = _openTool;\n        }\n\n        return;\n      }\n\n      function _showToolContent() {\n        var panel = document.createElement('div');\n        var container = document.getElementsByClassName('adfuel-creative-review')[0];\n        panel.id = 'adfuel-creative-review-content';\n        panel.className = 'adfuel-creative-review-content';\n        panel.style.width = '100%';\n        panel.style.padding = '0';\n        panel.style.margin = '0';\n        panel.style.height = '80%';\n        panel.style.minHeight = '250px';\n        panel.style.overflowY = 'auto';\n        panel.style.display = 'block';\n        container.appendChild(panel);\n      }\n\n      function _buildToolContent(container) {\n        if (!container) {\n          container = document.getElementsByClassName('adfuel-creative-review')[0];\n        }\n\n        if (!container) {\n          logger.log('Error: No AdFuel-Creative-Review container.');\n          return false;\n        }\n\n        var panelContainer = document.createElement('div');\n        panelContainer.id = 'adfuel-creative-review-content';\n        panelContainer.className = 'adfuel-creative-review-content';\n\n        _buildCreativeReviewForm(panelContainer);\n\n        container.appendChild(panelContainer);\n        var adXVendorData = {\n          queryIds: {}\n        };\n        document.querySelectorAll('div[data-google-query-id]').forEach(function (node) {\n          adXVendorData.queryIds[node.id] = node.dataset.googleQueryId;\n        });\n        window.AdFuelUtils.metricApi.addMetric({\n          id: 'AdX',\n          type: 'vendor',\n          data: adXVendorData\n        });\n      }\n\n      function setSubmitMessage(header, message) {\n        // set the message\n        var el = document.createElement('p');\n\n        if (message !== '') {\n          el.style.color = 'white';\n          el.style.fontSize = '.95em';\n          el.style.textAlign = 'center';\n          el.innerHTML = message;\n        }\n\n        header.innerHTML = '';\n        header.appendChild(el);\n        header.style.display = 'block'; //clear the message after 5 sec.\n\n        window.setTimeout(function () {\n          header.innerHTML = '';\n          header.style.display = 'none';\n        }, 5000);\n      }\n\n      function setSuccessMessage(header, message) {\n        // set the message\n        var el = document.createElement('p');\n        header.style.backgroundColor = 'green';\n\n        if (message !== '') {\n          el.style.color = 'white';\n          el.style.fontSize = '.95em';\n          el.style.textAlign = 'center';\n          el.style.fontWeight = 'normal';\n          el.style.fontFamily = 'Helvetica';\n          el.innerHTML = message;\n        }\n\n        header.innerHTML = '';\n        header.appendChild(el);\n        header.style.display = 'block'; //clear the message after 5 sec.\n\n        window.setTimeout(function () {\n          header.innerHTML = '';\n          header.style.display = 'none';\n        }, 5000);\n      }\n\n      function validateEmail(email) {\n        var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        return re.test(email);\n      }\n\n      function buildPanel(panel, container, elements) {\n        for (var i = 0; i < elements.length; i++) {\n          var item = elements[i];\n\n          switch (item.type) {\n            case 'textarea':\n              var textareaContainer = element('div', '', 'adfuel-creative-review-textarea-container');\n              var textareaLabel = element('div', (item.required === true ? '<span style=\\'color: red;\\'>*</span> ' : '') + item.label + ': ', 'adfuel-creative-review-form-label adfuel-creative-review-textarea-label');\n              textareaContainer.appendChild(textareaLabel);\n              textareaContainer.appendChild(item.element = document.createElement('textarea'));\n              item.element.name = item.name || '';\n\n              if (item.required === true) {\n                item.element.attributes.required = 'required';\n              }\n\n              panel.appendChild(textareaContainer);\n              break;\n\n            case 'inputText':\n              var inputContainer = element('div', '', 'adfuel-creative-review-input-element-container');\n              var inputLabel = element('div', (item.required === true ? '<span style=\\'color: red;\\'>*</span> ' : '') + item.label + ': ', 'adfuel-creative-review-form-label adfuel-creative-review-input-label');\n              inputContainer.appendChild(inputLabel);\n              item.element = document.createElement('input');\n              item.element.name = item.name || '';\n              item.element.type = 'text';\n\n              if (item.required === true) {\n                item.element.setAttribute('required', 'required');\n              }\n\n              inputContainer.appendChild(item.element);\n              panel.appendChild(inputContainer);\n              break;\n\n            case 'inputEmail':\n              inputContainer = element('div', '', 'adfuel-creative-review-input-element-container');\n              inputLabel = element('div', (item.required === true ? '<span style=\\'color: red;\\'>*</span> ' : '') + item.label + ': ', 'adfuel-creative-review-form-label adfuel-creative-review-input-label');\n              inputContainer.appendChild(inputLabel);\n              item.element = document.createElement('input');\n              item.element.type = 'email';\n              item.element.name = item.name || '';\n\n              if (item.required === true) {\n                item.element.setAttribute('required', 'required');\n              }\n\n              inputContainer.appendChild(item.element);\n              panel.appendChild(inputContainer);\n              break;\n\n            case 'listLabel':\n              var listContainer = element('div', '', 'adfuel-creative-review-list-element-container');\n              var listLabel = element('div', (item.required === true ? '<span style=\\'color: red;\\'>*</span> ' : '') + item.label + ': ', 'adfuel-creative-review-form-label adfuel-creative-review-list-label');\n              listContainer.appendChild(listLabel);\n              panel.append(listContainer);\n              break;\n\n            case 'list':\n              listContainer = panel.querySelector('#cr_panel_2 > div.adfuel-creative-review-list-element-container');\n              var listEl = element('div', '', 'adfuel-creative-review-checkbox-list');\n\n              for (var x = 0; x < item.items.length; x++) {\n                var listItem = item.items[x];\n                var checkboxWrapper = checkbox(listItem.name, listItem.value, listItem.label);\n                var checkboxEl = checkboxWrapper.firstChild;\n                item.items[x].element = checkboxEl;\n                listEl.appendChild(checkboxWrapper);\n              }\n\n              listContainer.appendChild(listEl);\n              break;\n\n            case 'select':\n              var selectContainer = element('div', '', 'adfuel-creative-review-select-container');\n              var panelLabel = element('div', (item.required === true ? '<span style=\\'color: red;\\'>*</span> ' : '') + item.label + ': ', 'adfuel-creative-review-form-label adfuel-creative-review-select-label');\n              selectContainer.appendChild(panelLabel);\n              item.element = document.createElement('select');\n              item.element.name = item.name;\n\n              for (var optionIndex = 0; optionIndex < item.options.length; optionIndex++) {\n                var option = element('option', item.options[optionIndex]);\n                option.value = item.options[optionIndex];\n                item.element.appendChild(option);\n              }\n\n              selectContainer.appendChild(item.element);\n              panel.appendChild(selectContainer);\n              break;\n\n            case 'button':\n              panel.appendChild(button(item));\n              break;\n\n            case 'fileUpload':\n              if (fileUploadOK) {\n                inputContainer = element('div', '', 'adfuel-creative-review-input-element-container');\n                inputLabel = element('div', item.label + ': ' + (item.required === true ? ' *' : ''), 'adfuel-creative-review-form-label adfuel-creative-review-file-label');\n                inputContainer.appendChild(inputLabel);\n                item.element = document.createElement('input');\n                item.element.name = item.name || '';\n                item.element.type = 'file';\n                item.element.accept = 'image/*';\n                inputContainer.appendChild(item.element);\n                panel.appendChild(inputContainer);\n              }\n\n              break;\n          }\n        }\n\n        logger.log('Appending Panel to Container: ', panel, container);\n        container.appendChild(panel);\n      }\n\n      function _buildCreativeReviewForm(panel) {\n        if (!panel) return;\n        panel.innerHTML = '';\n        panel.style.padding = '0';\n        var header = document.createElement('div');\n        header.className = 'adfuel-creative-review-panel';\n        header.id = 'cr_panel_header';\n        var validationText = document.createElement('p');\n        validationText.className = 'adfuel-creative-review-panel-header-text';\n        header.appendChild(validationText);\n        panel.appendChild(header);\n        var formElement = document.createElement('form');\n        panel.appendChild(formElement);\n        var panel1 = document.createElement('div');\n        panel1.className = 'adfuel-creative-review-panel';\n        panel1.id = 'cr_panel_1';\n        buildPanel(panel1, formElement, firstPanelElements);\n        var panel2 = document.createElement('div');\n        panel2.className = 'adfuel-creative-review-panel';\n        panel2.id = 'cr_panel_2';\n        buildPanel(panel2, formElement, secondPanelElements);\n        var panel3 = document.createElement('div');\n        panel3.className = 'adfuel-creative-review-panel';\n        panel3.id = 'cr_panel_3';\n        buildPanel(panel3, formElement, thirdPanelElements);\n        var footer = document.createElement('div');\n        footer.className = 'adfuel-creative-review-panel';\n        footer.id = 'cr_panel_footer';\n        var submitContainer = document.createElement('div'); // submit confirmation alert box\n\n        var confirmAlert = document.createElement('div');\n        confirmAlert.className = 'cr-confirm-alert';\n        confirmAlert.style.visibility = 'hidden';\n        var confirmAlertText = document.createElement('div');\n        confirmAlertText.className = 'cr-confirm-alert-text';\n        var today = new Date();\n        var dayOfWeek = today.getDay();\n        var hour = today.getHours();\n        var offHours = dayOfWeek === 0 || dayOfWeek === 6 || hour < 8 || hour > 17;\n        var responseTime = offHours ? '2 hours outside of' : '1 hour during';\n        confirmAlertText.innerHTML = 'Your report has been successfully submitted to Ad Operations. If you do not get a response within ' + responseTime + ' normal business hours (8am - 6pm Eastern), further contact information can be found in the confirmation email that has been sent to you.';\n        confirmAlert.appendChild(confirmAlertText);\n        confirmAlert.appendChild(document.createElement('br'));\n        var confirmAlertBtn = document.createElement('button');\n        confirmAlertBtn.className = 'btn btn-primary btn-sm';\n        confirmAlertBtn.innerHTML = 'OK';\n\n        confirmAlertBtn.onclick = function (e) {\n          e.preventDefault();\n\n          _closeTool();\n\n          confirmAlert.style.visibility = 'hidden'; // clear all inputs\n\n          formElement.reset();\n        };\n\n        confirmAlert.appendChild(confirmAlertBtn);\n        panel.appendChild(confirmAlert);\n        var submitButton = document.createElement('button');\n        submitButton.type = 'submit';\n        submitButton.className = 'btn btn-primary btn-sm cr-confirm-alert-btn';\n\n        submitButton.onclick = function (e) {\n          e.preventDefault(); // validate inputs\n\n          if (formElement.elements['Name'].value === '' || formElement.elements['Comments'].value === '' || formElement.elements['Email'].value === '' || formElement.elements['Brand'].value === '') {\n            setSubmitMessage(header, 'Please fill out all required fields.');\n            return;\n          } else if (!validateEmail(formElement.elements['Email'].value)) {\n            setSubmitMessage(header, 'Email address is not valid.');\n            return;\n          } else {\n            submitCreativeReviewForm(formElement, function () {\n              setSuccessMessage(header, 'Your report has been successfully submitted to Ad Operations.<hr />If you do not get a response within 2 hours outside of normal business hours (8am - 6pm Eastern), further contact information can be found in the confirmation email that has been sent to you.');\n            });\n          }\n        };\n\n        submitButton.innerHTML = 'SUBMIT';\n        submitContainer.appendChild(submitButton);\n        footer.appendChild(submitContainer);\n        panel.appendChild(footer);\n        panel.appendChild(confirmAlert);\n      }\n\n      function setRenderCompleteListener() {\n        window.googletag.cmd.push(function () {\n          window.googletag.pubads().addEventListener('slotRenderEnded', function (event) {\n            try {\n              var detail = {};\n\n              if (event.slot) {\n                detail.asset = event.slot;\n              }\n\n              if (event.slot.getTargeting('pos')) {\n                detail.pos = event.slot.getTargeting('pos');\n              }\n\n              if (event.isEmpty) {\n                detail.empty = true;\n              } else {\n                detail.empty = false;\n              }\n\n              if (event.size) {\n                detail.renderedSize = event.size;\n              }\n\n              if (event.creativeId) {\n                detail.creativeId = event.creativeId;\n              }\n\n              if (event.lineItemId) {\n                detail.lineItemId = event.lineItemId;\n              }\n\n              if (event.serviceName) {\n                detail.serviceName = event.serviceName;\n              }\n\n              if (event.slot.getSlotElementId()) {\n                detail.divId = event.slot.getSlotElementId();\n              }\n\n              var info = window.AdFuel.pageSlots[detail.divId].getResponseInformation() || {\n                campaignId: null,\n                advertiserId: null\n              };\n              detail.campaignId = info.campaignId;\n              detail.advertiserId = info.advertiserId;\n              window.AdFuelUtils.metricApi.addMetric({\n                type: 'slots',\n                id: detail.divId,\n                data: {\n                  advertiserId: detail.advertiserId,\n                  campaignId: detail.campaignId,\n                  creativeId: detail.creativeId,\n                  lineItemId: detail.lineItemId\n                }\n              });\n            } catch (ex) {\n              logger.err('error reading slotRenderEnded event', {\n                error: ex\n              });\n            }\n          });\n        });\n      }\n\n      function _addTargetingForCreativeExtraction(slots, callback) {\n        for (var slotIndex = 1; slotIndex < slots.length; slotIndex++) {\n          var slot = slots[slotIndex];\n\n          if (_appliedTargeting.indexOf(slot.rktr_slot_id) < 0) {\n            window.AdFuel.addSlotLevelTarget(slot.rktr_slot_id, 'elemId', slot.rktr_slot_id);\n\n            _appliedTargeting.push(slot.rktr_slot_id);\n          }\n        }\n\n        window.AdFuelUtils.addEvent(document, 'SlotIdChange', function (e) {\n          if (e.detail.newId !== e.detail.originalId) {\n            if (_appliedTargeting.indexOf(e.detail.newId) < 0) {\n              window.AdFuel.addSlotLevelTarget(e.detail.newId, 'elemId', e.detail.newId);\n\n              _appliedTargeting.push(e.detail.newId);\n            }\n          }\n        });\n        callback();\n      }\n\n      function serialize(form) {\n        if (!form || form.nodeName !== 'FORM') {\n          return;\n        }\n\n        var i,\n            j,\n            q = [],\n            t = {};\n\n        for (i = form.elements.length - 1; i >= 0; i = i - 1) {\n          if (form.elements[i].name === '') {\n            continue;\n          }\n\n          switch (form.elements[i].nodeName) {\n            case 'INPUT':\n              switch (form.elements[i].type) {\n                case 'email':\n                case 'text':\n                case 'hidden':\n                case 'password':\n                case 'button':\n                case 'reset':\n                case 'submit':\n                  q.push(form.elements[i].name + '=' + encodeURIComponent(form.elements[i].value));\n                  t[form.elements[i].name] = form.elements[i].value;\n                  break;\n\n                case 'file':\n                  if (form.elements[i].files.length > 0) {\n                    q.push(form.elements[i].name + '=' + encodeURIComponent(form.elements[i].value));\n                    t[form.elements[i].name] = form.elements[i].files[0]; // FileList object\n\n                    t[form.elements[i].name + 'FileName'] = t[form.elements[i].name].name;\n                  }\n\n                  break;\n\n                case 'checkbox':\n                  if (form.elements[i].checked) {\n                    q.push(form.elements[i].name + '=' + encodeURIComponent(form.elements[i].value)); // to support multiple checkboxes in a group, store the values as an array\n\n                    if (t[form.elements[i].name]) {\n                      t[form.elements[i].name].push(form.elements[i].value);\n                    } else {\n                      t[form.elements[i].name] = [form.elements[i].value];\n                    }\n                  }\n\n                  break;\n\n                case 'radio':\n                  if (form.elements[i].checked) {\n                    q.push(form.elements[i].name + '=' + encodeURIComponent(form.elements[i].value));\n                    t[form.elements[i].name] = form.elements[i].value;\n                  }\n\n                  break;\n              }\n\n              break;\n\n            case 'TEXTAREA':\n              q.push(form.elements[i].name + '=' + encodeURIComponent(form.elements[i].value));\n              t[form.elements[i].name] = form.elements[i].value;\n              break;\n\n            case 'SELECT':\n              switch (form.elements[i].type) {\n                case 'select-one':\n                  q.push(form.elements[i].name + '=' + encodeURIComponent(form.elements[i].value));\n                  t[form.elements[i].name] = form.elements[i].value;\n                  break;\n\n                case 'select-multiple':\n                  for (j = form.elements[i].options.length - 1; j >= 0; j = j - 1) {\n                    if (form.elements[i].options[j].selected) {\n                      q.push(form.elements[i].name + '=' + encodeURIComponent(form.elements[i].options[j].value));\n                      t[form.elements[i].name] = form.elements[i].options[j].value;\n                    }\n                  }\n\n                  break;\n              }\n\n              break;\n\n            case 'BUTTON':\n              switch (form.elements[i].type) {\n                case 'reset':\n                case 'submit':\n                case 'button':\n                  q.push(form.elements[i].name + '=' + encodeURIComponent(form.elements[i].value));\n                  t[form.elements[i].name] = form.elements[i].value;\n                  break;\n              }\n\n              break;\n          }\n        }\n\n        return t;\n      }\n\n      function submitCreativeReviewForm(form, callback) {\n        var data = serialize(form);\n\n        var processData = function processData() {\n          // callback(true);\n          var xhr = new XMLHttpRequest();\n\n          xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4) {\n              callback(xhr.status === 200);\n            }\n          };\n\n          var formBlob = new Blob([JSON.stringify(data, null, 2)], {\n            type: 'application/json'\n          });\n          var registryBlob = new Blob([JSON.stringify(window.AdFuel.registry, null, 2)], {\n            type: 'application/json'\n          });\n          var browserData = {\n            availHeight: screen.availHeight,\n            availLeft: screen.availLeft,\n            availTop: screen.availTop,\n            availWidth: screen.availWidth,\n            colorDepth: screen.colorDepth,\n            height: screen.height,\n            orientation: {\n              angle: screen.orientation.angle,\n              onchange: screen.orientation.onchange,\n              type: screen.orientation.type\n            },\n            pixelDepth: screen.pixelDepth,\n            width: screen.width\n          };\n          var slotData = JSON.parse(JSON.stringify(window.AdFuelUtils.metricApi.metrics.slots));\n\n          for (var x in slotData) {\n            if (slotData.hasOwnProperty(x)) {\n              delete slotData[x].build_end;\n              delete slotData[x].build_start;\n              delete slotData[x].display;\n              delete slotData[x].queued;\n              delete slotData[x].render_start;\n              delete slotData[x].render_end;\n            }\n          }\n\n          var slotsBlob = new Blob([JSON.stringify(slotData, null, 2)], {\n            type: 'application/json'\n          });\n          var cookiesBlob = new Blob([JSON.stringify(document.cookie, null, 2)], {\n            type: 'application/json'\n          });\n          var browserBlob = new Blob([JSON.stringify(browserData, null, 2)], {\n            type: 'application/json'\n          });\n          var requestBlob = new Blob([JSON.stringify(window.AdFuel.requestScriptText, null, 2)], {\n            type: 'application/json'\n          });\n          var timelineBlob = new Blob([JSON.stringify(window.AdFuelUtils.metricApi.metrics.timeline, null, 2)], {\n            type: 'application/json'\n          });\n          var urlBlob = new Blob([JSON.stringify(window.location.href, null, 2)], {\n            type: 'application/json'\n          });\n          var vendorBlob = new Blob([JSON.stringify(window.AdFuelUtils.metricApi.metrics.vendor || {}, null, 2)], {\n            type: 'application/json'\n          });\n          var fdata = new FormData();\n          fdata.append('formData', formBlob);\n          fdata.append('registry', registryBlob);\n          fdata.append('slots', slotsBlob);\n          fdata.append('cookies', cookiesBlob);\n          fdata.append('request', requestBlob);\n          fdata.append('browser', browserBlob);\n          fdata.append('vendor', vendorBlob);\n          fdata.append('timeline', timelineBlob);\n          fdata.append('url', urlBlob);\n          var url = 'https://adfuel.turnerapps.com/api/v2/email';\n          xhr.open('POST', url, true);\n          xhr.send(fdata);\n        };\n\n        if (data.Screenshot) {\n          // Only process image files.\n          if (!data.Screenshot.type.match('image.*')) {\n            processData();\n          }\n\n          var reader = new FileReader(); // Closure to capture the file information.\n\n          reader.onload = function (data) {\n            return function (e) {\n              data.Screenshot = e.target.result;\n              processData();\n            };\n          }(data); // Read in the image file as a data URL.\n\n\n          reader.readAsDataURL(data.Screenshot);\n        } else {\n          processData();\n        }\n      }\n\n      function parseMessage(msg) {\n        var data = {};\n\n        if (msg.data && typeof msg.data.indexOf === 'function' && msg.data.indexOf('{') === 0 && msg.data.indexOf('googMsgType') < 0) {\n          try {\n            data = JSON.parse(msg.data);\n          } catch (err) {\n            return;\n          }\n        }\n\n        if (data.divId) {\n          if (Array.isArray(data.divId) && data.divId.length > 1) {\n            data.divId = data.divId[0];\n          }\n\n          window.AdFuelUtils.metricApi.addMetric({\n            type: 'creatives',\n            id: data.divId,\n            data: data\n          });\n        }\n      }\n\n      function addKeypressModule() {\n        var renderCreativeReviewConsole = function renderCreativeReviewConsole() {\n          logger.log('Rendering Creative Review Console...');\n\n          _renderTool();\n        };\n\n        var initializeKeypressListeners = function initializeKeypressListeners() {\n          logger.log('Initializing Keypress Listener...'); // d-o-h to open just Creative Review\n\n          var defaults = {\n            prevent_default: false,\n            prevent_repeat: false,\n            is_sequence: true,\n            is_exclusive: true,\n            is_solitary: true\n          };\n          var options = {\n            keys: window.AdFuelOptions.CREATIVE_REVIEW.HOTKEY || '^ d o h $',\n            on_keydown: renderCreativeReviewConsole\n          };\n          var feedbackListener = new window.keypress.Listener(window, defaults);\n          feedbackListener.register_combo(options);\n        };\n\n        if (!window.keypress) {\n          var a = document,\n              b = a.createElement('script'),\n              c = a.getElementsByTagName('script')[0],\n              d = /^(complete|loaded)$/,\n              e = false,\n              f = 'https:' === document.location.protocol;\n          b.type = 'text/javascript';\n          b.async = true;\n          b.src = (f ? 'https:' : 'http:') + '//' + cdnRoot + '/ads/adfuel/modules/keypress.js';\n\n          b.onload = b.onreadystatechange = function () {\n            if (!e && !('readyState' in b && d.test(b.readyState))) {\n              b.onload = b.onreadystatechange = null;\n              e = true;\n              initializeKeypressListeners();\n            }\n          };\n\n          c.parentNode.insertBefore(b, c);\n        } else {\n          initializeKeypressListeners();\n        }\n      }\n\n      function registerModuleWithAdFuel() {\n        logger.log('Registering Module with AdFuel...');\n        window.AdFuel.registerModule(MODULE_NAME, {\n          postQueueCallback: _addTargetingForCreativeExtraction\n        }, MODULE_VERSION, window.AdFuelOptions.CREATIVE_REVIEW);\n        window.AdFuelUtils.addEvent(window, 'message', parseMessage);\n        window.AdFuelUtils.addEvent(window, 'hashchange', checkHash);\n        addKeypressModule();\n        setRenderCompleteListener();\n        checkHash();\n      }\n\n      function init() {\n        setDevice();\n        window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n      }\n\n      init();\n    })();\n  }\n\n  if (CNN.Features.enableCep === true) {\n    (function createCEPModule() {\n      'use strict';\n\n      var MODULE_NAME = 'CEP Module';\n      var MODULE_VERSION = 'v3.0.2'; // Stub out AdFuelUtils in case it's not on the page.\n\n      window.AdFuelUtils = window.AdFuelUtils || {\n        addEvent: function addEvent() {},\n        getURLParam: function getURLParam() {},\n        isIntl: false,\n        getLogger: function getLogger() {},\n        addMetric: function addMetric() {}\n      }; // Stub out AdFuelOptions in case it's not on the page.\n\n      window.AdFuelOptions = window.AdFuelOptions || {};\n      window.AdFuelOptions.CEP = window.AdFuelOptions.CEP || {};\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'cep', 'color: #d2b000; padding: 2px');\n      /*\n      CNN.cep_topics = {\n          \"cep_brsf\": [\"15P9\", \"15LP\", \"15PN\", \"15LY\"],\n          \"cep_iabt\": [\"15B0\", \"159T\", \"157Q\", \"155B\", \"1597\", \"14TL\", \"15KF\"],\n          \"cep_sent\": [\"15N4\", \"15N3\"],\n          \"cep_tags\": [\"15PT\", \"7XH\", \"BJF\", \"518\", \"8N2\", \"4YN\", \"3YX\", \"115V\", \"DFT\"]\n      }\n      */\n\n      var cepTags = {\n        cep_brsf: [],\n        cep_iabt: [],\n        cep_sent: [],\n        cep_tags: []\n      };\n\n      var preQueueCallback = function preQueueCallback(asset, callback) {\n        // Make sure the asset array contains slots...\n        if (asset.length > 0 && asset[0].rktr_ad_id) {\n          var site = window.AdFuelOptions.ADFUEL.SITE_OBJECT || asset[0].rktr_ad_id.split('/')[0];\n          cepTags = window[site] ? window[site].cep_topics : cepTags;\n        }\n\n        callback();\n      };\n\n      var preDispatchCallback = function preDispatchCallback(asset, callback) {\n        Object.keys(cepTags).forEach(function (key) {\n          logger.log('Adding CEP ' + key + ' Targeting: ', cepTags[key]);\n          window.AdFuel.addPageLevelTarget(key, cepTags[key]);\n        });\n        callback();\n      };\n\n      var registerModuleWithAdFuel = function registerModuleWithAdFuel() {\n        logger.log('Registering module with AdFuel');\n        window.AdFuel.registerModule(MODULE_NAME, {\n          preQueueCallback: preQueueCallback,\n          preDispatchCallback: preDispatchCallback\n        }, MODULE_VERSION, window.AdFuelOptions.CEP);\n      };\n\n      var init = function init() {\n        logger.log('Initializing Module...');\n\n        if (window.AdFuel && window.AdFuel.cmd) {\n          //AdFuel loaded first\n          window.AdFuel.cmd.push(registerModuleWithAdFuel);\n        } else if (window.AdFuel) {\n          registerModuleWithAdFuel();\n        } else {\n          window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n        }\n      };\n\n      init();\n    })();\n  }\n\n  if (CNN.Features.enableBeemray === true) {\n    (function createBeemrayModule() {\n      var MODULE_NAME = 'Beemray Module';\n      var MODULE_VERSION = 'v3.0.2'; // Stub out AdFuelUtils in case it's not on the page.\n\n      window.AdFuelUtils = window.AdFuelUtils || {\n        addEvent: function addEvent() {},\n        getURLParam: function getURLParam() {},\n        isIntl: false,\n        getLogger: function getLogger() {},\n        addMetric: function addMetric() {}\n      }; // Stub out AdFuelOptions in case it's not on the page.\n\n      window.AdFuelOptions = window.AdFuelOptions || {};\n      window.AdFuelOptions.BEEMRAY = window.AdFuelOptions.BEEMRAY || {\n        CUSTOMER_ID: '',\n        API_KEY: ''\n      };\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'beemray', 'color: #d2b000; padding: 2px');\n      var CUSTOMER_ID = window.AdFuelOptions.BEEMRAY.CUSTOMER_ID;\n      var API_KEY = window.AdFuelOptions.BEEMRAY.API_KEY;\n      var scriptLoaded = false;\n      var eventFired = false;\n\n      var includeBeemrayModule = function includeBeemrayModule() {\n        if (!scriptLoaded) {\n          logger.log('Including Library...');\n          scriptLoaded = true;\n          var source = 'https://' + CUSTOMER_ID + '.sdk.beemray.com/content/websdk/' + API_KEY + '?source=' + window.btoa(window.location.href);\n          logger.log('Script source: ', source);\n          var script = document.createElement('script');\n          script.src = source;\n          document.head.appendChild(script);\n        }\n      };\n\n      var preQueueCallback = function preQueueCallback(asset, callback) {\n        if (scriptLoaded && window.beemray && window.beemray.EventApi) {\n          var eventTitle = 'dfpEvent';\n          var endPointUrl = '/rest/event/web/plain';\n          var event = window.beemray.EventApi.create(eventTitle, endPointUrl);\n          var timeout = 1000;\n\n          var eventFunc = function eventFunc(response) {\n            eventFired = true;\n            logger.log('Response: ', response);\n\n            if (null === response) {\n              callback();\n              return logger.log('Request Timeout or no Results.');\n            }\n\n            var targetIds = [];\n\n            for (var i = 0; i < response.list.length; i++) {\n              logger.log('Adding Page-Level Target ID: ', response.list[i].id);\n              targetIds.push(response.list[i].id);\n            }\n\n            logger.log('Setting Page-Level Targets: ', targetIds);\n            window.googletag.pubads().setTargeting('beemray', targetIds);\n            callback();\n          };\n\n          logger.log('Sending WebAPI event...');\n\n          if (!eventFired) {\n            event.send(eventFunc, timeout);\n            eventFired = true;\n          }\n        } else {\n          callback();\n        }\n      };\n\n      var registerModuleWithAdFuel = function registerModuleWithAdFuel() {\n        logger.log('Registering Module...');\n        window.AdFuel.registerModule(MODULE_NAME, {\n          preQueueCallback: preQueueCallback\n        }, MODULE_VERSION, window.AdFuelOptions.BEEMRAY);\n      };\n\n      var init = function init() {\n        logger.log('Initializing Module...');\n\n        if (!window.AdFuelUtils.isIntl) {\n          logger.log('Disabling Beemray due to user origin.  Not international.');\n          return;\n        }\n\n        if (!CUSTOMER_ID || CUSTOMER_ID === '' || !API_KEY || API_KEY === '') {\n          logger.log('Disabling Beemray due to no CUSTOMER_ID or API_KEY: ', {\n            customer_id: CUSTOMER_ID,\n            api_key: API_KEY\n          });\n          return;\n        }\n\n        window.AdFuelOptions.GDPR.APPLIES.then(function (gdprApplies) {\n          var consentGranted = window.AdFuelUtils.getConsent();\n\n          if (consentGranted || !gdprApplies) {\n            includeBeemrayModule();\n\n            if (window.AdFuel && window.AdFuel.cmd) {\n              window.AdFuel.cmd.push(registerModuleWithAdFuel);\n            } else if (window.AdFuel) {\n              //AdFuel loaded first\n              registerModuleWithAdFuel();\n            } else {\n              window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n            }\n          }\n\n          return;\n        });\n      };\n\n      init();\n    })();\n  }\n\n  if (CNN.Features.enableInViewRefresh === true) {\n    (function createInViewRefreshModule() {\n      var MODULE_NAME = 'In-View Refresh Module';\n      var MODULE_VERSION = 'v3.0.5';\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'ivr', 'color: #00e1e1; padding: 2px');\n      var _refreshableInViewSlots = {};\n\n      var _focused = !document.hidden;\n\n      var TARGET_DISPLAY_MILLISECONDS = window.AdFuelOptions.IVR.DEFAULT_DISPLAY_MILLISECONDS;\n      var TARGET_DISPLAY_PERCENT = window.AdFuelOptions.IVR.DEFAULT_DISPLAY_PERCENT;\n      var registeredSlots = [];\n      var _viewabilityListenersStarted = false;\n\n      var startViewabilityListeners = function _startViewabilityListeners() {\n        if (!_viewabilityListenersStarted) {\n          window.googletag.cmd.push(function startViewabilityListeners() {\n            window.googletag.pubads().addEventListener('impressionViewable', function impressionViewableFunc(event) {\n              var detail = event;\n              var divId = detail.slot.getSlotElementId();\n\n              if (_refreshableInViewSlots[divId] && !_refreshableInViewSlots[divId].listenersSet) {\n                logger.log('Refreshable In View Slot listeners have not been set: ', divId, {\n                  object: _refreshableInViewSlots[divId]\n                });\n\n                _createInViewRefreshObject(detail);\n              } else {\n                logger.log('Refreshable In View Slot listeners have already been set for: ', divId, {\n                  object: _refreshableInViewSlots[divId]\n                });\n              }\n            });\n            window.googletag.pubads().addEventListener('slotVisibilityChanged', function slotVisibilityChangedFunc(event) {\n              var detail = event;\n\n              _visibilityChanged(detail);\n            });\n            window.googletag.pubads().addEventListener('slotRenderEnded', function slotRenderEndedFunc(event) {\n              var detail = event;\n              var divId = detail.slot.getSlotElementId();\n              var renderedSize = detail.size ? detail.size.join('x') : '0x0';\n\n              if (['970x66', '970x90', '970x250'].indexOf(renderedSize) >= 0) {\n                delete _refreshableInViewSlots[divId];\n                registeredSlots.splice(registeredSlots.indexOf(divId), 1);\n                logger.log('Rendered size [' + renderedSize + '] for slot [' + divId + '] is invalid for IVR.  Stopping refresh.');\n              }\n            });\n          });\n          window.AdFuelUtils.addEvent(document, 'visibilitychange', _visibilityChangeEvent);\n          _viewabilityListenersStarted = true;\n          logger.log('Listeners Started!');\n        }\n      };\n\n      function _visibilityChangeEvent(event) {\n        logger.log('Visibility Change Event: ', event);\n        logger.log('Relaying to _focusChanged...');\n        _focused = !document.hidden;\n        event.target = event.target || {};\n        event.target.hidden = event.target.hidden || document.hidden;\n\n        _focusChanged(event);\n      }\n\n      function _focusChanged() {\n        var hidden = document.hidden;\n\n        if (hidden) {\n          logger.log('Page is hidden.  Destroying all intervals...');\n          destroyInterval();\n        } else {\n          logger.log('Page is not hidden. Checking Intervals...');\n\n          for (var slotIndex in _refreshableInViewSlots) {\n            if (_refreshableInViewSlots.hasOwnProperty(slotIndex)) {\n              logger.log({\n                index: slotIndex,\n                slot: _refreshableInViewSlots[slotIndex]\n              });\n              var interval = getInterval(slotIndex);\n\n              if (interval) {\n                logger.log('Interval exists...', slotIndex); // destroyInterval(slotIndex);\n              } else {\n                logger.log('Creating Interval...', slotIndex);\n\n                _detectInView(slotIndex);\n              }\n            }\n          }\n        }\n      }\n\n      function _visibilityChanged(obj) {\n        var percent = obj.inViewPercentage || 0;\n        var elementId = obj.slot.getSlotElementId();\n        var interval = getInterval(elementId);\n\n        if (percent >= TARGET_DISPLAY_PERCENT) {\n          logger.log('Element [' + elementId + '] Meets In-View Percentage Requirements', percent);\n\n          if (_focused) {\n            logger.log('... and page has focus');\n\n            if (!interval) {\n              logger.log('... interval does not exist');\n              createInterval(elementId);\n            }\n          } else {\n            logger.log('... but page does not have focus.  Not creating interval.');\n          }\n        } else {\n          logger.log('Element [' + elementId + '] Does NOT Meet In-View Percentage Requirements', percent);\n\n          if (interval) {\n            logger.log('Found Interval for Element [' + elementId + ']... Destroying Interval.');\n            destroyInterval(elementId);\n          }\n        }\n      }\n\n      function getInterval(elementId) {\n        logger.log('Getting Interval for: ', elementId);\n        return _refreshableInViewSlots[elementId] && _refreshableInViewSlots[elementId].timer === null ? false : _refreshableInViewSlots[elementId] ? _refreshableInViewSlots[elementId].timer : false;\n      }\n\n      function createInterval(elementId) {\n        if (_refreshableInViewSlots.hasOwnProperty(elementId)) {\n          var slot = _refreshableInViewSlots[elementId];\n          slot.inViewRefreshCounter = _refreshableInViewSlots[elementId].inViewRefreshCounter || 0;\n          logger.log('Creating Interval for: ', elementId);\n          slot.timer = window.setInterval(function slotTimerFunc() {\n            logger.log('Slot: ', slot);\n\n            if (typeof slot !== 'undefined' && slot !== null) {\n              if (slot.inViewRefreshCount > 0) {\n                slot.el = slot.el || document.getElementById(elementId);\n                var elId = slot.el.id;\n                slot.inViewRefreshCount--;\n                slot.inViewRefreshCounter++;\n                window.AdFuel.removeSlotLevelTarget(elId, 'rfv');\n                window.AdFuel.addSlotLevelTarget(elId, 'rfv', slot.inViewRefreshCounter);\n                window.AdFuelUtils.metricApi.addMetric({\n                  type: 'viewability',\n                  id: elId,\n                  data: {\n                    refresh_count: slot.inViewRefreshCounter,\n                    last_refresh: Date.now()\n                  }\n                });\n\n                if (slot.inViewRefreshCount >= 0) {\n                  logger.log('Slot [' + elId + '] is in view and is being refreshed.');\n                  logger.log('Calling Refresh On: ', slot);\n                  window.AdFuel.refresh([elId]);\n                  logger.log('Slot [' + slot.el.id + '] is in view, was just refreshed, and still has ' + slot.inViewRefreshCount + ' refreshes remaining.');\n                }\n              } else {\n                logger.log('Slot [' + elementId + '] is in view but has no refreshes remaining.', slot, slot.inViewRefreshCount);\n              }\n            } else {\n              logger.log('Slot refresh prevented due to rendered size.');\n            }\n          }, TARGET_DISPLAY_MILLISECONDS);\n          logger.log('Done.');\n        }\n      }\n\n      function destroyInterval(elementId) {\n        var slot;\n\n        if (elementId) {\n          logger.log('Destroying interval for: ', elementId);\n          slot = _refreshableInViewSlots[elementId];\n          window.clearInterval(slot.timer);\n          slot.timer = null;\n          slot.inView = false;\n        } else {\n          logger.log('Destroying All Intervals');\n\n          for (var slotIndex in _refreshableInViewSlots) {\n            if (_refreshableInViewSlots.hasOwnProperty(slotIndex)) {\n              logger.log('Destroying interval for: ', slotIndex);\n              slot = _refreshableInViewSlots[slotIndex];\n              window.clearInterval(slot.timer);\n              slot.timer = null;\n              slot.inView = false;\n            }\n          }\n        }\n      }\n\n      function _createInViewRefreshObject(event) {\n        logger.log('Checking Element: ', {\n          event: event\n        });\n        var divId = event.slot.getSlotElementId();\n        var el = document.getElementById(divId);\n        logger.log('Creating In View Refresh Object: ', {\n          divId: divId,\n          el: el\n        });\n        var empty = event.slot ? event.slot.l ? event.slot.l._empty_ : false : false;\n        logger.log('Is Slot Empty: ', empty);\n\n        if (!empty) {\n          if (registeredSlots.indexOf(divId) !== -1) {\n            logger.log('Slot is registered with InView Refresh');\n            _refreshableInViewSlots[divId].inView = false;\n            _refreshableInViewSlots[divId].el = el; // _refreshableInViewSlots[divId].mouseover = _refreshableInViewSlots[divId].mouseover || addEvent(el, 'mouseover', _mouseoverFunction);\n            // _refreshableInViewSlots[divId].mouseout = _refreshableInViewSlots[divId].mouseout || addEvent(el, 'mouseout', _mouseoutFunction);\n\n            _refreshableInViewSlots[divId].refreshCount = 0;\n            _refreshableInViewSlots[divId].listenersSet = true;\n          } else {\n            logger.log('Slot is NOT registered with InView Refresh');\n          }\n        } else {\n          logger.log('Slot is empty.');\n        }\n      }\n\n      function _isInsideBounds(clientX1, clientX2, clientY1, clientY2, elX1, elX2, elY1, elY2) {\n        var a = Math.max(clientY1, elY1); //287\n\n        var b = Math.min(clientY2, elY2); //377\n\n        var c = Math.max(clientX1, elX1); //587.5\n\n        var d = Math.min(clientX2, elX2); //1315.5\n\n        var viewableArea = 0;\n        var aCheck = a >= clientY1 && a <= clientY2;\n        var bCheck = b >= clientY1 && b <= clientY2;\n        var cCheck = c >= clientX1 && c <= clientX2;\n        var dCheck = d >= clientX1 && d <= clientX2;\n\n        if (aCheck && bCheck && cCheck && dCheck) {\n          viewableArea = (b - a) * (d - c);\n        }\n\n        var elArea = (elX2 - elX1) * (elY2 - elY1);\n        var ratioArea = 0;\n\n        if (elArea > 0) {\n          ratioArea = viewableArea / elArea;\n        }\n\n        return ratioArea;\n      }\n\n      function _getPercentInView(el) {\n        var client_width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n        var client_height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n        var client_x1 = window.pageXOffset || document.body.scrollLeft || document.documentElement.scrollLeft;\n        var client_y1 = window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop;\n        client_width = parseInt(client_width);\n        client_height = parseInt(client_height);\n        client_x1 = parseInt(client_x1);\n        client_y1 = parseInt(client_y1);\n        var el_width = parseInt(el.clientWidth);\n        var el_height = parseInt(el.clientHeight);\n        var el_xy = el.getBoundingClientRect();\n        var el_x1 = el_xy.left + document.body.scrollLeft;\n        var el_y1 = el_xy.top + document.body.scrollTop;\n        var el_x2 = el_x1 + el_width;\n        var el_y2 = el_y1 + el_height;\n        var client_x2 = client_x1 + client_width;\n        var client_y2 = client_y1 + client_height;\n\n        var viewable_percent = _isInsideBounds(client_x1, client_x2, client_y1, client_y2, el_x1, el_x2, el_y1, el_y2, el);\n\n        return viewable_percent * 100;\n      }\n\n      function _detectInView() {\n        logger.log('Detecting In View Slots.');\n\n        if (_refreshableInViewSlots.length < 1) {\n          logger.log('No registered slots have been rendered yet.');\n        }\n\n        for (var divId in _refreshableInViewSlots) {\n          if (_refreshableInViewSlots.hasOwnProperty(divId)) {\n            var slot = _refreshableInViewSlots[divId];\n            var el = slot.el || document.getElementById(divId);\n            var viewTest = false;\n\n            if (el) {\n              viewTest = el && _focused && _getPercentInView(el) >= TARGET_DISPLAY_PERCENT && parseInt(_refreshableInViewSlots[divId].inViewRefreshCount) > 0;\n            }\n\n            var interval = getInterval(divId);\n\n            if (viewTest && !interval) {\n              createInterval(divId);\n            }\n          }\n        }\n      }\n\n      function preQueueCallbackForIVR(asset, callback) {\n        var startListeners = false;\n        logger.time('IVR Pre-Queue Process Start');\n\n        for (var x = 0; x < asset.length; x++) {\n          var slot = asset[x];\n          slot.hasInViewRefresh = asset[0].hasInViewRefresh ? asset[0].hasInViewRefresh : slot.hasInViewRefresh || 'false';\n\n          if (slot.hasInViewRefresh === 'true') {\n            logger.log('Slot has In-View Refresh...');\n            slot.inViewRefreshCounter = 0;\n            startListeners = true;\n            registeredSlots.push(slot.rktr_slot_id);\n          }\n        }\n\n        if (startListeners) {\n          logger.log('Starting IVR Listeners...');\n          startViewabilityListeners();\n        }\n\n        callback();\n        logger.timeEnd('IVR Pre-Queue Process Start');\n        return null;\n      }\n\n      function preDispatchCallbackForIVR(queue, callback) {\n        for (var qId = 0; qId < queue.length; qId++) {\n          var rocketeerSlot = queue[qId];\n\n          if (rocketeerSlot.hasInViewRefresh === 'true') {\n            logger.log('Slot is configured for in view refresh.  Creating refresh object for slot [' + rocketeerSlot.rktr_slot_id + ']');\n            _refreshableInViewSlots[rocketeerSlot.rktr_slot_id] = rocketeerSlot;\n          } else {\n            logger.log('Slot is not configured for in view refresh. [' + rocketeerSlot.rktr_slot_id + ']');\n          }\n        }\n\n        if (callback) callback();\n      }\n\n      function registerModuleWithAdFuel() {\n        window.AdFuel.registerModule('In View Refresh', {\n          preQueueCallback: preQueueCallbackForIVR,\n          preDispatchCallback: preDispatchCallbackForIVR\n        }, MODULE_VERSION, window.AdFuelOptions.IVR);\n      }\n\n      function init() {\n        if (window.AdFuel) {\n          //AdFuel loaded first\n          registerModuleWithAdFuel();\n        } else {\n          //wait for AdFuel to load\n          window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n        }\n      }\n\n      window.AdFuelUtils.startViewabilityListeners = startViewabilityListeners;\n      init();\n    })();\n  }\n\n  if (CNN.Features.enableIntegralAdScience === true) {\n    (function createIASModule() {\n      var MODULE_NAME = 'Integral Ad Science Module';\n      var MODULE_VERSION = 'v3.1.1'; // Stub out AdFuelUtils in case it's not on the page.\n\n      window.AdFuelUtils = window.AdFuelUtils || {\n        addEvent: function addEvent() {},\n        getURLParam: function getURLParam() {},\n        isMonetized: function isMonetized() {},\n        isIntl: false,\n        getLogger: function getLogger() {},\n        addMetric: function addMetric() {}\n      }; // Stub out AdFuelOptions in case it's not on the page.\n\n      window.AdFuelOptions = window.AdFuelOptions || {};\n      window.AdFuelOptions.IAS = window.AdFuelOptions.IAS || {\n        DOM_PUB_ID: 925660,\n        INTL_PUB_ID: 925660\n      };\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'ias', 'color: #d2b000; padding: 2px');\n      var iasActive = false;\n      var DOMESTIC_PUB_ID = window.AdFuelOptions.IAS.DOM_PUB_ID;\n      var INTERNATIONAL_PUB_ID = window.AdFuelOptions.IAS.INTL_PUB_ID;\n      window.__iasPET = window.__iasPET || {};\n      window.__iasPET.queue = window.__iasPET.queue || [];\n\n      function iasDataHandler(adSlots) {\n        logger.log('IAS Data Handler...');\n        logger.log({\n          adSlots: adSlots\n        });\n\n        window.__iasPET.setTargetingForGPT();\n      }\n\n      function preQueueCallback(asset, done) {\n        var pubId = INTERNATIONAL_PUB_ID;\n        logger.log('Pub Ids: ', DOMESTIC_PUB_ID, INTERNATIONAL_PUB_ID);\n        logger.log('Setting iasPET.pubId: ', pubId);\n        window.__iasPET.pubId = pubId; // Set IAS publisher ID before pushing to the queue\n\n        logger.log('Building slots for IAS...');\n        var adSlots = [];\n\n        for (var x = 1; x < asset.length; x++) {\n          logger.log('Pushing Slot: ', {\n            adSlotId: asset[x].rktr_slot_id,\n            size: asset[x].sizes,\n            adUnitPath: '/8663477/' + asset[x].rktr_ad_id\n          });\n          adSlots.push({\n            adSlotId: asset[x].rktr_slot_id,\n            size: asset[x].sizes,\n            adUnitPath: '/8663477/' + asset[x].rktr_ad_id\n          });\n        }\n\n        window.__iasPET.queue.push({\n          adSlots: adSlots,\n          dataHandler: iasDataHandler\n        });\n\n        setTimeout(function timeoutFunc() {\n          done();\n        }, 900);\n      }\n\n      function preDispatchCallback(asset, done) {\n        setTimeout(function preDispatchTimeoutFunc() {\n          logger.log('Adding IAS Targeting to slots...');\n\n          try {\n            window.__iasPET.setTargetingForGPT();\n          } catch (err) {\n            logger.warn('Could not set IAS targeting: ', err);\n          }\n\n          done();\n        }, 900);\n      }\n\n      function registerModuleWithAdFuel() {\n        if (iasActive) {\n          logger.log('Registering module with AdFuel');\n          window.AdFuel.setOptions({\n            queueCallbackTimeoutInMilliseconds: 1000,\n            dispatchCallbackTimeoutInMilliseconds: 1000\n          });\n          window.AdFuel.registerModule(MODULE_NAME, {\n            preQueueCallback: preQueueCallback,\n            preDispatchCallback: preDispatchCallback\n          }, MODULE_VERSION, window.AdFuelOptions.IAS);\n        }\n      }\n\n      function addIASJavascript() {\n        logger.log('Adding IAS script to head...');\n        var iasTag = document.createElement('script');\n        iasTag.async = true;\n        iasTag.src = '//cdn.adsafeprotected.com/iasPET.1.js';\n        var targetNode = document.getElementsByTagName('head')[0];\n        targetNode.insertBefore(iasTag, targetNode.firstChild);\n        iasActive = true;\n      }\n\n      function init() {\n        logger.log('Initializing Module...');\n        window.AdFuelOptions.GDPR ? window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n          if (applies && !window.AdFuelUtils.getConsent()) {\n            logger.log('Disabling IAS due to GDPR restrictions.');\n          } else {\n            addIASJavascript();\n          }\n        }) : '';\n\n        if (window.AdFuel && window.AdFuel.cmd) {\n          //AdFuel loaded first\n          window.AdFuel.cmd.push(registerModuleWithAdFuel);\n        } else if (window.AdFuel) {\n          registerModuleWithAdFuel();\n        } else {\n          window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n        }\n      }\n\n      init();\n    })();\n  }\n\n  if (CNN.Features.enableKrux === true) {\n    /*\n       <arguments>\n            {\n                \"controlTag\" : {\n                    \"isRequired\": false,\n                    \"isBoolean\": false,\n                    \"defaultValue\": \"\"\n                }\n            }\n       </arguments>\n    */\n    (function createKruxModule() {\n      var MODULE_NAME = 'Krux Module';\n      var MODULE_VERSION = 'v3.0.6';\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'krux', 'color: #d2b000; padding: 2px');\n      var enableKrux = true;\n      window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n        if (applies && !window.AdFuelUtils.getConsent()) {\n          logger.log('Disabling Krux due to GDPR restrictions.');\n          enableKrux = false;\n        }\n\n        if (enableKrux) {\n          var retrieve = function retrieve(n) {\n            var k = 'kx' + n;\n\n            var ls = function () {\n              try {\n                return window.localStorage;\n              } catch (e) {\n                return null;\n              }\n            }();\n\n            if (ls) {\n              return ls[k] || '';\n            } else if (navigator.cookieEnabled) {\n              var m = document.cookie.match(k + '=([^;]*)');\n              return m && unescape(m[1]) || '';\n            } else {\n              return '';\n            }\n          };\n\n          window.Krux || ((window.Krux = function () {\n            window.Krux.q.push([arguments]);\n          }).q = []);\n          window.Krux.user = retrieve('user');\n          window.Krux.segments = retrieve('segs') ? retrieve('segs').split(',') : [];\n        }\n\n        window.krux_getDESegments = enableKrux ? function krux_getDESegments() {\n          var segmentString = '&kxid=';\n\n          if (window.Krux.user) {\n            segmentString += window.Krux.user;\n          }\n\n          segmentString += '&kxseg=' + window.kvs.join(',');\n          return segmentString;\n        } : function () {};\n        window.krux_getFWSegments = enableKrux ? function krux_getFWSegments() {\n          return 'kxseg=' + window.Krux.segments.join(',kxseg=');\n        } : function () {};\n        window.krux_getUser = enableKrux ? function krux_getUser() {\n          return window.Krux.user;\n        } : function () {};\n        window.krux_getFWKeyValues = enableKrux ? function krux_getFWKeyValues(prefix, limit) {\n          var segPrefix = prefix || '_fwu:386123:';\n          var segLimit = limit || 35;\n          var fwKVP = {};\n\n          for (var x = 0; x < window.Krux.segments.length; x++) {\n            if (x < segLimit) fwKVP[segPrefix + window.Krux.segments[x]] = 1;\n          }\n\n          return fwKVP;\n        } : function () {};\n        var processCookie = enableKrux ? function processCookie(asset, callback) {\n          logger.log(\"Adding Krux Targeting...\");\n          var kuid = window.Krux.user;\n          var ksg = window.Krux.segments.filter(function filterFunc(segment, index) {\n            return index < 35;\n          });\n          window.AdFuel.addPageLevelTarget('kuid', kuid);\n          window.AdFuel.addPageLevelTarget('ksg', ksg);\n          window.AdFuelUtils.metricApi.addMetric({\n            type: 'modules',\n            id: 'Krux',\n            data: {\n              targeting: {\n                kuid: kuid,\n                ksg: ksg\n              }\n            }\n          });\n          callback();\n        } : function () {};\n        var registerModuleWithAdFuel = enableKrux ? function registerModuleWithAdFuel() {\n          window.AdFuel.registerModule(MODULE_NAME, {\n            preDispatchCallback: processCookie\n          }, MODULE_VERSION, window.AdFuelOptions.KRUX);\n        } : function () {};\n        var setControlTag = enableKrux ? function setControlTag(controlTagId) {\n          logger.log(\"Setting Control Tag: \", controlTagId); //execute script to set cookie\n\n          var a = document;\n          var b = a.createElement('script');\n          var c = a.getElementsByTagName('head')[0];\n          var d = /^(complete|loaded)$/;\n          var e = false;\n          b.type = 'text/javascript';\n          b.async = true;\n          var m;\n          var src = (m = a.location.href.match(/\\bkxsrc=([^&]+)/)) && decodeURIComponent(m[1]);\n          b.src = /^https?:\\/\\/([^\\/]+\\.)?krxd\\.net(:\\d{1,5})?\\//i.test(src) ? src : src === 'disable' ? '' : (a.location.protocol === 'https:' ? 'https:' : 'http:') + '//cdn.krxd.net/controltag?confid=' + controlTagId;\n\n          if (!window.AdFuelUtils.piiFilter.hash() && !window.AdFuelUtils.piiFilter.qs() && !window.AdFuelUtils.piiFilter.ref()) {\n            logger.log(\"Adding Krux Script To Head of Page...\", b.src);\n            c.appendChild(b);\n          }\n        } : function () {};\n\n        var init = function init() {\n          if (window.AdFuelOptions.KRUX) {\n            //set based on site\n            var controlTag = window.AdFuelUtils.isIntl ? window.AdFuelOptions.KRUX.INTL_CONTROLTAG : window.AdFuelOptions.KRUX.DOM_CONTROLTAG;\n\n            if (enableKrux) {\n              setControlTag(controlTag);\n\n              if (window.AdFuel) {\n                //AdFuel loaded first\n                registerModuleWithAdFuel();\n              } else {\n                window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n              }\n            }\n          }\n        };\n\n        init();\n      });\n    })();\n  }\n\n  if (CNN.Features.enableProximic === true) {\n    (function createProximicModule() {\n      var MODULE_NAME = 'Proximic Module';\n      var MODULE_VERSION = 'v3.1.2'; // Stub out AdFuelUtils in case it's not on the page.\n\n      window.AdFuelUtils = window.AdFuelUtils || {\n        addEvent: function addEvent() {},\n        getLogger: function getLogger() {}\n      }; // Stub out AdFuelOptions in case it's not on the page.\n\n      window.AdFuelOptions = window.AdFuelOptions || {\n        DEFAULT_MODULE_TIMEOUT: 800\n      };\n      window.AdFuelOptions.PROXIMIC = window.AdFuelOptions.PROXIMIC || {};\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'proximic', 'color: #d2b000; padding: 2px');\n      var loop_count = 0;\n      var iteration_time = 50;\n      var timeout = 250;\n      var location_url = document.location.href;\n\n      if (window.location.hostname.toLowerCase().match(/^train\\.next\\.cnn\\.com/)) {\n        location_url.replace('train.next.', 'www');\n      }\n\n      var script_url = '//segment-data-us-east.zqtk.net/turner-47fcf6?url=' + encodeURIComponent(location_url); // var script_url = \"//segment-data-us-east.zqtk.net/turner-47fcf6?url=\" + encodeURIComponent('http://www.cnn.com/2016/02/17/entertainment/prince-passport-photo-feat/index.html');\n\n      var segmentData = '';\n      var scriptAdded = false; // sample response from js and format can be easily changed:\n\n      window.gotSegmentData = function gotSegmentData(data) {\n        if (data.data) {\n          logger.log('Segment Data: ', data.data);\n          segmentData = data.data;\n          window.proximicData = data.data;\n        }\n      };\n\n      function recallProximic(url) {\n        segmentData = '';\n        window.proximicData = [];\n        window.AdFuel.removePageLevelTarget('pconid');\n        var location_url = url || document.location.href;\n\n        if (window.location.hostname.toLowerCase().match(/^train\\.next\\.cnn\\.com/)) {\n          location_url.replace('train.next.', 'www');\n        }\n\n        script_url = '//segment-data-us-east.zqtk.net/turner-47fcf6?url=' + encodeURIComponent(location_url);\n        delete document.getElementById('proximic-script');\n        scriptAdded = false;\n        addProximicScriptToHead();\n        loop_count = 0;\n        logger.log('Waiting for Proximic Data...');\n        wait_for_data();\n      }\n\n      window.recallProximic = recallProximic;\n\n      function addProximicScriptToHead() {\n        if (!scriptAdded) {\n          window.AdFuelOptions.GDPR ? window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n            if (applies && !window.AdFuelUtils.getConsent()) {\n              logger.log('Disabling Proximic due to GDPR restrictions.');\n            } else {\n              var prox = document.createElement('script');\n              prox.id = 'proximic-script';\n              prox.type = 'text/javascript';\n              prox.async = true;\n              prox.src = (document.location.protocol === 'https:' ? 'https:' : 'http:') + script_url;\n              var node = document.getElementsByTagName('script')[0];\n              node.parentNode.appendChild(prox);\n              logger.log('Added Proximic script to head of page.', script_url);\n              scriptAdded = true;\n            }\n          }) : '';\n        }\n      }\n\n      function call_dfp(dataForDFP, callback) {\n        if (dataForDFP !== '' && typeof dataForDFP !== 'undefined') {\n          logger.log('Setting data for DFP', dataForDFP);\n          window.AdFuel.addPageLevelTarget('pconid', dataForDFP);\n          window.AdFuel.removePageLevelTarget('prx_to', '1');\n          window.AdFuel.addPageLevelTarget('prx_to', '0');\n          if (callback) callback();\n        }\n      }\n\n      function checkEligibility(queue, callback) {\n        if (queue && queue.length > 0) {\n          logger.time('Proximic Targeting Request');\n          var rktrAdId;\n          var x;\n          var money = true;\n          var epu = false;\n\n          try {\n            if (document.location.hostname.indexOf('money') !== -1 && (!window.CNNMONEY || !window.CNNMONEY.adTargets || !window.CNNMONEY.adTargets.c_type || ['article', 'video', 'gallery'].indexOf(window.CNNMONEY.adTargets.c_type) === -1)) {\n              money = false;\n            }\n\n            for (x = 1; x < queue.length; x++) {\n              rktrAdId = queue[x].rktr_ad_id.toLowerCase();\n              epu = document.location.hostname.indexOf('explorepartsunknown.com') !== -1 && rktrAdId.search(/(leaf)/) > 0;\n              logger.log('Is this page for ExplorePartsUnknown: ', epu);\n              logger.log('Should Proximic Be Included: ', rktrAdId.search(/^(cnn|cnnbusiness|cnnbusinessedition)\\/(homepage|(.+\\/landing))/) < 0 && rktrAdId.search(/^(cnni|cnnbusiness|cnnbusinessedition)\\/(homepage|(.+\\/(landing|main)))/) < 0 && money || epu);\n\n              if (rktrAdId.search(/^(cnn|cnnbusiness|cnnbusinessedition)\\/(homepage|(.+\\/landing))/) < 0 && rktrAdId.search(/^(cnni|cnnbusiness|cnnbusinessedition)\\/(homepage|(.+\\/(landing|main)))/) < 0 && money || epu) {\n                logger.log('Adding Proximic based on ad unit specifications: ', rktrAdId);\n                addProximicScriptToHead();\n                logger.log('Waiting for Proximic Data...');\n                wait_for_data(callback);\n                break;\n              } else {\n                logger.log('Filtering Proximic based on ad unit specifications: ', rktrAdId);\n                callback();\n                break;\n              }\n            }\n          } catch (err) {\n            logger.log('Error parsing Proximic data: ', err.message || 'Unknown');\n          }\n        } else {\n          callback();\n        }\n      }\n\n      function wait_for_data(callback) {\n        var timeLogEnded = false;\n        setTimeout(function waitForDataTimeoutFunc() {\n          loop_count++;\n\n          if (window.proximicData !== '' && typeof window.proximicData !== 'undefined') {\n            /* Call DFP with data */\n            logger.log('Proximic Data found!');\n\n            if (!timeLogEnded) {\n              logger.timeEnd('Proximic Targeting Request');\n              timeLogEnded = true;\n            }\n\n            call_dfp(window.proximicData, callback);\n          } else if (loop_count * iteration_time < timeout) {\n            logger.log('Still waiting...');\n            wait_for_data(callback);\n          } else {\n            logger.log('Proximic Timeout Occurred!');\n\n            if (!timeLogEnded) {\n              logger.timeEnd('Proximic Targeting Request');\n              timeLogEnded = true;\n            }\n            /* Timeout occurred, call DFP without data */\n\n\n            window.AdFuel.addPageLevelTarget('prx_to', '1');\n            if (callback) callback();\n          }\n        }, iteration_time);\n      }\n\n      function registerModuleWithAdFuel() {\n        window.AdFuel.registerModule(MODULE_NAME, {\n          preQueueCallback: checkEligibility\n        }, MODULE_VERSION, window.AdFuelOptions.PROXIMIC);\n        window.AdFuel.addPageLevelTarget('prx_to', '1');\n\n        if (document.location.hostname.indexOf('explorepartsunknown.com') !== -1 && document.location.pathname === '/watch') {\n          logger.log('On https://explorepartsunknown.com/watch...');\n          addProximicScriptToHead();\n        }\n      }\n\n      function init() {\n        if (window.AdFuel) {\n          //AdFuel loaded first\n          registerModuleWithAdFuel();\n        } else {\n          window.AdFuelUtils.addEvent(document, 'AdFuelCreated', registerModuleWithAdFuel);\n        }\n      }\n\n      init();\n    })();\n  }\n\n  if (CNN.Features.enableSpotX === true) {\n    (function createSpotXModule() {\n      var MODULE_NAME = 'SpotX Module';\n      var MODULE_VERSION = 'v3.0.0'; // Stub out AdFuelUtils in case it's not on the page.\n\n      window.AdFuelUtils = window.AdFuelUtils || {\n        addEvent: function addEvent() {},\n        getURLParam: function getURLParam() {},\n        isMonetized: function isMonetized() {},\n        isIntl: false,\n        getLogger: function getLogger() {},\n        addMetric: function addMetric() {}\n      }; // Stub out AdFuelOptions in case it's not on the page.\n\n      window.AdFuelOptions = window.AdFuelOptions || {};\n      window.AdFuelOptions.SPOTX = window.AdFuelOptions.SPOTX || {\n        DEFAULT_TIMEOUT: 750,\n        REFRESH_TIMEOUT: 750\n      };\n      var SPOTX_TIMEOUT = window.AdFuelOptions.SPOTX.DEFAULT_TIMEOUT || 750;\n      var SPOTX_REFRESH_TIMEOUT = window.AdFuelOptions.SPOTX.REFRESH_TIMEOUT || 750;\n      var SPOTX_TARGETING_TIMEOUT;\n      var SPOTX_TARGETING = {\n        spotx_ad_key: '',\n        spotx_bid: ''\n      };\n      var scriptAdded = false;\n      var logger = window.AdFuelUtils.getLogger(MODULE_NAME, MODULE_VERSION, 'spotx', 'color: #58f53f; padding: 2px');\n\n      function getTargetingData(timeout) {\n        timeout = timeout || SPOTX_TIMEOUT;\n        var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n\n        if (timeoutOverride) {\n          timeout = timeoutOverride;\n          logger.log('Overriding Max Duration Time: ', timeout);\n        }\n\n        var wrappedFunction = function wrappedFunction(resolve) {\n          logger.log('Getting Video targeting...');\n\n          var innerFunction = function innerFunction(bids) {\n            if (!bids.error) {\n              SPOTX_TARGETING = bids;\n            }\n\n            return SPOTX_TARGETING;\n          };\n\n          if (window.SpotXVideoAPI._targetingPromise) {\n            window.SpotXVideoAPI._targetingPromise.then(function (bids) {\n              window.targetingTimeoutId = window.targetingTimeoutId - 1;\n              clearTimeout(window.targetingTimeoutId);\n              resolve(innerFunction(bids));\n            });\n          } else {\n            logger.log('Could not find initial targeting promise... creating new promise.');\n            window.SpotXVideoAPI._targetingPromise = getSpotXTargeting().then(function (bids) {\n              window.targetingTimeoutId = window.targetingTimeoutId - 1;\n              clearTimeout(window.targetingTimeoutId);\n              resolve(innerFunction(bids));\n            });\n          }\n        };\n\n        var timeoutFunction = function timeoutFunction(resolve, reject) {\n          if (!window.targetingTimeoutId) {\n            window.targetingTimeoutId = setTimeout(function () {\n              logger.log('getTargetingData timed out after ' + timeout + 'ms.');\n              reject('getTargetingData timed out after ' + timeout + 'ms.');\n            }, timeout);\n          }\n        };\n\n        var timeoutCallback = new Promise(timeoutFunction);\n        var wrappedCallback = new Promise(wrappedFunction); // Returns a race between the timeout and the passed in promise\n\n        return Promise.race([wrappedCallback, timeoutCallback]);\n      }\n\n      function getRefreshedTargetingData(timeout) {\n        if (!scriptAdded) {\n          return new Promise(function (resolve) {\n            resolve(SPOTX_TARGETING);\n          });\n        } else {\n          timeout = timeout || SPOTX_REFRESH_TIMEOUT;\n          var timeoutOverride = window.AdFuelUtils.getURLParam('mdt');\n\n          if (timeoutOverride) {\n            timeout = timeoutOverride;\n            logger.log('Overriding Max Duration Time: ', timeout);\n          }\n\n          var timeoutFunction = function timeoutFunction(resolve, reject) {\n            window.spotXTargetingTimeoutId = setTimeout(function () {\n              logger.log('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n              clearTimeout(window.spotXTargetingTimeoutId);\n              reject('getRefreshedTargetingData timed out after ' + timeout + 'ms.');\n            }, timeout);\n          };\n\n          var wrappedFunction = function wrappedFunction(resolve) {\n            window.SpotXVideoAPI._refreshedTargetingPromise = getSpotXTargeting(timeout);\n\n            var innerFunction = function innerFunction(bids) {\n              clearTimeout(window.targetingTimeoutId);\n              logger.log('Refreshed Bids: ', bids);\n              SPOTX_TARGETING = bids;\n              resolve(SPOTX_TARGETING);\n            };\n\n            logger.log('Refreshing Video targeting...');\n\n            window.SpotXVideoAPI._refreshedTargetingPromise.then(innerFunction);\n          };\n\n          var wrappedCallback = new Promise(wrappedFunction);\n          var timeoutCallback = new Promise(timeoutFunction); // Returns a race between the timeout and the passed in promise\n\n          return Promise.race([timeoutCallback, wrappedCallback]);\n        }\n      }\n\n      function getSpotXTargeting() {\n        if (!scriptAdded) {\n          return new Promise(function (resolve) {\n            resolve(SPOTX_TARGETING);\n          });\n        } else {\n          var spotXTargetingPromise = new Promise(function (resolve) {\n            logger.log('Getting SpotX Targeting...');\n            var valueReturned = false;\n\n            if (window.SpotX) {\n              var directAdOS = new window.SpotX.DirectAdOS({\n                // REQUIRED\n                // channel_id: 85394,\n                channel_id: 240895,\n                content_width: 640,\n                content_height: 480,\n                // This is currently required by the Direct AdOS but is\n                // not required for header bidding. It can be any dom element.\n                slot: document.getElementsByTagName('body')[0] // OPTIONAL\n                // hide_skin: false,\n                // autoplay: false,\n                // ad_volume: 90, // volume as a percentage\n                // price_floor: 5.30, // price floor of this opportunity\n                // custom: {}, // Publisher's custom KVPs\n                // token: {}, // Publisher's custom pass through macros\n                // content: {}, // openRTB content object\n                // start_delay: 1234, //openRTB start_delay (pre/mid/post roll)\n                // placement: 1, // openRTB video placement value\n\n              }); // Add a timeout around this function call in case the call to SpotX\n              // takes too long\n\n              directAdOS.getAdServerKVPs().then(function (kvps) {\n                if (kvps) {\n                  SPOTX_TARGETING = kvps;\n                }\n\n                if (!valueReturned) {\n                  valueReturned = true;\n                  clearTimeout(SPOTX_TARGETING_TIMEOUT);\n                  resolve(SPOTX_TARGETING);\n                }\n              }, function (error) {\n                if (!valueReturned) {\n                  valueReturned = true;\n                  clearTimeout(SPOTX_TARGETING_TIMEOUT);\n                  resolve({\n                    error: error\n                  });\n                }\n              });\n              SPOTX_TARGETING_TIMEOUT = setTimeout(function () {\n                if (!valueReturned) {\n                  valueReturned = true;\n                  logger.warn(\"SPOTX ERROR: \", 'Timed out after ' + SPOTX_TARGETING + 'ms.');\n                  resolve({\n                    error: 'SpotX Timed Out.'\n                  });\n                }\n              }, 8000);\n            } else {\n              if (!valueReturned) {\n                valueReturned = true;\n                logger.warn(\"SPOTX ERROR: \", 'No SpotX API.', window.SpotX);\n                resolve({\n                  error: 'No SpotX API.'\n                });\n              }\n            }\n          });\n          spotXTargetingPromise.id = \"SpotX Targeting Promise\";\n          return spotXTargetingPromise;\n        }\n      }\n\n      function addSpotXJavascript() {\n        if (!scriptAdded) {\n          window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n            if (applies) {\n              if (window.AdFuelUtils.getConsent()) {\n                var innerFunc = function innerFunc() {\n                  logger.log('SpotX Script Added.');\n                  window.SpotXVideoAPI._targetingPromise = getSpotXTargeting();\n                };\n\n                logger.log('Adding SpotX script to head...');\n                var spotXTag = document.createElement('script'); // spotXTag.src = '//js.spotx.tv/directsdk/v1/85394.js';\n\n                spotXTag.src = '//js.spotx.tv/directsdk/v1/240895.js';\n                var targetNode = document.getElementsByTagName('head')[0];\n                targetNode.insertBefore(spotXTag, targetNode.firstChild);\n                var d = /^(complete|loaded)$/;\n                var e = false;\n\n                spotXTag.onload = spotXTag.onreadystatechange = function () {\n                  if (!e && !('readyState' in spotXTag && d.test(spotXTag.readyState))) {\n                    spotXTag.onload = spotXTag.onreadystatechange = null;\n                    e = true;\n                    innerFunc();\n                  }\n                };\n\n                scriptAdded = true;\n              }\n            }\n          });\n        }\n      }\n\n      function init() {\n        logger.log('Initializing Module...');\n        window.AdFuelVideoAPI = window.AdFuelVideoAPI || {};\n        window.AdFuelVideoAPI.SpotX = window.SpotXVideoAPI = {\n          getTargetingData: getTargetingData,\n          getRefreshedTargetingData: getRefreshedTargetingData,\n          getPreRollTargetingData: getTargetingData,\n          getMidRollTargetingData: getRefreshedTargetingData,\n          getRefreshedPreRollTargetingData: getRefreshedTargetingData,\n          getRefreshedMidRollTargetingData: getRefreshedTargetingData,\n          _targetingPromise: null,\n          _refreshedTargetingPromise: null,\n          __VERSION__: MODULE_VERSION,\n          __OPTIONS__: window.AdFuelOptions.SPOTX\n        };\n        addSpotXJavascript();\n      }\n\n      init();\n    })();\n  }\n}\n\nif (CNN.AdsConfig.adfuelOverride) {\n  (function (doc, cnn) {\n    'use strict';\n\n    var elem = doc.createElement('script'),\n        sl = doc.getElementsByTagName('script')[0];\n    elem.type = 'text/javascript';\n    elem.src = (doc.location.protocol === 'https:' ? 'https:' : 'http:') + cnn.AdsConfig.adfuelOverride;\n    sl.parentNode.insertBefore(elem, sl);\n  })(document, window.CNN);\n} else {\n  /*!\n    AdFuel v1.3.4.6\n    - GDPR Updates (CSD-1883) (1.3.4.0)\n    - Module Version Exports (CSD-1875) (1.3.4.1)\n    - Fix: Duplicate '/' in JSON URLs (1.3.4.2)\n    - Fix: Duplicate targeting key-values (CSD-1879) (1.3.4.2)\n    - Fix: Errors when including registries via script tag (1.3.4.3)\n    - Fix: Ad Request when GDPR applies and consent not granted. (1.3.4.4)\n    - Fix: Fix for preloading registries. (1.3.4.5)\n    - Fix: Stub out AdFuelUtils/Options (1.3.4.6)\n  !*/\n  window.AdFuel = function adFuelBuilder() {\n    // Ensure that AdFuelOptions and AdFuelUtils are defined before referencing in case AIS is not loaded.\n    window.AdFuelUtils = window.AdFuelUtils || {\n      isMobile: {\n        any: false\n      },\n      cdnRoot: 'i.cdn.turner.com',\n      performance: {\n        mark: function mark() {},\n        measure: function measure() {}\n      },\n      addEvent: function addEvent() {},\n      clone: function clone() {},\n      getLogger: function getLogger() {},\n      isMonetized: function isMonetized() {},\n      getURLParam: function getURLParam() {},\n      readCookie: function readCookie() {},\n      generateCacheBuster: function generateCacheBuster() {},\n      getConsent: function getConsent() {}\n    };\n    window.AdFuelOptions = window.AdFuelOptions || {\n      ADFUEL: {\n        AUTO_DISPATCH: true,\n        DEFAULT_MOBILE_TIMEOUT: 800,\n        DEFAULT_DESKTOP_TIMEOUT: 1000,\n        DEFAULT_TIMEOUT: 1000,\n        SITE_OBJECT: '',\n        IFRAME_TITLE: 'advertisement',\n        NETWORK_ID: '8663477',\n        REFRESH_ON_FOCUS_ONLY: false\n      }\n      /* ADFUEL VARIABLES */\n\n    };\n    var NAME = 'AdFuel';\n    var VERSION = 'v1.3.4.6';\n    var cdnRoot = window.AdFuelUtils.cdnRoot; // define options that inherit values from window.AdFuelOptions\n\n    var _options = {\n      autoDispatch: window.AdFuelOptions.ADFUEL.AUTO_DISPATCH,\n      defaultTimeout: window.AdFuelUtils.isMobile.any ? window.AdFuelOptions.ADFUEL.DEFAULT_MOBILE_TIMEOUT || window.AdFuelOptions.ADFUEL.DEFAULT_TIMEOUT : window.AdFuelOptions.ADFUEL.DEFAULT_DESKTOP_TIMEOUT || window.AdFuelOptions.ADFUEL.DEFAULT_TIMEOUT,\n      exclude: [],\n      siteObject: window.AdFuelOptions.ADFUEL.SITE_OBJECT,\n      iframeTitle: window.AdFuelOptions.ADFUEL.IFRAME_TITLE,\n      networkId: window.AdFuelOptions.ADFUEL.NETWORK_ID,\n      refreshOnFocusOnly: window.AdFuelOptions.ADFUEL.REFRESH_ON_FOCUS_ONLY\n    };\n    var perf = window.AdFuelUtils.performance;\n    var _initialized = false;\n    var _blocked = null;\n    var _focused = true;\n    var _pageSlots = {};\n    var _rocketeerSlots = [];\n    var _builtSlots = [];\n    var _queuedSlots = [];\n    var _dispatchedSlots = [];\n\n    var _adsQAPageLevelKey;\n\n    var _adsQAPageLevelValue;\n\n    var _setChildDirectedTreatment;\n\n    var _setSafeFrameConfig;\n\n    var _dynamicTargeting = {\n      pageTargets: {},\n      slotTargets: {}\n    };\n    var _pageLevelTargeting = [];\n\n    var _inheritableAdUnit;\n\n    var _preQueueExecuting = false;\n    var _delayingDispatch = false; // contains dispatchQueue functions which must be delayed until queues are dispatchable\n\n    var _delayedDispatchQueues = []; // contains dispatchQueue functions which must be delayed until users request their dispatch\n\n    var _userDispatchedQueues = []; // contains registered Modules (name, callbacks)\n\n    var _registeredModules = []; // contains slot ids which can be excluded via _options.exclude or queueRegistery queueOptions.exclude\n    // excluded slots must be explicitly dispatched via dispatchOptions.slots\n\n    var _excludedSlotIds = []; // contains the registry data from queued registries to be used in the event of a re-queue\n    // of the same registry\n\n    var _cachedRegistries = {}; // create instance of logger for AdFuel\n\n    var logger = window.AdFuelUtils.getLogger(NAME, VERSION, 'adfuel', 'color: #4f86f7; padding: 2px'); // main AdFuel registry handler\n\n    var RegistryArray = function RegistryArrayFunc() {\n      var self = [];\n\n      self.push = function pushFunc(asset, options) {\n        if (!_initialized || _blocked || !Array.isArray(asset)) {\n          return;\n          /* Nothing to do */\n        }\n\n        perf.mark('Queue Registry [' + asset[0].rktr_id + '] Start'); // Always work with a clone of the supplied arguments to conform to the FP paradigm.\n\n        var assetClone = window.AdFuelUtils.clone(asset);\n        var optionsClone = options ? window.AdFuelUtils.clone(options) : {\n          dispatch: true\n        };\n        optionsClone.dispatch = optionsClone.dispatch || _options.autoDispatch;\n        logger.log('Asset Clone: ', assetClone); // Begin Queueing of Registry\n        // Calls preQueueCallback and postQueueCallback\n        // Dispatches queue if _options.autoDispatch\n\n        _preQueueExecuting = true;\n        var assetIndex; // Filter out slots not present in the 'slots' option or present in the 'exclude' option if supplied.\n\n        assetClone = assetClone.filter(function (slot, index) {\n          if (index === 0) return true;\n\n          if (optionsClone.slots && optionsClone.slots.length > 0 && optionsClone.slots.indexOf(slot.rktr_slot_id) !== -1) {\n            return true;\n          }\n\n          if (optionsClone.slots && optionsClone.slots.length > 0 && optionsClone.slots.indexOf(slot.rktr_slot_id) === -1) {\n            logger.log('Slot [' + slot.rktr_slot_id + '] is being excluded based on slot options.');\n            return false;\n          }\n\n          return true;\n        }); // Modify the asset to correlate to the slot map, if passed.\n\n        if (optionsClone.slotMap) {\n          logger.log('Parsing Slot Map: ', optionsClone.slotMap, assetClone);\n\n          for (assetIndex = 1; assetIndex < assetClone.length; assetIndex++) {\n            logger.log('Checking Slot: ', assetClone[assetIndex].rktr_slot_id);\n\n            if (optionsClone.slotMap[assetClone[assetIndex].rktr_slot_id]) {\n              logger.log('Overriding Element Id for: ' + assetClone[assetIndex].rktr_slot_id, optionsClone.slotMap[assetClone[assetIndex].rktr_slot_id]);\n              assetClone[assetIndex].rktr_slot_id = optionsClone.slotMap[assetClone[assetIndex].rktr_slot_id];\n            }\n          }\n        } // Modify the asset to correlate to the ad unit map, if passed.\n\n\n        if (optionsClone && optionsClone.adUnitMap) {\n          logger.log('Parsing Ad Unit Map: ', optionsClone.adUnitMap, assetClone);\n\n          if (typeof optionsClone.adUnitMap === 'string') {\n            logger.log('Overriding All Ad Units: ', optionsClone.adUnitMap);\n\n            for (assetIndex = 1; assetIndex < assetClone.length; assetIndex++) {\n              assetClone[assetIndex].rktr_ad_id = optionsClone.adUnitMap;\n            }\n          } else {\n            for (assetIndex = 1; assetIndex < assetClone.length; assetIndex++) {\n              logger.log('Checking Slot: ', assetClone[assetIndex].rktr_slot_id);\n\n              if (optionsClone.adUnitMap[assetClone[assetIndex].rktr_slot_id]) {\n                logger.log('Overriding Ad Unit for: ' + assetClone[assetIndex].rktr_slot_id, optionsClone.adUnitMap[assetClone[assetIndex].rktr_slot_id]);\n                assetClone[assetIndex].rktr_ad_id = optionsClone.adUnitMap[assetClone[assetIndex].rktr_slot_id];\n              }\n            }\n          }\n        }\n\n        var monetizedAssets = [];\n        assetClone.forEach(function (clonedAsset) {\n          var monetization = window.AdFuelUtils.isMonetized(clonedAsset);\n\n          if (asset.rktr_slot_id !== 'page' && monetization.isMonetized) {\n            clonedAsset.monetization = monetization;\n            monetizedAssets.push(clonedAsset);\n          }\n        });\n        logger.log('Monetized Slots: ', monetizedAssets); // Add asset to this array\n\n        Array.prototype.push.call(self, assetClone);\n        var slotsToDisplay = assetClone.filter(function (slot) {\n          var test1 = !optionsClone.slots || optionsClone.slots.length === 0 || optionsClone.slots.indexOf(slot.rktr_slot_id) >= 0;\n          var test2 = !optionsClone.exclude || _excludedSlotIds.length === 0 || _excludedSlotIds.indexOf(slot.rktr_slot_id) < 0;\n          var test3 = optionsClone.slots && optionsClone.slots.length > 0 || _excludedSlotIds.indexOf(slot.rktr_slot_id) < 0;\n          var validSlot = test1 && test2 && test3;\n          return validSlot;\n        });\n        logger.log('slots To display: ', slotsToDisplay);\n\n        var queueingProcedure = function _queueingProcedure() {\n          var registryName = assetClone[0].rktr_id;\n          logger.log('Queueing Procedure for: ', assetClone); // set child directed treatment flag\n\n          if (typeof assetClone[0].child_directed_treatment !== 'undefined') {\n            _setChildDirectedTreatment = assetClone[0].child_directed_treatment === 'true' ? 1 : 0;\n          } // set SafeFrame config\n\n\n          if (typeof assetClone[0].safeframe_config !== 'undefined') {\n            _setSafeFrameConfig = assetClone[0].safeframe_config;\n          }\n\n          if (!assetClone[0].singleton) {\n            // registry, non-singleton\n            // save page level targeting\n            _applyRegistryPageLevelTargeting(assetClone[0].targeting); // set inheritable adunit based on first slot\n\n\n            try {\n              _inheritableAdUnit = _removeLeadingNumericNetworkId(assetClone[1].rktr_ad_id);\n            } catch (e) {\n              logger.log('Could not find inheritable Ad Unit.', assetClone);\n            }\n          }\n\n          var pageLevelRoot = _options.siteObject || (assetClone[0].root ? assetClone[0].root.toUpperCase() : assetClone[0].site.toUpperCase());\n          logger.log('Page Level Root: ', pageLevelRoot);\n          logger.log('Grabbing targeting from window object:', window[pageLevelRoot] ? window[pageLevelRoot].adTargets : {}, window[pageLevelRoot] ? window[pageLevelRoot].slotTargets : {});\n\n          _applyWindowSiteLevelOptions(pageLevelRoot); // process slots\n\n\n          var startListeners = false;\n\n          for (var x = 1; x < assetClone.length; x++) {\n            var slot = asset[x];\n            slot.parentRegistry = registryName;\n\n            if (!slot.queued) {\n              var hasInViewRefresh = assetClone[0].hasInViewRefresh ? assetClone[0].hasInViewRefresh : slot.hasInViewRefresh;\n\n              if (hasInViewRefresh === true) {\n                startListeners = true;\n              }\n\n              logger.log('Adding slot to slots registry: ', slot, JSON.parse(JSON.stringify(_rocketeerSlots)));\n\n              _rocketeerSlots.push(slot);\n            }\n          }\n\n          if (startListeners && typeof window._startInViewListeners !== 'undefined') {\n            window._startInViewListeners();\n          }\n        };\n\n        logger.log('Executing pre-queue callbacks...');\n        executeModuleCallbacks('preQueueCallback', monetizedAssets, assetClone, optionsClone).then(function () {\n          _preQueueExecuting = false;\n          logger.log('Pre-Queue Processes Complete!');\n\n          try {\n            var PreQueueCompleteEvent = new CustomEvent('PreQueueComplete', {\n              detail: {\n                asset: asset\n              }\n            });\n            document.dispatchEvent(PreQueueCompleteEvent);\n          } catch (ex) {\n            logger.error('error dispatching custom Event: PreQueueComplete', {\n              error: ex\n            });\n          }\n\n          logger.log('Pre-Queue Complete!');\n          logger.log('Executing Queueing Procedures...');\n          queueingProcedure();\n          perf.mark('Queue Registry [' + asset[0].rktr_id + '] End');\n          perf.measure('Queue Registry [' + asset[0].rktr_id + ']', 'Queue Registry [' + asset[0].rktr_id + '] Start', 'Queue Registry [' + asset[0].rktr_id + '] End');\n\n          if (optionsClone.dispatch) {\n            logger.log('Dispatching Queue...');\n            window.AdFuel.dispatchQueue(optionsClone);\n          }\n\n          if (_delayingDispatch) {\n            _delayingDispatch = false;\n\n            _dispatchAllQueues();\n          }\n        });\n      };\n\n      return self;\n    }; // build callbacks for Async.js\n\n\n    var _buildAsyncCallback = function _buildAsyncCallback(name, callback, event, data) {\n      return {\n        name: name,\n        callback: callback,\n        event: event,\n        data: data\n      };\n    }; // execute module callbacks\n\n\n    var executeModuleCallbacks = function _executeModuleCallbacks(eventName, monetized, slots, options) {\n      var moduleCallbackPromise = new Promise(function (resolve) {\n        var moduleCallbacks = _registeredModules.filter(function (module) {\n          return !!module.callbacks[eventName];\n        }).map(function (module) {\n          return _buildAsyncCallback(module.name, function (callback) {\n            module.callbacks[eventName](monetized, callback);\n          }, eventName, monetized);\n        });\n\n        if (options && options[eventName]) {\n          // add optional preRefreshCallback\n          moduleCallbacks.push(_buildAsyncCallback(eventName + 'Options', function (callback) {\n            options[eventName](monetized, callback);\n          }, 'preRefreshCallback'));\n        }\n\n        if (eventName === 'preQueueCallback') {\n          logger.log('Adding GPT Slot Build task...');\n          moduleCallbacks.push(_buildAsyncCallback('GPT Slot Build', function asyncCallbackFunc(callback) {\n            _buildSlots(slots, options);\n\n            callback();\n          }, eventName, slots));\n        }\n\n        if (moduleCallbacks.length > 0) {\n          window.async.parallelWithTimeout(eventName, _options.defaultTimeout, moduleCallbacks, function (err, response, data) {\n            if (err) {\n              logger.log('Error calling ' + eventName + ' callbacks for registered modules', {\n                error: err\n              });\n              resolve();\n            }\n\n            resolve();\n          });\n        } else {\n          resolve();\n        }\n      });\n      return moduleCallbackPromise;\n    }; // bind a function to DOMContentLoaded\n\n\n    function _bindReady(callback) {\n      var domContentLoadedCalled = false;\n      var windowLoadCalled = false;\n      var called = false;\n\n      function ready(eventName) {\n        // ensure this only executes once for each event\n        if (eventName === \"DOMContentLoaded\" && !domContentLoadedCalled) {\n          perf.mark('AdFuel DOMContentLoaded');\n\n          if (_options.autoDispatch) {\n            logger.log('DOM Content has loaded. Auto-Dispatching Queue...');\n\n            _dispatchAllQueues();\n          }\n\n          domContentLoadedCalled = true;\n          called = true;\n          if (callback && typeof callback === 'function') callback();\n        }\n\n        if (eventName === \"window.load\" && !windowLoadCalled) {\n          perf.mark('AdFuel window.load');\n\n          if (_options.autoDispatch) {\n            logger.log('Window has loaded. Auto-Dispatching Queue...');\n\n            _dispatchAllQueues();\n          }\n\n          windowLoadCalled = true;\n          called = true;\n          if (callback && typeof callback === 'function') callback();\n        }\n      }\n\n      function tryScroll() {\n        if (!called) {\n          try {\n            document.documentElement.doScroll('left');\n            ready('DOMContentLoaded');\n          } catch (e) {\n            setTimeout(tryScroll, 10);\n          }\n        }\n      } // listen for document DOMContentLoaded/complete/loaded/interactive\n\n\n      if (document.addEventListener) {\n        window.AdFuelUtils.addEvent(document, 'DOMContentLoaded', function () {\n          ready('DOMContentLoaded');\n        });\n      } else if (document.attachEvent) {\n        // IE\n        var isFrame = false;\n\n        try {\n          isFrame = window.frameElement !== null;\n        } catch (e) {} // Do Nothing\n        // IE, the document is not inside a frame\n\n\n        if (document.documentElement.doScroll && !isFrame) {\n          tryScroll();\n        } // IE, the document is inside a frame\n\n\n        window.AdFuelUtils.addEvent(document, 'readystatechange', function () {\n          if (document.readyState === 'complete' || document.readyState === 'loaded' || document.readyState === 'interactive') {\n            ready('DOMContentLoaded');\n          }\n        });\n      } // listen for window load/onload\n\n\n      if (window.addEventListener || window.attachEvent) {\n        window.AdFuelUtils.addEvent(window, 'load', function () {\n          ready('window.load');\n        });\n      } else {\n        var fn = window.onload; // very old browser, copy old onload\n\n        window.onload = function () {\n          // replace by new onload and call the old one\n          fn && fn();\n          ready('window.load');\n        };\n      } // Fallback if adfuel is put on page post-DOMContentLoaded\n\n\n      if (document.readyState === 'complete' || document.readyState === 'loaded' || document.readyState === 'interactive') {\n        ready('DOMContentLoaded');\n      }\n    } // occurs once upon init parsing url for adsQA page-level targeting\n\n\n    function _checkForAdsQA() {\n      try {\n        var qaparam = window.AdFuelUtils.getURLParam('adsqa');\n\n        if (qaparam) {\n          var qaparamPieces = qaparam.split('%3D');\n          _adsQAPageLevelKey = qaparamPieces[0];\n          _adsQAPageLevelValue = qaparamPieces[1];\n          _dynamicTargeting.pageTargets[_adsQAPageLevelKey] = _adsQAPageLevelValue;\n        }\n      } catch (err) {\n        logger.error('checkForAdsQA', err);\n      }\n    } // this will be called each time a singleton/registry is queued\n    // no need to call addPageLevelTarget/addSlotLevelTarget, because GPT Page may or may not have been built\n\n\n    function _applyRegistryPageLevelTargeting(targeting) {\n      perf.mark('Applying Page-Level Targeting');\n\n      for (var tIndex = 0; tIndex < targeting.length; tIndex++) {\n        var target = targeting[tIndex];\n        var currentTargeting = _dynamicTargeting.pageTargets[target[0]] || [];\n\n        for (var valIndex = 0; valIndex < target[1].length; valIndex++) {\n          var value = target[1][valIndex];\n\n          if (currentTargeting.indexOf(value) < 0) {\n            currentTargeting.push(value);\n          }\n        }\n\n        _dynamicTargeting.pageTargets[target[0]] = currentTargeting;\n      }\n    } // this will be called each time a singleton/registry is queued\n    // no need to call addPageLevelTarget/addSlotLevelTarget, because GPT Page has not been built\n\n\n    function _applyWindowSiteLevelOptions(siteLvl) {\n      if (window[siteLvl]) {\n        // moved to setOptions\n        // if (window[siteLvl].refreshOnFocusOnly){\n        //    _options.refreshOnFocusOnly = true;\n        // }\n        perf.mark('Applying Window Site-Level Options.');\n\n        if (window[siteLvl].adTargets) {\n          for (var key in window[siteLvl].adTargets) {\n            if (window[siteLvl].adTargets.hasOwnProperty(key)) {\n              _dynamicTargeting.pageTargets[key] = window[siteLvl].adTargets[key];\n            }\n          }\n        }\n\n        if (window[siteLvl].slotTargets) {\n          for (var slotId in window[siteLvl].slotTargets) {\n            if (window[siteLvl].slotTargets.hasOwnProperty(slotId)) {\n              var slotTargeting = window[siteLvl].slotTargets[slotId];\n\n              if (!_dynamicTargeting.slotTargets[slotId]) {\n                _dynamicTargeting.slotTargets[slotId] = {};\n              }\n\n              for (var key2 in slotTargeting) {\n                if (slotTargeting.hasOwnProperty(key2)) {\n                  _dynamicTargeting.slotTargets[slotId][key2] = slotTargeting[key2];\n                }\n              }\n            }\n          }\n        }\n      }\n    } // this will return targeting set in the registry, by the page, and by calls to AdFuel\n\n\n    function _getCombinedSlotTargeting(rocketeerSlot) {\n      var slotTargeting = window.AdFuelUtils.clone(rocketeerSlot.targeting);\n\n      if (!Array.isArray(slotTargeting)) {\n        slotTargeting = [slotTargeting];\n      }\n\n      var dynamicSlotTargeting = _dynamicTargeting.slotTargets;\n\n      if (dynamicSlotTargeting[rocketeerSlot.rktr_slot_id]) {\n        for (var targetId in dynamicSlotTargeting[rocketeerSlot.rktr_slot_id]) {\n          if (dynamicSlotTargeting[rocketeerSlot.rktr_slot_id].hasOwnProperty(targetId)) {\n            slotTargeting.push([targetId, dynamicSlotTargeting[rocketeerSlot.rktr_slot_id][targetId]]);\n          }\n        }\n      }\n\n      return slotTargeting;\n    } // add adfuel-rendered class to container element when ad is rendered\n\n\n    function _setSlotRenderedClass() {\n      window.AdFuelUtils.addEvent(document, 'GPTRenderComplete', function (e) {\n        perf.mark('Ad Rendered [' + e.detail.divId + ']');\n        var el = document.getElementById(e.detail.divId);\n\n        if (el && el.className.indexOf('adfuel-rendered') < 0) {\n          el.className += ' adfuel-rendered';\n        }\n      });\n    } // removes adfuel-rendered class from supplied slots\n\n\n    function _removeSlotRenderedClass(slots) {\n      var slotsClone = window.AdFuelUtils.clone(slots);\n\n      if (slotsClone) {\n        if (!Array.isArray(slotsClone)) {\n          slotsClone = [slotsClone];\n        }\n\n        if (slotsClone.length === 0) {\n          slotsClone = Object.getOwnPropertyNames(_pageSlots);\n        }\n      }\n\n      for (var x = 0; x < slotsClone.length; x++) {\n        var slotId = slotsClone[x];\n        var el = document.getElementById(slotId);\n\n        if (el && el.className.indexOf('adfuel-rendered') > 0) {\n          el.className = el.className.replace('adfuel-rendered', '');\n        }\n      }\n    }\n\n    function _removePageSlots(slots) {\n      var slotsClone = window.AdFuelUtils.clone(slots);\n\n      if (slotsClone) {\n        if (!Array.isArray(slotsClone)) {\n          slotsClone = [slotsClone];\n        }\n\n        if (slotsClone.length === 0) {\n          slotsClone = Object.getOwnPropertyNames(_pageSlots);\n        }\n      }\n\n      for (var x = 0; x < slotsClone.length; x++) {\n        var slotId = slotsClone[x];\n\n        if (_pageSlots[slotId]) {\n          delete _pageSlots[slotId];\n        }\n      }\n    }\n\n    function _removeRocketeerSlots(slots) {\n      var slotsClone = window.AdFuelUtils.clone(slots);\n\n      if (slotsClone) {\n        if (!Array.isArray(slotsClone)) {\n          slotsClone = [slots];\n        }\n\n        if (slotsClone.length === 0) {\n          slotsClone = Object.getOwnPropertyNames(_pageSlots);\n        }\n      }\n\n      logger.log('Removing Rocketeer Slots: ', slotsClone);\n\n      for (var x = 0; x < _rocketeerSlots.length; x++) {\n        var slotId = _rocketeerSlots[x].rktr_slot_id;\n\n        if (slotsClone.indexOf(slotId) >= 0 || slotsClone.length === 0) {\n          _rocketeerSlots.splice(x, 1);\n        }\n      }\n    }\n\n    function _setAdIFrameTitle() {\n      window.googletag.setAdIframeTitle(_options.iframeTitle);\n    }\n\n    function addPageLevelTarget(key, value) {\n      if (!key || !value) {\n        return;\n      }\n\n      var val = value;\n      var currentTargeting = AdFuel.dynamicTargeting.pageTargets[key] || [];\n\n      if (!Array.isArray(currentTargeting)) {\n        currentTargeting = [currentTargeting];\n      }\n\n      if (!Array.isArray(val)) {\n        val = [val];\n      }\n\n      for (var vIndex = 0; vIndex < val.length; vIndex++) {\n        if (currentTargeting.indexOf(val[vIndex]) < 0) {\n          currentTargeting.push(val[vIndex]);\n        }\n      }\n\n      _dynamicTargeting.pageTargets[key] = currentTargeting.filter(function (x, i) {\n        return currentTargeting.indexOf(x) === i;\n      }); // logger.log('Setting Page-Level Targeting', key, currentTargeting);\n\n      _googleApi.executeWhenAvailable('adding page-level targeting', function () {\n        var data = {};\n        data[key] = AdFuel.dynamicTargeting.pageTargets[key];\n\n        _googleApi.setTargeting(key, AdFuel.dynamicTargeting.pageTargets[key]);\n      });\n    }\n\n    function removePageLevelTarget(key, value) {\n      _googleApi.executeWhenAvailable('removing page-level targeting', function () {\n        var targets = _dynamicTargeting.pageTargets[key];\n\n        if (typeof value !== 'undefined') {\n          if (targets.indexOf(value) >= 0) {\n            targets.splice(targets.indexOf(value), 1);\n          }\n\n          _dynamicTargeting.pageTargets[key] = targets;\n        }\n\n        if (typeof key !== 'undefined' && typeof value === 'undefined') {\n          _googleApi.clearTargeting(key);\n\n          delete _dynamicTargeting.pageTargets[key];\n          if (targets) targets.length = 0;\n        } else if (typeof key === 'undefined') {\n          _googleApi.clearTargeting();\n\n          _dynamicTargeting.pageTargets = {};\n        }\n\n        if (typeof key !== 'undefined' && targets.length === 0) {\n          delete _dynamicTargeting.pageTargets[key];\n        } else if (typeof key !== 'undefined' && targets.length > 0) {\n          _dynamicTargeting.pageTargets[key] = targets;\n\n          _googleApi.setTargeting(key, targets);\n        } else {\n          _dynamicTargeting.pageTargets = {};\n\n          if (_adsQAPageLevelKey) {\n            // restore adsQA target\n            _dynamicTargeting.pageTargets[_adsQAPageLevelKey] = _adsQAPageLevelValue;\n            addPageLevelTarget(_adsQAPageLevelKey, _adsQAPageLevelValue);\n          }\n        }\n      });\n    }\n\n    function addSlotLevelTarget(slotId, key, value) {\n      var slotTargeting = _dynamicTargeting.slotTargets[slotId] || {};\n      var currentTargeting = slotTargeting[key] || [];\n\n      if (!Array.isArray(currentTargeting)) {\n        currentTargeting = currentTargeting ? [currentTargeting] : [];\n      }\n\n      if (Array.isArray(value)) {\n        for (var vIndex = 0; vIndex < value.length; vIndex++) {\n          currentTargeting.push(value[vIndex]);\n        }\n      } else {\n        currentTargeting.push(value);\n      }\n\n      _dynamicTargeting.slotTargets[slotId] = _dynamicTargeting.slotTargets[slotId] || {};\n      _dynamicTargeting.slotTargets[slotId][key] = currentTargeting.filter(function (x, i) {\n        return currentTargeting.indexOf(x) === i;\n      });\n\n      _googleApi.executeWhenAvailable('adding slot-level targeting', function () {\n        var slot = _pageSlots[slotId];\n\n        if (slot) {\n          // found slot\n          _googleApi.setSlotTargeting(slot, key, currentTargeting);\n        }\n      });\n    }\n\n    function removeSlotLevelTarget(slotId, key, value) {\n      _googleApi.executeWhenAvailable('removing slot-level targeting', function () {\n        var slot = _pageSlots[slotId];\n\n        if (slot) {\n          // valid slot\n          var slotTargeting = {}; // get existing targeting keys\n\n          var currentTargetingKeys = slot.getTargetingKeys();\n\n          for (var keyId in currentTargetingKeys) {\n            if (currentTargetingKeys.hasOwnProperty(keyId)) {\n              var keyName = currentTargetingKeys[keyId];\n\n              if (typeof keyName !== 'function') {\n                slotTargeting[keyName] = slot.getTargeting(keyName) || '';\n              }\n            }\n          }\n\n          var defaultSlotTargeting = {\n            pos: slotTargeting.pos\n          };\n\n          if (key) {\n            // remove only key\n            if (!value) {\n              delete _dynamicTargeting.slotTargets[slotId][key];\n              delete slotTargeting[key];\n            } else {\n              slotTargeting[key].splice(slotTargeting[key].indexOf(value), 1);\n\n              _dynamicTargeting.slotTargets[slotId][key].splice(_dynamicTargeting.slotTargets[slotId][key].indexOf(value), 1);\n            }\n          } else {\n            // remove everything but pos\n            slotTargeting = {\n              pos: slotTargeting.pos\n            };\n            _dynamicTargeting.slotTargets[slotId].length = 0;\n            _dynamicTargeting.slotTargets[slotId] = defaultSlotTargeting;\n          }\n\n          _googleApi.clearSlotTargeting(slot); // add back everything in slotTargeting\n\n\n          for (var targetKey in slotTargeting) {\n            if (slotTargeting.hasOwnProperty(targetKey)) {\n              if (slotTargeting[targetKey].length === 0) {\n                slotTargeting[targetKey][0] = '';\n              }\n\n              _googleApi.setSlotTargeting(slot, targetKey, slotTargeting[targetKey]);\n            }\n          }\n        }\n      });\n    }\n\n    function _buildPageLevelGPTObject() {\n      perf.mark('Page-Level GPT Build Start');\n      var latlong = window.AdFuelUtils.readCookie('gptgeo');\n\n      if (!latlong) {\n        logger.log('Unable to retrieve location cookie', latlong);\n      } else {\n        // send lat/long to GPT\n        var latlongPieces = latlong.split('%2C');\n        var latitude = parseFloat(latlongPieces[0]);\n        var longitude = parseFloat(latlongPieces[1]);\n\n        _googleApi.executeWhenAvailable('setting location', function () {\n          _googleApi.setLocation(latitude, longitude);\n        });\n      }\n\n      if (typeof _setChildDirectedTreatment !== 'undefined') {\n        logger.log('Setting Child Directed Treat Tag : ', _setChildDirectedTreatment);\n\n        _googleApi.executeWhenAvailable('setting child_directed_treatment tag', function () {\n          _googleApi.setChildDirectedTreatmentTag(_setChildDirectedTreatment);\n        });\n      }\n\n      if (typeof _setSafeFrameConfig !== 'undefined') {\n        logger.log('Setting SafeFrame Config Tag : ', _setSafeFrameConfig);\n\n        _googleApi.executeWhenAvailable('setting safeframe_config', function () {\n          _googleApi.setSafeFrameConfig(_setSafeFrameConfig);\n        });\n      } // combine page level targeting and _dynamicTargeting.pageTargets\n\n\n      var targetings = window.AdFuelUtils.clone(_pageLevelTargeting);\n      var dynamicPageTargeting = _dynamicTargeting.pageTargets;\n\n      for (var targetId in dynamicPageTargeting) {\n        if (dynamicPageTargeting.hasOwnProperty(targetId)) {\n          targetings.push([targetId, dynamicPageTargeting[targetId]]);\n        }\n      }\n\n      for (var targetIndex = 0; targetIndex < targetings.length; targetIndex++) {\n        var targetValue = targetings[targetIndex][1]; // convert targetValue to array if necessary\n\n        if (targetValue && !Array.isArray(targetValue)) {\n          if (targetValue.indexOf(',') >= 0) {\n            targetValue = targetValue.split(',');\n          } else {\n            targetValue = [targetValue];\n          }\n        }\n\n        if (targetings[targetIndex][0] === 'exclusions') {\n          for (var i = 0; i < targetValue.length; i++) {\n            var targetKeyValue = targetings[targetIndex][1][i];\n\n            _googleApi.executeWhenAvailable('setting category exclusion', // eslint-disable-next-line\n            function _setCategoryExclusions() {\n              _googleApi.setCategoryExclusion(targetKeyValue);\n            });\n          }\n        } else {\n          var targetKey = targetings[targetIndex][0];\n          addPageLevelTarget(targetKey, targetValue);\n        }\n      }\n\n      logger.log('Setting Page-Level Targeting', targetings);\n      perf.mark('Page-Level GPT Build End');\n      perf.measure('Page-Level GPT Build', 'Page-Level GPT Build Start', 'Page-Level GPT Build End');\n    }\n\n    function _applySiteSlotTargeting(slot) {\n      var targetings = window.AdFuelUtils.clone(slot.targeting);\n      var dynamicSlotTargeting = _dynamicTargeting.slotTargets[slot.rktr_slot_id] || {};\n      var targetKey;\n\n      if (dynamicSlotTargeting[slot.rktr_slot_id]) {\n        for (targetKey in dynamicSlotTargeting[slot.rktr_slot_id]) {\n          if (dynamicSlotTargeting[slot.rktr_slot_id].hasOwnProperty(targetKey)) {\n            targetings.push([targetKey, dynamicSlotTargeting[slot.rktr_slot_id][targetKey]]);\n          }\n        }\n      }\n\n      if (window[_options.siteObject]) {\n        if (typeof window[_options.siteObject].slotTargets !== 'undefined' && typeof window[_options.siteObject].slotTargets[slot.rktr_slot_id] !== 'undefined') {\n          for (targetKey in window[_options.siteObject].slotTargets[slot.rktr_slot_id]) {\n            targetings.push([targetKey, window[_options.siteObject].slotTargets[slot.rktr_slot_id][targetKey]]);\n          }\n        }\n      }\n\n      logger.log('Setting Slot-Level Targeting', slot.rktr_slot_id, targetings);\n\n      for (var targetIndex = 0; targetIndex < targetings.length; targetIndex++) {\n        var targetValue = targetings[targetIndex][1]; // convert targetValue to array if necessary\n\n        if (targetValue && !Array.isArray(targetValue)) {\n          if (targetValue.indexOf(',') >= 0) {\n            targetValue = targetValue.split(',');\n          } else {\n            targetValue = [targetValue];\n          }\n        }\n\n        logger.log('Setting Slot Level Target: ', slot.rktr_slot_id, targetKey, targetValue);\n        targetKey = targetings[targetIndex][0];\n        addSlotLevelTarget(slot.rktr_slot_id, targetKey, targetValue);\n      }\n    }\n\n    function _renderCheck(rocketeerSlot) {\n      var unrenderedSlots = document.querySelectorAll('div#' + rocketeerSlot.rktr_slot_id);\n\n      if (unrenderedSlots.length !== 0) {\n        for (var sI = 0; sI < unrenderedSlots.length; sI++) {\n          var slotDiv = unrenderedSlots[sI];\n\n          if (slotDiv.className.indexOf('adfuel-rendered') >= 0) {\n            /* Element already has an ad rendered in it. */\n            logger.log('Found rendered slot...', rocketeerSlot.rktr_slot_id);\n          } else {\n            /* Clean element ready for rendering */\n            if (unrenderedSlots.length === 1 && _pageSlots[rocketeerSlot.rktr_slot_id]) {\n              /*\n                  If there is only one element in unrenderedSlots and a GPT Slot object\n                  already exists for this id, ignore the element count when updating the\n                  slot and clear the slot.\n                  */\n              var updatedSlot = _updateSlot(rocketeerSlot, true); // clear the slot before rendering an ad\n\n\n              clearSlots(updatedSlot.rktr_slot_id);\n              return updatedSlot;\n            }\n\n            return _updateSlot(rocketeerSlot);\n          }\n        }\n      } // slot not found\n\n\n      logger.log(\"Not building slot... Can't Find Unrendered Slot On Page\", rocketeerSlot.rktr_slot_id);\n      return null;\n    }\n\n    function _buildSlot(rocketeerSlot) {\n      var networkId = _options.networkId;\n      perf.mark('Building Slot [' + rocketeerSlot.rktr_slot_id + '] Start');\n      logger.group('Building Slot: ' + rocketeerSlot.rktr_slot_id);\n\n      if (rocketeerSlot.inherit && _inheritableAdUnit) {\n        // for inheritable slots, override adunit if there's something to inherit\n        rocketeerSlot.rktr_ad_id = _inheritableAdUnit;\n      }\n\n      var adPath = '/' + networkId + '/' + rocketeerSlot.rktr_ad_id;\n      var slotId = rocketeerSlot.rktr_slot_id;\n      var isOutOfPageSlot = rocketeerSlot.rktr_slot_id.indexOf('_oop') >= 1;\n      var action = isOutOfPageSlot ? 'Defining OOP Slot' : 'Defining Standard Slot';\n      var setSafeFrameConfig;\n\n      if (typeof rocketeerSlot.safeframe_config !== 'undefined') {\n        setSafeFrameConfig = rocketeerSlot.safeframe_config;\n      }\n\n      _googleApi.executeWhenAvailable(action, function () {\n        if (isOutOfPageSlot) {\n          _pageSlots[slotId] = _googleApi.defineOutOfPageSlot(adPath, slotId);\n        } else {\n          _pageSlots[slotId] = _googleApi.defineSlot(adPath, rocketeerSlot.sizes, slotId);\n        }\n\n        if (setSafeFrameConfig) {\n          _googleApi.setSlotSafeFrameConfig(_pageSlots[slotId], setSafeFrameConfig);\n        }\n      });\n\n      _googleApi.executeWhenAvailable('Defining slot targeting', function () {\n        var slotTargeting = _getCombinedSlotTargeting(rocketeerSlot);\n\n        logger.log('Defining Slot Targeting: ', rocketeerSlot.rktr_slot_id, slotTargeting);\n\n        for (var target in slotTargeting) {\n          if (slotTargeting.hasOwnProperty(target)) {\n            var targetValue;\n\n            if (slotTargeting[target] && slotTargeting[target][1]) {\n              targetValue = JSON.stringify(slotTargeting[target][1]);\n            } else {\n              targetValue = '';\n            }\n\n            if (targetValue) {\n              targetValue = JSON.parse(targetValue);\n              var gptSlot = _pageSlots[slotId];\n\n              if (slotTargeting[target][0] === 'exclusions') {\n                if (Array.isArray(slotTargeting[target][1])) {\n                  for (var targetIndex in slotTargeting[target][1]) {\n                    if (slotTargeting[target][1].hasOwnProperty(targetIndex)) {\n                      targetValue = slotTargeting[target][1][targetIndex];\n\n                      _googleApi.setSlotCategoryExclusion(gptSlot, targetValue);\n                    }\n                  }\n                } else {\n                  _googleApi.setSlotCategoryExclusion(gptSlot, targetValue);\n                }\n              } else {\n                var key = slotTargeting[target][0];\n\n                _googleApi.setSlotTargeting(gptSlot, key, targetValue);\n              }\n            }\n          }\n        }\n      });\n\n      logger.log('Checking Responsive Mapping For Slot', rocketeerSlot.responsive, rocketeerSlot.responsive.length);\n      rocketeerSlot.responsive = rocketeerSlot.responsive || [];\n\n      if (rocketeerSlot.responsive.length > 0) {\n        _buildSlotMapping(rocketeerSlot.rktr_slot_id, rocketeerSlot.responsive);\n      }\n\n      _applySiteSlotTargeting(rocketeerSlot);\n\n      logger.groupEnd('Building Slot: ' + rocketeerSlot.rktr_slot_id);\n      perf.mark('Building Slot [' + rocketeerSlot.rktr_slot_id + '] End');\n      perf.measure('Building Slot [' + rocketeerSlot.rktr_slot_id + ']', 'Building Slot [' + rocketeerSlot.rktr_slot_id + '] Start', 'Building Slot [' + rocketeerSlot.rktr_slot_id + '] End');\n    }\n\n    function _buildSlots(rocketeerSlots, options) {\n      /*\n              options:\n              ignoreCheck: false\n               */\n      function removeSlot(slot) {\n        var index = _rocketeerSlots.indexOf(slot);\n\n        if (index >= 0) {\n          _rocketeerSlots.splice(index, 1);\n        }\n      }\n\n      for (var slotIndex = 0; slotIndex < rocketeerSlots.length; slotIndex++) {\n        var rocketeerSlot = rocketeerSlots[slotIndex];\n        var ignoreRenderCheck = options && options.ignoreCheck;\n        var buildSlot = true;\n\n        if (!ignoreRenderCheck) {\n          // renderCheck may return an updatedSlot or null\n          // if it updates the slot, it will modify rocketeerSlot\n          if (!_renderCheck(rocketeerSlot)) {\n            // remove slot, which is no longer valid\n            removeSlot(rocketeerSlot);\n            buildSlot = false;\n          }\n        }\n\n        if (buildSlot) {\n          _buildSlot(rocketeerSlot);\n\n          _builtSlots.push(rocketeerSlot);\n\n          _queuedSlots.push(rocketeerSlot);\n\n          removeSlot(rocketeerSlot);\n        }\n      }\n\n      return _builtSlots;\n    } // clear slots- optional slotIds (object or array)\n\n\n    function clearSlots(slotIds) {\n      var slotIdsClone = slotIds || [];\n\n      if (!Array.isArray(slotIdsClone)) {\n        slotIdsClone = [slotIds];\n      }\n\n      logger.log('Clearing Slots', {\n        slotDivIds: slotIdsClone\n      });\n\n      _googleApi.executeWhenAvailable('clearing slots', function () {\n        // convert to slots\n        // what if passed slotIds are invalid?\n        var slots = [];\n\n        if (slotIdsClone.length > 0) {\n          slots = slotIdsClone.filter(function (slotId) {\n            return !!_pageSlots[slotId];\n          }).map(function (slotId) {\n            return _pageSlots[slotId];\n          });\n\n          if (slots.length === 0) {\n            return;\n          }\n        }\n\n        _googleApi.clearSlots(slots);\n      });\n    } // destroy slots- optional slotIds (object or array)\n\n\n    function destroySlots(slotIds) {\n      var slotIdsClone = slotIds || [];\n\n      if (!Array.isArray(slotIdsClone)) {\n        slotIdsClone = [slotIds];\n      }\n\n      logger.log('Destroying Slots', {\n        slotDivIds: slotIds\n      });\n\n      _googleApi.executeWhenAvailable('destroying slots', function () {\n        // convert to slots\n        // what if passed slotIds are invalid?\n        var slots = [];\n\n        if (slotIdsClone.length > 0) {\n          slots = slotIdsClone.filter(function (slotId) {\n            return !!_pageSlots[slotId];\n          }).map(function (slotId) {\n            return _pageSlots[slotId];\n          });\n\n          if (slots.length === 0) {\n            return;\n          }\n        }\n\n        _removeSlotRenderedClass(slotIdsClone);\n\n        if (typeof window.jpUnloadUnits !== 'undefined') {\n          window.jpUnloadUnits();\n        }\n\n        _googleApi.destroySlots(slots);\n\n        _removePageSlots(slotIdsClone);\n\n        _removeRocketeerSlots(slotIdsClone);\n      });\n    }\n\n    function _buildSlotMapping(slotId, responsiveMap) {\n      // transform responsiveMap- convert string values to integers, allow for \"suppress\"\n      for (var i = 0; i < responsiveMap.length; i++) {\n        var val = JSON.parse(JSON.stringify(responsiveMap[i]));\n\n        for (var x = 0; x < val.length; x++) {\n          if (Array.isArray(val[x])) {\n            for (var y = 0; y < val[x].length; y++) {\n              if (Array.isArray(val[x][y])) {\n                for (var z = 0; z < val[x][y].length; z++) {\n                  if (val[x][y][z] !== 'fluid') {\n                    val[x][y][z] = parseInt(val[x][y][z], 10);\n                  }\n                }\n              } else if (parseInt(val[x][y], 10) >= 0) {\n                val[x][y] = parseInt(val[x][y], 10);\n              } else if (val[x][y] !== 'fluid') {\n                val[x] = [];\n              }\n            }\n          } else {\n            val[x] = [];\n          }\n        }\n\n        responsiveMap[i] = val;\n      }\n\n      _googleApi.executeWhenAvailable('setting slot mappings', function () {\n        _googleApi.defineSlotSizeMapping(_pageSlots[slotId], responsiveMap);\n      });\n    }\n\n    function _updateSlot(slot, ignoreCount) {\n      var origSlotId = slot.rktr_slot_id;\n      var newSlotId = origSlotId;\n      var idArray = origSlotId.split('_');\n      var incrementer = idArray[idArray.length - 1];\n      var pageDivs = document.querySelectorAll('div#' + origSlotId);\n\n      if (pageDivs.length > 1 || pageDivs.length === 1 && ignoreCount) {\n        logger.log('updating slot div id.', {\n          slot: slot\n        });\n\n        while (_pageSlots[newSlotId]) {\n          // slot exists, so increment\n          if (idArray.length === 3) {\n            incrementer = window.AdFuelUtils.generateCacheBuster();\n          } else {\n            incrementer = parseInt(incrementer, 10) + 1;\n\n            if (incrementer < 10) {\n              incrementer = '0' + String(incrementer);\n            } else {\n              incrementer = String(incrementer);\n            }\n          }\n\n          idArray[idArray.length - 1] = incrementer;\n          newSlotId = idArray.join('_');\n        }\n\n        _updateSlotId(slot, newSlotId, origSlotId);\n\n        _updateDivId(origSlotId, newSlotId);\n      }\n\n      return slot;\n    }\n\n    function _updateSlotId(slot, newSlotId, origSlotId) {\n      slot.rktr_slot_id = newSlotId;\n\n      try {\n        var SlotIDChangeEvent = new CustomEvent('SlotIdChange', {\n          detail: {\n            asset: slot,\n            originalId: origSlotId,\n            newId: newSlotId\n          }\n        });\n        document.dispatchEvent(SlotIDChangeEvent);\n      } catch (ex) {\n        logger.error('error dispatching custom Event: SlotIdChange', {\n          error: ex\n        });\n      }\n    }\n\n    function _updateDivId(origSlotId, newSlotId) {\n      var pageDivs = document.querySelectorAll('div#' + origSlotId);\n\n      if (pageDivs.length > 0) {\n        for (var slotIndex = 0; slotIndex < pageDivs.length; slotIndex++) {\n          var el = pageDivs[slotIndex];\n\n          if (el.className.indexOf('adfuel-rendered') < 0 && pageDivs.length > 1 || pageDivs.length === 1) {\n            el.id = newSlotId;\n          }\n        }\n      }\n    }\n\n    function _isQueueDispatchable() {\n      return _initialized && _preQueueExecuting === false;\n    } // executed from init and ready, queue is only dispatchable once\n\n\n    function _dispatchAllQueues() {\n      if (_isQueueDispatchable()) {\n        if (_delayedDispatchQueues.length > 0 || _userDispatchedQueues.length > 0) {\n          logger.log('Processing delayed dispatch queues'); // process all delayed dispatch queue functions\n\n          var i;\n\n          for (i = 0; i < _delayedDispatchQueues.length; i++) {\n            _delayedDispatchQueues[i]();\n          }\n\n          for (i = 0; i < _userDispatchedQueues.length; i++) {\n            _userDispatchedQueues[i]();\n          }\n\n          _delayedDispatchQueues.length = 0;\n          _userDispatchedQueues.length = 0;\n          window.AdFuel.dispatchQueue();\n        } else if (_options.autoDispatch) {\n          logger.log('Processing all queues'); // dispatch whatever has been queued\n\n          window.AdFuel.dispatchQueue();\n        }\n      } else {\n        _delayingDispatch = true;\n      }\n    }\n\n    function dispatchQueue(dispatchOptions) {\n      /*\n              dispatchOptions:\n              preDispatchCallback\n              postDispatchCallback\n              ignoreCheck: false\n              sync: false\n              syncSlots: []\n              slots: []\n              exclude: []\n              maintainCorrelator: true\n              */\n      if (!_isQueueDispatchable()) {\n        perf.mark('Delaying Queue Dispatch');\n        logger.log('Delaying Queue Dispatch');\n        _delayingDispatch = true;\n\n        _delayedDispatchQueues.push(function () {\n          dispatchQueue(dispatchOptions);\n        });\n\n        return;\n      }\n\n      perf.mark('Dispatch Queue Start');\n      var dispatchOpts = dispatchOptions || {\n        sync: false,\n        maintainCorrelator: true\n      };\n\n      if (dispatchOpts.slots && dispatchOpts.slots.length > 0) {\n        for (var slotIndex = 0; slotIndex < dispatchOpts.slots.length; slotIndex++) {\n          if (_excludedSlotIds.indexOf(dispatchOpts.slots[slotIndex]) >= 0) {\n            _excludedSlotIds.splice(_excludedSlotIds.indexOf(dispatchOpts.slots[slotIndex]), 1);\n          }\n        }\n      }\n\n      if (_rocketeerSlots.length > 0) {\n        // display all slots or just the ones in requestOptions.slots\n        // exclude any in requestOptions.exclude\n        // if requestOptions.slots are not provided, ensure rocketeer slot is not in _excludeSlotIds (set via QueueRegistery/options.exclude)\n        // remove excluded slot ids if explicitly requested\n        if (dispatchOpts.slots && dispatchOpts.slots.length > 0 && _excludedSlotIds.length > 0) {\n          for (var i = 0; i < dispatchOpts.slots.length; i++) {\n            var indexToRemove = _excludedSlotIds.indexOf(dispatchOpts.slots[i]);\n\n            if (indexToRemove >= 0) {\n              _excludedSlotIds.splice(indexToRemove, 1);\n            }\n          }\n        }\n\n        logger.log('Built Slots: ', _builtSlots);\n\n        if (_builtSlots.length > 0) {\n          // wait on all registered modules- passing clone of slotQueue\n          var builtSlotsClone = window.AdFuelUtils.clone(_builtSlots);\n          builtSlotsClone = builtSlotsClone.filter(function (slot) {\n            var filter = typeof slot.dispatched === 'undefined' || slot.dispatched === false;\n            return filter;\n          });\n          var builtSlotIds = [];\n\n          for (var slotId = 0; slotId < builtSlotsClone.length; slotId++) {\n            var slot = builtSlotsClone[slotId];\n            slot.dispatched = true;\n            _builtSlots[slotId] = slot;\n            builtSlotIds.push(slot.rktr_slot_id);\n          }\n\n          if (builtSlotIds.length > 0) {\n            executeModuleCallbacks('preDispatchCallback', builtSlotsClone, builtSlotsClone, dispatchOptions).then(function () {\n              try {\n                var PreDispatchCompleteEvent = new CustomEvent('PreDispatchComplete', {\n                  detail: {\n                    slots: _rocketeerSlots.length\n                  }\n                });\n                document.dispatchEvent(PreDispatchCompleteEvent);\n              } catch (ex) {\n                logger.error('error dispatching custom Event: PreDispatchComplete', {\n                  error: ex\n                });\n              }\n\n              _buildPageLevelGPTObject();\n\n              logger.log('preDispatchCallback events completed.  Sending request.');\n\n              _sendRequest(builtSlotsClone, dispatchOptions).then(function (displayedSlots) {\n                perf.mark('Dispatch Queue End');\n                perf.measure('Dispatch Queue', 'Dispatch Queue Start', 'Dispatch Queue End');\n                logger.log('Displayed Slots: ', displayedSlots);\n\n                for (var index = 0; index < _queuedSlots.length; index++) {\n                  var slot = _queuedSlots[index];\n\n                  if (builtSlotIds.indexOf(slot.rktr_slot_id) >= 0) {\n                    _queuedSlots.splice(index, 1);\n\n                    index--;\n                  }\n                }\n              });\n            });\n          } else {\n            logger.log('No undispatched slots.');\n          }\n        }\n      }\n    }\n\n    var loadJSON = function _loadJSON(url, callback) {\n      perf.mark('Registry Load [' + url + '] Start');\n      var parser = document.createElement('a');\n      parser.href = url;\n      var pathname = parser.pathname.replace(/(\\.min)?(\\.js)$/, '.json');\n      var jsonURL = parser.protocol + '//' + cdnRoot + (pathname.indexOf('/') === 0 ? pathname : '/' + pathname);\n      var req = new XMLHttpRequest();\n\n      req.onload = function () {\n        var data = this.response;\n\n        try {\n          data = JSON.parse(data);\n          logger.log('JSON Parse Complete: ', data);\n          perf.mark('Registry Load [' + url + '] End');\n          perf.measure('Registry Load [' + url + ']', 'Registry Load [' + url + '] Start', 'Registry Load [' + url + '] End');\n          callback({\n            response: data.registry,\n            error: false\n          });\n        } catch (err) {\n          logger.log('JSON Parse Failed: ', err);\n          data = {\n            response: this.response,\n            error: true\n          };\n          callback(data);\n        }\n      };\n\n      try {\n        logger.log('Requesting JSON: ', jsonURL);\n        req.open('GET', jsonURL, true);\n        req.send();\n      } catch (err) {\n        logger.log('JSON Request Failed: ', err);\n        var data = {\n          response: this.response,\n          error: true\n        };\n        callback(data);\n      }\n    };\n\n    function queueRegistry(url, queueOptions) {\n      /*\n               queueOptions:\n              preDispatchCallback\n              postDispatchCallback\n              sync: false\n              syncSlots: []\n              slots: []\n              exclude: []\n              maintainCorrelator: true\n              dispatch: false  (options.autodispatch is ignored)\n              slotMap: {}\n       */\n      getFilterValue().then(function (shouldFilter) {\n        if (shouldFilter) {\n          logger.warn('Registry Blocked Due To GDPR Restrictions.');\n        } else {\n          var addScriptTag = function addScriptTag(urlParam) {\n            var scriptA = document;\n            var scriptB = scriptA.createElement('script');\n            var scriptC = scriptA.getElementsByTagName('script')[0];\n            var scriptD = /^(complete|loaded)$/;\n            var scriptE = false;\n            scriptB.type = 'text/javascript';\n            scriptB.src = urlParam;\n\n            scriptB.onload = scriptB.onreadystatechange = function () {\n              if (!scriptE && !('readyState' in scriptB && scriptD.test(scriptB.readyState))) {\n                scriptB.onload = scriptB.onreadystatechange = null;\n                scriptE = true;\n                scriptComplete();\n              }\n            };\n\n            scriptC.parentNode.insertBefore(scriptB, scriptC);\n          };\n\n          var scriptComplete = function scriptComplete() {\n            perf.mark('Registry Load [' + url + '] End');\n            perf.measure('Registry Load [' + url + ']', 'Registry Load [' + url + '] Start', 'Registry Load [' + url + '] End');\n\n            if (queueOpts.dispatch) {\n              window.AdFuel.dispatchQueue(queueOpts);\n            }\n          };\n\n          var filterSlots = function filterSlots(registry, slots) {\n            var returnData = [];\n            returnData.push(registry[0]);\n\n            if (slots && slots.length > 0) {\n              for (var x = 1; x < registry.length; x++) {\n                if (slots.indexOf(registry[x].rktr_slot_id) >= 0) {\n                  returnData.push(registry[x]);\n                }\n              }\n            } else {\n              returnData = registry;\n            }\n\n            return returnData;\n          };\n\n          var requestComplete = function requestComplete(data) {\n            if (data.error === true) {\n              logger.log('Using Script Tag Method...');\n              addScriptTag(url);\n            } else {\n              var filteredResponse = filterSlots(data.response, queueOpts.slots);\n              logger.log('Response: ', data.response);\n              _cachedRegistries[normalizedUrl] = data.response;\n              window.AdFuel.registry.push(filteredResponse, queueOpts);\n            }\n          };\n\n          logger.log('Queueing Registry: ', url, queueOptions, _options);\n\n          if (!url) {\n            logger.error('Empty Registry url');\n            return;\n          }\n\n          var queueOpts = queueOptions || {\n            // set based on autoDispatch\n            dispatch: _options.autoDispatch\n          };\n\n          if (queueOpts.exclude && queueOpts.exclude.length > 0) {\n            // add non-duplicating exclude slotIds\n            for (var i = 0; i < queueOpts.exclude.length; i++) {\n              var slotId = queueOpts.exclude[i];\n\n              if (_excludedSlotIds.indexOf(slotId) < 0) {\n                logger.log('Excluding Slot: ', slotId);\n\n                _excludedSlotIds.push(slotId);\n              }\n            }\n          }\n\n          var normalizedUrl = normalizeUrl(url);\n\n          if (_cachedRegistries[normalizedUrl]) {\n            logger.log('Queueing Cached Registry: ', _cachedRegistries[normalizedUrl], queueOpts);\n            var filteredResponse = filterSlots(_cachedRegistries[normalizedUrl], queueOpts.slots);\n            window.AdFuel.registry.push(filteredResponse, queueOpts);\n          } else {\n            logger.log('Requesting Registry: ', normalizedUrl, queueOpts);\n            loadJSON(url, requestComplete);\n          }\n        }\n      });\n    }\n\n    function _startInterval(length, steps, oninterval) {\n      var stepsClone = steps || 10;\n      var speed = length / stepsClone;\n      var count = 0;\n      var start = Date.now();\n\n      function instance() {\n        if (count++ === stepsClone) {\n          // return true to continue repeating\n          var continueInterval = oninterval();\n\n          if (continueInterval) {\n            _startInterval(length, stepsClone, oninterval);\n          }\n        } else {\n          // wait longer, basing delay upon remaining time\n          var diff = Date.now() - start - count * speed;\n          window.setTimeout(instance, speed - diff);\n        }\n      }\n\n      window.setTimeout(instance, speed);\n    }\n\n    function refresh(slotIds, refreshOptions) {\n      /** *\n                slotIds: optional array to refresh (empty/null=refresh all)\n               refreshOptions:\n              pageload: BOOLEAN (default is true)\n              interval: INT\n              preRefreshCallback: function (optional)\n              postRefreshCallback: function (optional)\n              maintainCorrelator: BOOLEAN (default is true)\n      ***/\n      perf.mark('Refresh Called');\n      var refreshOpts = refreshOptions || {};\n      var slotIdsClone = slotIds || [];\n\n      if (slotIds && !Array.isArray(slotIds) && !refreshOptions) {\n        // assume user passed refreshOptions as first argument\n        refreshOpts = slotIds;\n        slotIdsClone = [];\n      }\n\n      var monetization;\n      var monetizedAssets = [];\n\n      var rocketeerSlotsToRefresh = _rocketeerSlots.filter(function (slot) {\n        if (slotIdsClone.length === 0) {\n          monetization = window.AdFuelUtils.isMonetized(slot);\n\n          if (slot.rktr_slot_id !== 'page' && monetization.isMonetized) {\n            slot.monetization = monetization;\n            monetizedAssets.push(slot);\n          }\n\n          return true;\n        }\n\n        if (slotIds.length > 0 && slotIds.indexOf(slot.rktr_slot_id) >= 0) {\n          monetization = window.AdFuelUtils.isMonetized(slot);\n\n          if (slot.rktr_slot_id !== 'page' && monetization.isMonetized) {\n            slot.monetization = monetization;\n            monetizedAssets.push(slot);\n          }\n\n          return true;\n        }\n      });\n\n      logger.log('Monetized Assets: ', monetizedAssets);\n      logger.log(''); // default pageload to true\n\n      refreshOpts.interval = refreshOpts.interval || 0;\n      refreshOpts.pageload = typeof refreshOpts.pageload === 'undefined' ? true : refreshOpts.pageload;\n      refreshOpts.maintainCorrelator = typeof refreshOpts.maintainCorrelator === 'undefined' ? true : refreshOpts.maintainCorrelator;\n\n      var refreshSlots = function refreshSlots(monetizedAssets, rocketeerSlotsToRefresh) {\n        if (_focused || !_options.refreshOnFocusOnly) {\n          var slotsToRefresh = [];\n          var slotIdsToRefresh = [];\n          var slotIdsToCheck = [];\n\n          if (slotIdsClone.length === 0) {\n            // refresh all- build list allowing for repeated iterations via interval option\n            for (var slotId in _pageSlots) {\n              if (_pageSlots.hasOwnProperty(slotId)) {\n                slotIdsToCheck.push(slotId);\n              }\n            }\n          } else {\n            slotIdsToCheck = slotIdsClone;\n          }\n\n          for (var i = 0; i < slotIdsToCheck.length; i++) {\n            var slotIdVal = slotIdsToCheck[i];\n\n            if (document.getElementById(slotIdVal)) {\n              var slot = _pageSlots[slotIdVal];\n\n              if (slot) {\n                slotsToRefresh.push(slot);\n                slotIdsToRefresh.push(slotIdVal);\n              }\n            } else {\n              logger.log('Cannot find element on page to refresh: ' + slotIdVal);\n            }\n          }\n\n          if (slotIdsClone.length > 0 && slotIdsToRefresh.length === 0) {\n            // caller sent all invalid slotIds to refresh, so do nothing\n            return;\n          }\n\n          logger.log('Callback Parameters: ', {\n            name: 'preRefreshCallback',\n            monetization: monetizedAssets,\n            slots: rocketeerSlotsToRefresh,\n            options: refreshOpts\n          });\n          executeModuleCallbacks('preRefreshCallback', monetizedAssets, rocketeerSlotsToRefresh, refreshOpts).then(function () {\n            try {\n              var PreRefreshCompleteEvent = new CustomEvent('PreRefreshComplete', {\n                detail: {\n                  slots: slotIdsToRefresh\n                }\n              });\n              document.dispatchEvent(PreRefreshCompleteEvent);\n            } catch (ex) {\n              logger.error('error dispatching custom Event: PreRefreshComplete', {\n                error: ex\n              });\n            }\n\n            clearSlots(slotIdsToRefresh);\n\n            if (refreshOpts.pageload) {\n              _googleApi.setTargeting('pageload', 'ref');\n            } else {\n              _googleApi.clearTargeting('pageload');\n            }\n\n            _googleApi.refreshSlots(slotsToRefresh, refreshOpts);\n          });\n        }\n      };\n\n      function startInterval(interval) {\n        logger.log('starting refresh interval: ' + interval, refreshOptions);\n        var intervalInMilliseconds = interval * 1000;\n\n        _startInterval(intervalInMilliseconds, 5, function () {\n          // if the interval has been removed, stop repeating\n          if (!refreshOptions.interval || parseInt(refreshOptions.interval, 10) === 0) {\n            logger.log('stopping refresh interval: ' + interval, refreshOptions);\n            return false;\n          } // if the interval has changed, start new interval and stop repeating\n\n\n          var currentInterval = parseInt(refreshOptions.interval, 10);\n\n          if (interval !== currentInterval) {\n            logger.log('changing refresh interval: ' + interval, refreshOptions);\n            startInterval(currentInterval);\n            return false;\n          } // interval has been reached, so refresh spots\n\n\n          refreshSlots(monetizedAssets, rocketeerSlotsToRefresh); // repeat interval\n\n          return true;\n        });\n      }\n\n      if (refreshOpts.interval && parseInt(refreshOpts.interval, 10) > 0) {\n        var interval = parseInt(refreshOptions.interval, 10);\n        startInterval(interval);\n      } else {\n        refreshSlots(monetizedAssets, rocketeerSlotsToRefresh);\n      }\n    } // combined google APIs\n\n\n    var _googleApi = function createGoogleAPI() {\n      // default window.googletag.cmd\n      window.googletag = window.googletag || {};\n      window.googletag.cmd = window.googletag.cmd || [];\n      var _pubAdsConfiged = false;\n      var _isGPTAvailable = false;\n\n      function isAvailable(action, obj) {\n        if (!_isGPTAvailable) {\n          _isGPTAvailable = window.googletag.apiReady && typeof window.googletag.pubads === 'function';\n\n          if (!_isGPTAvailable && action) {\n            logger.error('GPT is unavailable - ' + action, obj);\n          }\n        }\n\n        return _isGPTAvailable;\n      }\n\n      function executeWhenAvailable(action, fn) {\n        window.googletag.cmd.push(fn);\n      }\n\n      function configurePubAds() {\n        return new Promise(function (resolve) {\n          if (!_pubAdsConfiged) {\n            // only execute once\n            _pubAdsConfiged = true;\n            window.googletag.cmd.push(function pushGPTServices() {\n              window.googletag.pubads().addEventListener('impressionViewable', function _impressionViewableFunc(event) {\n                var detail = event;\n                var slotViewableEvent = new CustomEvent('SlotViewable', {\n                  detail: detail\n                });\n                document.dispatchEvent(slotViewableEvent);\n              });\n              window.googletag.pubads().addEventListener('slotVisibilityChanged', function (event) {\n                var detail = event;\n                var slotVisibilityChanged = new CustomEvent('SlotVisibilityChanged', {\n                  detail: detail\n                });\n                document.dispatchEvent(slotVisibilityChanged);\n              });\n              window.googletag.pubads().addEventListener('slotRenderEnded', function (event) {\n                try {\n                  var detail = {};\n\n                  if (event.slot) {\n                    detail.asset = event.slot;\n                  }\n\n                  if (event.slot.getTargeting('pos')) {\n                    detail.pos = event.slot.getTargeting('pos');\n                  }\n\n                  if (event.isEmpty) {\n                    detail.empty = true;\n                  } else {\n                    detail.empty = false;\n                  }\n\n                  if (event.size) {\n                    detail.renderedSize = event.size;\n                  }\n\n                  if (event.creativeId) {\n                    detail.creativeId = event.creativeId;\n                  }\n\n                  if (event.lineItemId) {\n                    detail.lineItemId = event.lineItemId;\n                  }\n\n                  if (event.serviceName) {\n                    detail.serviceName = event.serviceName;\n                  }\n\n                  if (event.slot.getSlotElementId()) {\n                    detail.divId = event.slot.getSlotElementId();\n                  }\n\n                  var creativeIds = window.googletag && typeof window.googletag.pubads === 'function' ? window.googletag.pubads().getTargeting('creativeId') : [];\n                  var lineItemIds = window.googletag && typeof window.googletag.pubads === 'function' ? window.googletag.pubads().getTargeting('lineItemId') : [];\n\n                  if (event.creativeId && creativeIds.indexOf(event.creativeId) < 0) {\n                    creativeIds.push(event.creativeId);\n                  }\n\n                  if (event.lineItemId && lineItemIds.indexOf(event.lineItemId) < 0) {\n                    lineItemIds.push(event.lineItemId);\n                  }\n\n                  window.googletag.cmd.push(function () {\n                    window.googletag.pubads().setTargeting('creativeId', creativeIds);\n                    window.googletag.pubads().setTargeting('lineItemId', lineItemIds);\n                  });\n                  var renderCompleteEvent = new CustomEvent('GPTRenderComplete', {\n                    detail: detail\n                  });\n                  document.dispatchEvent(renderCompleteEvent);\n                } catch (ex) {\n                  logger.error('error dispatching custom Event: GPTRenderComplete', {\n                    error: ex\n                  });\n                }\n              });\n              window.googletag.pubads().addEventListener('slotOnload', function (event) {\n                var detail = event;\n                var gptSlotLoaded = new CustomEvent('GPTSlotLoaded', {\n                  detail: detail\n                });\n                document.dispatchEvent(gptSlotLoaded);\n              });\n              logger.log(\"Enabling 'Collapse Empty Divs'\");\n              window.googletag.pubads().collapseEmptyDivs(true);\n              logger.log(\"Enabling 'Async Rendering'\");\n              window.googletag.pubads().enableAsyncRendering();\n              logger.log(\"Enabling 'Single Request'\");\n              window.googletag.pubads().enableSingleRequest();\n\n              if (!window.AdFuelUtils.getURLParam('enableInitialLoad')) {\n                logger.log(\"Disabling 'Initial Load'\");\n                window.googletag.pubads().disableInitialLoad();\n              }\n\n              logger.log(\"Enabling 'Services'\");\n              window.googletag.enableServices();\n              resolve();\n            });\n          } else {\n            resolve();\n          }\n        });\n      }\n\n      function clearTargeting(key) {\n        var success = false;\n\n        if (isAvailable('clearing target', {\n          key: key ? key : 'all'\n        })) {\n          if (key) {\n            window.googletag.cmd.push(function () {\n              window.googletag.pubads().clearTargeting(key);\n            });\n          } else {\n            window.googletag.cmd.push(function () {\n              window.googletag.pubads().clearTargeting();\n            });\n          }\n\n          success = true;\n        }\n\n        return success;\n      }\n\n      function setTargeting(key, value) {\n        var success = false;\n\n        if (isAvailable('setting target', {\n          key: key,\n          value: value\n        })) {\n          // this was in refresh() to setTargeting\n          AdFuel.requestScriptText += \"googletag.pubads().setTargeting('\" + key + \"', '\" + value + \"');\\n\";\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().setTargeting(key, value);\n          });\n          success = true;\n        }\n\n        return success;\n      }\n\n      function setLocation(latitude, longitude) {\n        var success = false;\n\n        if (isAvailable('setting location', {\n          latitude: latitude,\n          logitude: longitude\n        })) {\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().setLocation(latitude, longitude);\n          });\n          success = true;\n        }\n\n        return success;\n      }\n\n      function setChildDirectedTreatmentTag(value) {\n        var success = false;\n\n        if (isAvailable('setting child directed treatment tag: ' + value)) {\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().clearTagForChildDirectedTreatment();\n            window.googletag.pubads().setTagForChildDirectedTreatment(value);\n          });\n          success = true;\n        }\n\n        return success;\n      }\n\n      function setSafeFrameConfig(value) {\n        var success = false;\n        value.sandbox = value.sandbox === true || value.sandbox === 'true';\n        value.allowOverlayExpansion = value.allowOverlayExpansion === true || value.allowOverlayExpansion === 'true';\n        value.allowPushExpansion = value.allowPushExpansion === true || value.allowPushExpansion === 'true';\n\n        if (value.sandbox !== true) {\n          logger.log('Removing invalid sandbox value');\n          delete value.sandbox;\n        }\n\n        if (isAvailable('setting SafeFrame config tag: ' + value)) {\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().setSafeFrameConfig(value);\n          });\n          success = true;\n        }\n\n        return success;\n      }\n\n      function setCategoryExclusion(value) {\n        var success = false;\n\n        if (isAvailable('setting category exclusion: ' + value)) {\n          AdFuel.requestScriptText += \"googletag.pubads().setCategoryExclusion('\" + value + \"');\\n\";\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().setCategoryExclusion(value);\n          });\n          success = true;\n        }\n\n        return success;\n      }\n\n      function updateDFPCorrelator() {\n        return true;\n      }\n\n      function defineOutOfPageSlot(adPath, slotId) {\n        var result = false;\n\n        if (isAvailable('defining out of page slot', {\n          adPath: adPath,\n          slotId: slotId\n        })) {\n          logger.log('Building OOP Slot Object', {\n            adPath: adPath,\n            slotId: slotId\n          });\n          AdFuel.requestScriptText += \"\\n_pageSlots['\" + slotId + \"'] = googletag.defineOutOfPageSlot('\" + adPath + \"', '\" + slotId + \"').addService(googletag.pubads());\\n\";\n          result = window.googletag.defineOutOfPageSlot(adPath, slotId);\n          if (result) result.addService(window.googletag.pubads());else logger.warn('Could not define OOP Slot: ', adPath, slotId);\n        }\n\n        return result;\n      }\n\n      function defineSlot(adPath, sizes, slotId) {\n        var result = false;\n\n        if (isAvailable('defining standard slot', {\n          adPath: adPath,\n          sizes: sizes,\n          slotId: slotId\n        })) {\n          logger.log('Building Standard Slot Object', {\n            adPath: adPath,\n            sizes: sizes,\n            slotId: slotId\n          });\n          AdFuel.requestScriptText += \"\\n_pageSlots['\" + slotId + \"'] = googletag.defineSlot('\" + adPath + \"', \" + JSON.stringify(sizes) + \", '\" + slotId + \"').addService(googletag.pubads());\\n\";\n          result = window.googletag.defineSlot(adPath, sizes, slotId);\n          if (result) result.addService(window.googletag.pubads());else logger.warn('Could not define Slot: ', adpath, sizes, slotId);\n        }\n\n        return result;\n      }\n\n      function setSlotCategoryExclusion(slot, value) {\n        var slotId = slot.getSlotElementId();\n        logger.log('Setting Slot Category Exclusion', {\n          slotId: slotId,\n          value: value\n        });\n        AdFuel.requestScriptText += \"_pageSlots['\" + slotId + \"'].setCategoryExclusion('\" + value + \"');\\n\";\n        slot.setCategoryExclusion(value);\n      }\n\n      function setSlotTargeting(slot, key, value) {\n        var slotId = slot.getSlotElementId();\n        logger.log('Setting Slot Targeting', {\n          slotId: slotId,\n          key: key,\n          value: value\n        });\n        AdFuel.requestScriptText += \"_pageSlots['\" + slotId + \"'].setTargeting('\" + key + \"', '\" + value + \"');\\n\";\n        slot.setTargeting(key, value);\n      }\n\n      function setSlotSafeFrameConfig(slot, value) {\n        var slotId = slot.getSlotElementId();\n        logger.log('Setting Slot SafeFrame config', {\n          slotId: slotId,\n          value: value\n        });\n        AdFuel.requestScriptText += \"_pageSlots['\" + slotId + \"'].setSafeFrameConfig(\" + value + ');\\n';\n        slot.setSafeFrameConfig(value);\n      }\n\n      function defineSlotSizeMapping(slot, responsiveMap) {\n        var slotId = slot.getSlotElementId();\n        logger.log('Setting Slot size mapping', {\n          slotId: slotId,\n          responsiveMap: responsiveMap\n        });\n        AdFuel.requestScriptText += \"_pageSlots['\" + slotId + \"'].defineSizeMapping('\" + JSON.stringify(responsiveMap) + \"');\\n\";\n        slot.defineSizeMapping(responsiveMap);\n      }\n\n      function displaySlotById(slotId) {\n        AdFuel.requestScriptText += 'googletag.display(\"' + slotId + '\");\\n';\n        window.googletag.cmd.push(function () {\n          window.googletag.display(slotId);\n        });\n      }\n\n      function clearSlotTargeting(slot) {\n        var slotId = slot.getSlotElementId();\n        logger.log('Clearing targeting for Slot: ' + slotId);\n        AdFuel.requestScriptText += \"_pageSlots['\" + slotId + \"'].clearTargeting();\\n\";\n        slot.clearTargeting();\n      }\n\n      function clearGPTSlots(slots) {\n        var slotIds = slots.length === 0 ? 'all' : slots.map(function (slot) {\n          return slot.getSlotElementId();\n        }).join(',');\n        AdFuel.requestScriptText += 'googletag.pubads().clear(' + slotIds + ');\\n';\n\n        if (slots.length > 0) {\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().clear(slots);\n          });\n        } else {\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().clear();\n          });\n        }\n      }\n\n      function destroyGPTSlots(slots) {\n        var slotIds = slots.length === 0 ? 'all' : slots.map(function (slot) {\n          return slot.getSlotElementId();\n        }).join(',');\n        AdFuel.requestScriptText += 'googletag.pubads().destroySlots(' + slotIds + ');\\n';\n\n        if (slots.length > 0) {\n          window.googletag.cmd.push(function () {\n            window.googletag.destroySlots(slots);\n          });\n        } else {\n          window.googletag.cmd.push(function () {\n            window.googletag.destroySlots();\n          });\n        }\n      }\n\n      function refreshSlots(slots, options) {\n        var opts = options || {\n          maintainCorrelator: true\n        };\n        var slotIds = slots.length === 0 ? 'all' : slots.map(function (slot) {\n          return slot.getSlotElementId();\n        }).join(',');\n        AdFuel.requestScriptText += 'googletag.pubads().refresh(' + slotIds + ');\\n';\n\n        if (slots.length > 0) {\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().refresh(slots, {\n              changeCorrelator: !opts.maintainCorrelator\n            });\n          });\n        } else {\n          window.googletag.cmd.push(function () {\n            window.googletag.pubads().refresh(null, {\n              changeCorrelator: !opts.maintainCorrelator\n            });\n          });\n        }\n      }\n\n      return {\n        executeWhenAvailable: executeWhenAvailable,\n        isAvailable: isAvailable,\n        configurePubAds: configurePubAds,\n        clearTargeting: clearTargeting,\n        setTargeting: setTargeting,\n        setLocation: setLocation,\n        setChildDirectedTreatmentTag: setChildDirectedTreatmentTag,\n        setSafeFrameConfig: setSafeFrameConfig,\n        setSlotSafeFrameConfig: setSlotSafeFrameConfig,\n        setCategoryExclusion: setCategoryExclusion,\n        updateCorrelator: updateDFPCorrelator,\n        defineOutOfPageSlot: defineOutOfPageSlot,\n        defineSlot: defineSlot,\n        setSlotCategoryExclusion: setSlotCategoryExclusion,\n        setSlotTargeting: setSlotTargeting,\n        displaySlotById: displaySlotById,\n        defineSlotSizeMapping: defineSlotSizeMapping,\n        refreshSlots: refreshSlots,\n        clearSlots: clearGPTSlots,\n        clearSlotTargeting: clearSlotTargeting,\n        destroySlots: destroyGPTSlots\n      };\n    }();\n\n    function _sendRequest(rocketeerSlots, requestOptions) {\n      /*\n              rOptions: {\n              sync: false,\n              syncSlots: [],\n              maintainCorrelator: true\n              };\n              */\n      return new Promise(function (resolve) {\n        perf.mark('Sending Request Start');\n\n        _googleApi.configurePubAds().then(function () {\n          logger.log('pubads configured...');\n          var requestOpts = requestOptions || {\n            sync: false,\n            syncSlots: [],\n            maintainCorrelator: true\n          };\n          var displayedSlots = [];\n\n          var displaySlot = function displaySlot(slotId) {\n            _googleApi.executeWhenAvailable('displaying slot', function () {\n              logger.log('Displaying Slot: ' + slotId);\n\n              _googleApi.displaySlotById(slotId);\n            });\n          };\n\n          logger.log('Dispatching Slots: ', rocketeerSlots);\n\n          for (var i = 0; i < rocketeerSlots.length; i++) {\n            var slotId = rocketeerSlots[i].rktr_slot_id;\n\n            if (!document.getElementById(slotId)) {\n              logger.log(\"Can't Find Slot On Page\", slotId);\n            } else {\n              // solve closure issue with slotId\n              if (_excludedSlotIds.indexOf(slotId) < 0 && !rocketeerSlots[i].displayed && _dispatchedSlots.indexOf(rocketeerSlots[i]) < 0) {\n                displaySlot(slotId);\n                rocketeerSlots[i].displayed = true;\n                displayedSlots.push(rocketeerSlots[i]);\n\n                _dispatchedSlots.push(rocketeerSlots[i]);\n              } else {\n                logger.log('Slot is excluded or already displayed. Not displaying: ', slotId);\n              }\n            }\n          }\n\n          if (!window.AdFuelUtils.getURLParam('enableInitialLoad')) {\n            var displayedSlotIds = displayedSlots.map(function (displayedSlot) {\n              return displayedSlot.rktr_slot_id;\n            });\n\n            _googleApi.executeWhenAvailable('refreshing slots', function () {\n              // all displayed slots must be refreshed to have their ad populated\n              // when syncing also include requestOptions.syncSlots\n              var slotsToRefresh = [];\n\n              for (var slotDivId in _pageSlots) {\n                if (_pageSlots.hasOwnProperty(slotDivId)) {\n                  // keep all slots or the ones matching requestOpts.syncSlots or the ones matching displayedSlotIds\n                  logger.log('Checking Slot for Sync: ' + slotDivId);\n\n                  if (requestOpts.sync && (!requestOpts.syncSlots || requestOpts.syncSlots.length === 0 || requestOpts.syncSlots.indexOf(slotDivId) >= 0) || displayedSlotIds.indexOf(slotDivId) >= 0) {\n                    logger.log('Syncing Slot With Request: ' + slotDivId);\n                    slotsToRefresh.push(_pageSlots[slotDivId]);\n                  }\n                }\n              }\n\n              logger.log('Slots To Refresh: ', slotsToRefresh.map(function (slot) {\n                return slot.getSlotElementId();\n              }));\n\n              _googleApi.refreshSlots(slotsToRefresh);\n\n              perf.mark('Sending Request End');\n              perf.measure('Sending Request', 'Sending Request Start', 'Sending Request End');\n            });\n\n            requestOpts.maintainCorrelator = requestOpts.maintainCorrelator || true;\n            logger.log({\n              maintainCorrelator: requestOpts.maintainCorrelator\n            });\n          }\n\n          try {\n            var requestCompleteEvent = new CustomEvent('AdFuelRequestComplete', {\n              detail: {\n                slots: JSON.parse(JSON.stringify(displayedSlots)),\n                options: requestOptions\n              }\n            });\n            document.dispatchEvent(requestCompleteEvent);\n          } catch (ex) {\n            logger.error('error dispatching custom Event: AdFuelRequestComplete', {\n              error: ex\n            });\n          }\n\n          resolve(displayedSlots);\n        });\n      });\n    }\n\n    function setBulkTargeting(targeting) {\n      if (targeting) {\n        for (var key in targeting) {\n          if (targeting.hasOwnProperty(key)) {\n            if (key === 'slotTargets') {\n              for (var key2 in targeting[key]) {\n                if (targeting[key].hasOwnProperty(key2)) {\n                  var targetGroup = targeting[key][key2];\n\n                  for (var key3 in targetGroup) {\n                    if (targetGroup.hasOwnProperty(key3)) {\n                      AdFuel.addSlotLevelTarget(key2, key3, targeting[key][key2][key3]);\n                    }\n                  }\n                }\n              }\n            } else if (key === 'adTargets') {\n              for (var key4 in targeting[key]) {\n                if (targeting[key].hasOwnProperty(key4)) {\n                  AdFuel.addPageLevelTarget(key4, targeting[key][key4]);\n                }\n              }\n            } else {\n              // For backwards compatibility\n              AdFuel.addPageLevelTarget(key, targeting[key]);\n            }\n          }\n        }\n      }\n    }\n\n    function _removeLeadingNumericNetworkId(adunit) {\n      // remove leading numeric networkId (ex:  8663477/CNN/Homepage)\n      var adUnitClone = adunit;\n\n      if (adUnitClone && adUnitClone.indexOf('/') >= 0) {\n        var nId = adUnitClone.split('/')[0];\n\n        if (parseInt(nId, 10) > 0) {\n          var adUnitArray = adUnitClone.split('/');\n          adUnitArray.splice(0, 1);\n          adUnitClone = adUnitArray.join('/');\n        }\n      }\n\n      return adUnitClone;\n    }\n\n    function _addDebugListeners() {\n      window.AdFuelUtils.addEvent(document, 'AdFuelRequestComplete', function (e) {\n        perf.mark('AdFuel Request Complete');\n        logger.log(\"AdFuel Request Complete\", {\n          requestEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'GPTRenderComplete', function (e) {\n        perf.mark('GPTRenderComplete [' + (e.detail.asset ? e.detail.asset.getSlotElementId() : 'NO ID') + ']');\n        logger.log(\"GPT Render Complete\", {\n          renderEvent: e,\n          timestamp: new Date().toLocaleTimeString(),\n          slot: e.detail.asset ? e.detail.asset.getSlotElementId() : 'NO ID'\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'SlotIdChange', function (e) {\n        logger.log(\"Slot ID Change\", {\n          idChangeEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'SlotVisibilityChanged', function (e) {\n        perf.mark('Slot Visibility Changed [' + (e.detail.slot ? e.detail.slot.getSlotElementId() : 'NO ID') + ']');\n        logger.log(\"Slot Visibility Changed\", {\n          visibilityChangedEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'SlotViewable', function (e) {\n        perf.mark('Slot Viewable [' + (e.detail.slot ? e.detail.slot.getSlotElementId() : 'NO ID') + ']');\n        logger.log(\"Slot Viewable\", {\n          viewableEvent: e,\n          timestamp: new Date().toLocaleTimeString(),\n          slot: e.detail.slot ? e.detail.slot.getSlotElementId() : 'NO ID'\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'GPTSlotLoaded', function (e) {\n        perf.mark('Slot Loaded [' + (e.detail.slot ? e.detail.slot.getSlotElementId() : 'NO ID') + ']');\n        logger.log(\"Slot Loaded\", {\n          slotOnLoadEvent: e,\n          timestamp: new Date().toLocaleTimeString(),\n          slot: e.detail.slot ? e.detail.slot.getSlotElementId() : 'NO ID'\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'PreQueueComplete', function (e) {\n        logger.log(\"PreQueueComplete\", {\n          preQueueCompleteEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'PostQueueComplete', function (e) {\n        logger.log(\"PostQueueComplete\", {\n          postQueueCompleteEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'PreDispatchComplete', function (e) {\n        logger.log(\"PreDispatchComplete\", {\n          preDispatchCompleteEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'PostDispatchComplete', function (e) {\n        logger.log(\"PostDispatchComplete\", {\n          postDispatchCompleteEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'PreRefreshComplete', function (e) {\n        logger.log(\"PreRefreshComplete\", {\n          preRefreshCompleteEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n      window.AdFuelUtils.addEvent(document, 'PostRefreshComplete', function (e) {\n        logger.log(\"PostRefreshComplete\", {\n          postRefreshCompleteEvent: e,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      });\n    }\n\n    function getFilterValue() {\n      return new Promise(function (resolve) {\n        if (_blocked !== null) {\n          resolve(_blocked);\n        } else {\n          window.AdFuelOptions.GDPR.APPLIES.then(function (applies) {\n            if (applies) {\n              var consent = window.AdFuelUtils.getConsent();\n\n              if (consent) {\n                _blocked = false;\n              } else {\n                _blocked = true;\n                logger.warn(\"GDPR Consent Not Granted or Not Found\");\n              }\n            } else {\n              _blocked = false;\n            }\n\n            resolve(_blocked);\n          });\n        }\n      });\n    }\n\n    function init() {\n      // only occur once\n      if (!_initialized) {\n        getFilterValue().then(function (shouldFilter) {\n          if (!shouldFilter) {\n            _initialized = true;\n            perf.mark('AdFuel Initialized'); // Include GPT Library\n\n            (function IncludeGPT() {\n              'use strict';\n\n              var gpta = document;\n              var gptb = gpta.createElement('script');\n              var gptc = gpta.getElementsByTagName('script')[0];\n              var gptd = document.location.protocol === 'https:';\n              gptb.type = 'text/javascript';\n              gptb.src = (gptd ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';\n              gptc.parentNode.insertBefore(gptb, gptc);\n              perf.mark('GPT Included');\n            })(); // Include Async Library\n\n            /* eslint-disable */\n\n            /*!\n            * async\n            * https://github.com/caolan/async\n            *\n            * Copyright 2010-2014 Caolan McMahon\n            * Released under the MIT license\n            */\n\n\n            (function IncludeAsyncLibrary() {\n              var async = {};\n\n              function noop() {}\n\n              function identity(v) {\n                return v;\n              }\n\n              function toBool(v) {\n                return !!v;\n              }\n\n              function notId(v) {\n                return !v;\n              } // global on the server, window in the browser\n\n\n              var previous_async; // Establish the root object, `window` (`self`) in the browser, `global`\n              // on the server, or `this` in some virtual machines. We use `self`\n              // instead of `window` for `WebWorker` support.\n\n              var root = (typeof self === \"undefined\" ? \"undefined\" : _typeof(self)) === 'object' && self.self === self && self || (typeof global === \"undefined\" ? \"undefined\" : _typeof(global)) === 'object' && global.global === global && global || this;\n\n              if (root != null) {\n                previous_async = root.async;\n              }\n\n              async.noConflict = function () {\n                root.async = previous_async;\n                return async;\n              };\n\n              function only_once(fn) {\n                return function () {\n                  if (fn === null) throw new Error(\"Callback was already called.\");\n                  fn.apply(this, arguments);\n                  fn = null;\n                };\n              }\n\n              function _once(fn) {\n                return function () {\n                  if (fn === null) return;\n                  fn.apply(this, arguments);\n                  fn = null;\n                };\n              } //// cross-browser compatiblity functions ////\n\n\n              var _toString = Object.prototype.toString;\n\n              var _isArray = Array.isArray || function (obj) {\n                return _toString.call(obj) === '[object Array]';\n              }; // Ported from underscore.js isObject\n\n\n              var _isObject = function _isObject(obj) {\n                var type = _typeof(obj);\n\n                return type === 'function' || type === 'object' && !!obj;\n              };\n\n              function _isArrayLike(arr) {\n                return _isArray(arr) || // has a positive integer length property\n                typeof arr.length === \"number\" && arr.length >= 0 && arr.length % 1 === 0;\n              }\n\n              function _arrayEach(arr, iterator) {\n                var index = -1,\n                    length = arr.length;\n\n                while (++index < length) {\n                  iterator(arr[index], index, arr);\n                }\n              }\n\n              function _map(arr, iterator) {\n                var index = -1,\n                    length = arr.length,\n                    result = Array(length);\n\n                while (++index < length) {\n                  result[index] = iterator(arr[index], index, arr);\n                }\n\n                return result;\n              }\n\n              function _range(count) {\n                return _map(Array(count), function (v, i) {\n                  return i;\n                });\n              }\n\n              function _reduce(arr, iterator, memo) {\n                _arrayEach(arr, function (x, i, a) {\n                  memo = iterator(memo, x, i, a);\n                });\n\n                return memo;\n              }\n\n              function _forEachOf(object, iterator) {\n                _arrayEach(_keys(object), function (key) {\n                  iterator(object[key], key);\n                });\n              }\n\n              function _indexOf(arr, item) {\n                for (var i = 0; i < arr.length; i++) {\n                  if (arr[i] === item) return i;\n                }\n\n                return -1;\n              }\n\n              var _keys = Object.keys || function (obj) {\n                var keys = [];\n\n                for (var k in obj) {\n                  if (obj.hasOwnProperty(k)) {\n                    keys.push(k);\n                  }\n                }\n\n                return keys;\n              };\n\n              function _keyIterator(coll) {\n                var i = -1;\n                var len;\n                var keys;\n\n                if (_isArrayLike(coll)) {\n                  len = coll.length;\n                  return function next() {\n                    i++;\n                    return i < len ? i : null;\n                  };\n                } else {\n                  keys = _keys(coll);\n                  len = keys.length;\n                  return function next() {\n                    i++;\n                    return i < len ? keys[i] : null;\n                  };\n                }\n              } // Similar to ES6's rest param (http://ariya.ofilabs.com/2013/03/es6-and-rest-parameter.html)\n              // This accumulates the arguments passed into an array, after a given index.\n              // From underscore.js (https://github.com/jashkenas/underscore/pull/2140).\n\n\n              function _restParam(func, startIndex) {\n                startIndex = startIndex == null ? func.length - 1 : +startIndex;\n                return function () {\n                  var length = Math.max(arguments.length - startIndex, 0);\n                  var rest = Array(length);\n\n                  for (var index = 0; index < length; index++) {\n                    rest[index] = arguments[index + startIndex];\n                  }\n\n                  switch (startIndex) {\n                    case 0:\n                      return func.call(this, rest);\n\n                    case 1:\n                      return func.call(this, arguments[0], rest);\n                  } // Currently unused but handle cases outside of the switch statement:\n                  // var args = Array(startIndex + 1);\n                  // for (index = 0; index < startIndex; index++) {\n                  //     args[index] = arguments[index];\n                  // }\n                  // args[startIndex] = rest;\n                  // return func.apply(this, args);\n\n                };\n              }\n\n              function _withoutIndex(iterator) {\n                return function (value, index, callback) {\n                  return iterator(value, callback);\n                };\n              } //// exported async module functions ////\n              //// nextTick implementation with browser-compatible fallback ////\n              // capture the global reference to guard against fakeTimer mocks\n\n\n              var _setImmediate = typeof setImmediate === 'function' && setImmediate;\n\n              var _delay = _setImmediate ? function (fn) {\n                // not a direct alias for IE10 compatibility\n                _setImmediate(fn);\n              } : function (fn) {\n                setTimeout(fn, 0);\n              };\n\n              if ((typeof process === \"undefined\" ? \"undefined\" : _typeof(process)) === 'object' && typeof process.nextTick === 'function') {\n                async.nextTick = process.nextTick;\n              } else {\n                async.nextTick = _delay;\n              }\n\n              async.setImmediate = _setImmediate ? _delay : async.nextTick;\n\n              async.forEach = async.each = function (arr, iterator, callback) {\n                return async.eachOf(arr, _withoutIndex(iterator), callback);\n              };\n\n              async.forEachSeries = async.eachSeries = function (arr, iterator, callback) {\n                return async.eachOfSeries(arr, _withoutIndex(iterator), callback);\n              };\n\n              async.forEachLimit = async.eachLimit = function (arr, limit, iterator, callback) {\n                return _eachOfLimit(limit)(arr, _withoutIndex(iterator), callback);\n              };\n\n              async.forEachOf = async.eachOf = function (object, iterator, callback) {\n                callback = _once(callback || noop);\n                object = object || [];\n\n                var iter = _keyIterator(object);\n\n                var key,\n                    completed = 0;\n\n                while ((key = iter()) != null) {\n                  completed += 1;\n                  iterator(object[key], key, only_once(done));\n                }\n\n                if (completed === 0) callback(null);\n\n                function done(err) {\n                  completed--;\n\n                  if (err) {\n                    callback(err);\n                  } // Check key is null in case iterator isn't exhausted\n                  // and done resolved synchronously.\n                  else if (key === null && completed <= 0) {\n                      callback(null);\n                    }\n                }\n              };\n\n              async.forEachOfSeries = async.eachOfSeries = function (obj, iterator, callback) {\n                callback = _once(callback || noop);\n                obj = obj || [];\n\n                var nextKey = _keyIterator(obj);\n\n                var key = nextKey();\n\n                function iterate() {\n                  var sync = true;\n\n                  if (key === null) {\n                    return callback(null);\n                  }\n\n                  iterator(obj[key], key, only_once(function (err) {\n                    if (err) {\n                      callback(err);\n                    } else {\n                      key = nextKey();\n\n                      if (key === null) {\n                        return callback(null);\n                      } else {\n                        if (sync) {\n                          async.setImmediate(iterate);\n                        } else {\n                          iterate();\n                        }\n                      }\n                    }\n                  }));\n                  sync = false;\n                }\n\n                iterate();\n              };\n\n              async.forEachOfLimit = async.eachOfLimit = function (obj, limit, iterator, callback) {\n                _eachOfLimit(limit)(obj, iterator, callback);\n              };\n\n              function _eachOfLimit(limit) {\n                return function (obj, iterator, callback) {\n                  callback = _once(callback || noop);\n                  obj = obj || [];\n\n                  var nextKey = _keyIterator(obj);\n\n                  if (limit <= 0) {\n                    return callback(null);\n                  }\n\n                  var done = false;\n                  var running = 0;\n                  var errored = false;\n\n                  (function replenish() {\n                    if (done && running <= 0) {\n                      return callback(null);\n                    }\n\n                    while (running < limit && !errored) {\n                      var key = nextKey();\n\n                      if (key === null) {\n                        done = true;\n\n                        if (running <= 0) {\n                          callback(null);\n                        }\n\n                        return;\n                      }\n\n                      running += 1;\n                      iterator(obj[key], key, only_once(function (err) {\n                        running -= 1;\n\n                        if (err) {\n                          callback(err);\n                          errored = true;\n                        } else {\n                          replenish();\n                        }\n                      }));\n                    }\n                  })();\n                };\n              }\n\n              function doParallel(fn) {\n                return function (obj, iterator, callback) {\n                  return fn(async.eachOf, obj, iterator, callback);\n                };\n              }\n\n              function doParallelLimit(fn) {\n                return function (obj, limit, iterator, callback) {\n                  return fn(_eachOfLimit(limit), obj, iterator, callback);\n                };\n              }\n\n              function doSeries(fn) {\n                return function (obj, iterator, callback) {\n                  return fn(async.eachOfSeries, obj, iterator, callback);\n                };\n              }\n\n              function _asyncMap(eachfn, arr, iterator, callback) {\n                callback = _once(callback || noop);\n                arr = arr || [];\n                var results = _isArrayLike(arr) ? [] : {};\n                eachfn(arr, function (value, index, callback) {\n                  iterator(value, function (err, v) {\n                    results[index] = v;\n                    callback(err);\n                  });\n                }, function (err) {\n                  callback(err, results);\n                });\n              }\n\n              async.map = doParallel(_asyncMap);\n              async.mapSeries = doSeries(_asyncMap);\n              async.mapLimit = doParallelLimit(_asyncMap); // reduce only has a series version, as doing reduce in parallel won't\n              // work in many situations.\n\n              async.inject = async.foldl = async.reduce = function (arr, memo, iterator, callback) {\n                async.eachOfSeries(arr, function (x, i, callback) {\n                  iterator(memo, x, function (err, v) {\n                    memo = v;\n                    callback(err);\n                  });\n                }, function (err) {\n                  callback(err, memo);\n                });\n              };\n\n              async.foldr = async.reduceRight = function (arr, memo, iterator, callback) {\n                var reversed = _map(arr, identity).reverse();\n\n                async.reduce(reversed, memo, iterator, callback);\n              };\n\n              async.transform = function (arr, memo, iterator, callback) {\n                if (arguments.length === 3) {\n                  callback = iterator;\n                  iterator = memo;\n                  memo = _isArray(arr) ? [] : {};\n                }\n\n                async.eachOf(arr, function (v, k, cb) {\n                  iterator(memo, v, k, cb);\n                }, function (err) {\n                  callback(err, memo);\n                });\n              };\n\n              function _filter(eachfn, arr, iterator, callback) {\n                var results = [];\n                eachfn(arr, function (x, index, callback) {\n                  iterator(x, function (v) {\n                    if (v) {\n                      results.push({\n                        index: index,\n                        value: x\n                      });\n                    }\n\n                    callback();\n                  });\n                }, function () {\n                  callback(_map(results.sort(function (a, b) {\n                    return a.index - b.index;\n                  }), function (x) {\n                    return x.value;\n                  }));\n                });\n              }\n\n              async.select = async.filter = doParallel(_filter);\n              async.selectLimit = async.filterLimit = doParallelLimit(_filter);\n              async.selectSeries = async.filterSeries = doSeries(_filter);\n\n              function _reject(eachfn, arr, iterator, callback) {\n                _filter(eachfn, arr, function (value, cb) {\n                  iterator(value, function (v) {\n                    cb(!v);\n                  });\n                }, callback);\n              }\n\n              async.reject = doParallel(_reject);\n              async.rejectLimit = doParallelLimit(_reject);\n              async.rejectSeries = doSeries(_reject);\n\n              function _createTester(eachfn, check, getResult) {\n                return function (arr, limit, iterator, cb) {\n                  function done() {\n                    if (cb) cb(getResult(false, void 0));\n                  }\n\n                  function iteratee(x, _, callback) {\n                    if (!cb) return callback();\n                    iterator(x, function (v) {\n                      if (cb && check(v)) {\n                        cb(getResult(true, x));\n                        cb = iterator = false;\n                      }\n\n                      callback();\n                    });\n                  }\n\n                  if (arguments.length > 3) {\n                    eachfn(arr, limit, iteratee, done);\n                  } else {\n                    cb = iterator;\n                    iterator = limit;\n                    eachfn(arr, iteratee, done);\n                  }\n                };\n              }\n\n              async.any = async.some = _createTester(async.eachOf, toBool, identity);\n              async.someLimit = _createTester(async.eachOfLimit, toBool, identity);\n              async.all = async.every = _createTester(async.eachOf, notId, notId);\n              async.everyLimit = _createTester(async.eachOfLimit, notId, notId);\n\n              function _findGetResult(v, x) {\n                return x;\n              }\n\n              async.detect = _createTester(async.eachOf, identity, _findGetResult);\n              async.detectSeries = _createTester(async.eachOfSeries, identity, _findGetResult);\n              async.detectLimit = _createTester(async.eachOfLimit, identity, _findGetResult);\n\n              async.sortBy = function (arr, iterator, callback) {\n                async.map(arr, function (x, callback) {\n                  iterator(x, function (err, criteria) {\n                    if (err) {\n                      callback(err);\n                    } else {\n                      callback(null, {\n                        value: x,\n                        criteria: criteria\n                      });\n                    }\n                  });\n                }, function (err, results) {\n                  if (err) {\n                    return callback(err);\n                  } else {\n                    callback(null, _map(results.sort(comparator), function (x) {\n                      return x.value;\n                    }));\n                  }\n                });\n\n                function comparator(left, right) {\n                  var a = left.criteria,\n                      b = right.criteria;\n                  return a < b ? -1 : a > b ? 1 : 0;\n                }\n              };\n\n              async.auto = function (tasks, concurrency, callback) {\n                if (typeof arguments[1] === 'function') {\n                  // concurrency is optional, shift the args.\n                  callback = concurrency;\n                  concurrency = null;\n                }\n\n                callback = _once(callback || noop);\n\n                var keys = _keys(tasks);\n\n                var remainingTasks = keys.length;\n\n                if (!remainingTasks) {\n                  return callback(null);\n                }\n\n                if (!concurrency) {\n                  concurrency = remainingTasks;\n                }\n\n                var results = {};\n                var runningTasks = 0;\n                var hasError = false;\n                var listeners = [];\n\n                function addListener(fn) {\n                  listeners.unshift(fn);\n                }\n\n                function removeListener(fn) {\n                  var idx = _indexOf(listeners, fn);\n\n                  if (idx >= 0) listeners.splice(idx, 1);\n                }\n\n                function taskComplete() {\n                  remainingTasks--;\n\n                  _arrayEach(listeners.slice(0), function (fn) {\n                    fn();\n                  });\n                }\n\n                addListener(function () {\n                  if (!remainingTasks) {\n                    callback(null, results);\n                  }\n                });\n\n                _arrayEach(keys, function (k) {\n                  if (hasError) return;\n                  var task = _isArray(tasks[k]) ? tasks[k] : [tasks[k]];\n\n                  var taskCallback = _restParam(function (err, args) {\n                    runningTasks--;\n\n                    if (args.length <= 1) {\n                      args = args[0];\n                    }\n\n                    if (err) {\n                      var safeResults = {};\n\n                      _forEachOf(results, function (val, rkey) {\n                        safeResults[rkey] = val;\n                      });\n\n                      safeResults[k] = args;\n                      hasError = true;\n                      callback(err, safeResults);\n                    } else {\n                      results[k] = args;\n                      async.setImmediate(taskComplete);\n                    }\n                  });\n\n                  var requires = task.slice(0, task.length - 1); // prevent dead-locks\n\n                  var len = requires.length;\n                  var dep;\n\n                  while (len--) {\n                    if (!(dep = tasks[requires[len]])) {\n                      throw new Error('Has nonexistent dependency in ' + requires.join(', '));\n                    }\n\n                    if (_isArray(dep) && _indexOf(dep, k) >= 0) {\n                      throw new Error('Has cyclic dependencies');\n                    }\n                  }\n\n                  function ready() {\n                    return runningTasks < concurrency && _reduce(requires, function (a, x) {\n                      return a && results.hasOwnProperty(x);\n                    }, true) && !results.hasOwnProperty(k);\n                  }\n\n                  if (ready()) {\n                    runningTasks++;\n                    task[task.length - 1](taskCallback, results);\n                  } else {\n                    addListener(listener);\n                  }\n\n                  function listener() {\n                    if (ready()) {\n                      runningTasks++;\n                      removeListener(listener);\n                      task[task.length - 1](taskCallback, results);\n                    }\n                  }\n                });\n              };\n\n              async.retry = function (times, task, callback) {\n                var DEFAULT_TIMES = 5;\n                var DEFAULT_INTERVAL = 0;\n                var attempts = [];\n                var opts = {\n                  times: DEFAULT_TIMES,\n                  interval: DEFAULT_INTERVAL\n                };\n\n                function parseTimes(acc, t) {\n                  if (typeof t === 'number') {\n                    acc.times = parseInt(t, 10) || DEFAULT_TIMES;\n                  } else if (_typeof(t) === 'object') {\n                    acc.times = parseInt(t.times, 10) || DEFAULT_TIMES;\n                    acc.interval = parseInt(t.interval, 10) || DEFAULT_INTERVAL;\n                  } else {\n                    throw new Error('Unsupported argument type for \\'times\\': ' + _typeof(t));\n                  }\n                }\n\n                var length = arguments.length;\n\n                if (length < 1 || length > 3) {\n                  throw new Error('Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)');\n                } else if (length <= 2 && typeof times === 'function') {\n                  callback = task;\n                  task = times;\n                }\n\n                if (typeof times !== 'function') {\n                  parseTimes(opts, times);\n                }\n\n                opts.callback = callback;\n                opts.task = task;\n\n                function wrappedTask(wrappedCallback, wrappedResults) {\n                  function retryAttempt(task, finalAttempt) {\n                    return function (seriesCallback) {\n                      task(function (err, result) {\n                        seriesCallback(!err || finalAttempt, {\n                          err: err,\n                          result: result\n                        });\n                      }, wrappedResults);\n                    };\n                  }\n\n                  function retryInterval(interval) {\n                    return function (seriesCallback) {\n                      setTimeout(function () {\n                        seriesCallback(null);\n                      }, interval);\n                    };\n                  }\n\n                  while (opts.times) {\n                    var finalAttempt = !(opts.times -= 1);\n                    attempts.push(retryAttempt(opts.task, finalAttempt));\n\n                    if (!finalAttempt && opts.interval > 0) {\n                      attempts.push(retryInterval(opts.interval));\n                    }\n                  }\n\n                  async.series(attempts, function (done, data) {\n                    data = data[data.length - 1];\n                    (wrappedCallback || opts.callback)(data.err, data.result);\n                  });\n                } // If a callback is passed, run this as a controll flow\n\n\n                return opts.callback ? wrappedTask() : wrappedTask;\n              };\n\n              async.waterfall = function (tasks, callback) {\n                callback = _once(callback || noop);\n\n                if (!_isArray(tasks)) {\n                  var err = new Error('First argument to waterfall must be an array of functions');\n                  return callback(err);\n                }\n\n                if (!tasks.length) {\n                  return callback();\n                }\n\n                function wrapIterator(iterator) {\n                  return _restParam(function (err, args) {\n                    if (err) {\n                      callback.apply(null, [err].concat(args));\n                    } else {\n                      var next = iterator.next();\n\n                      if (next) {\n                        args.push(wrapIterator(next));\n                      } else {\n                        args.push(callback);\n                      }\n\n                      ensureAsync(iterator).apply(null, args);\n                    }\n                  });\n                }\n\n                wrapIterator(async.iterator(tasks))();\n              };\n\n              function _parallel(eachfn, tasks, callback) {\n                callback = callback || noop;\n                var results = _isArrayLike(tasks) ? [] : {};\n                eachfn(tasks, function (task, key, callback) {\n                  task(_restParam(function (err, args) {\n                    if (args.length <= 1) {\n                      args = args[0];\n                    }\n\n                    results[key] = args;\n                    callback(err);\n                  }));\n                }, function (err) {\n                  callback(err, results);\n                });\n              }\n\n              async.parallel = function (tasks, callback) {\n                _parallel(async.eachOf, tasks, callback);\n              };\n\n              async.parallelLimit = function (tasks, limit, callback) {\n                _parallel(_eachOfLimit(limit), tasks, callback);\n              };\n\n              async.series = function (tasks, callback) {\n                _parallel(async.eachOfSeries, tasks, callback);\n              };\n\n              async.iterator = function (tasks) {\n                function makeCallback(index) {\n                  function fn() {\n                    if (tasks.length) {\n                      tasks[index].apply(null, arguments);\n                    }\n\n                    return fn.next();\n                  }\n\n                  fn.next = function () {\n                    return index < tasks.length - 1 ? makeCallback(index + 1) : null;\n                  };\n\n                  return fn;\n                }\n\n                return makeCallback(0);\n              };\n\n              async.apply = _restParam(function (fn, args) {\n                return _restParam(function (callArgs) {\n                  return fn.apply(null, args.concat(callArgs));\n                });\n              });\n\n              function _concat(eachfn, arr, fn, callback) {\n                var result = [];\n                eachfn(arr, function (x, index, cb) {\n                  fn(x, function (err, y) {\n                    result = result.concat(y || []);\n                    cb(err);\n                  });\n                }, function (err) {\n                  callback(err, result);\n                });\n              }\n\n              async.concat = doParallel(_concat);\n              async.concatSeries = doSeries(_concat);\n\n              async.whilst = function (test, iterator, callback) {\n                callback = callback || noop;\n\n                if (test()) {\n                  var next = _restParam(function (err, args) {\n                    if (err) {\n                      callback(err);\n                    } else if (test.apply(this, args)) {\n                      iterator(next);\n                    } else {\n                      callback.apply(null, [null].concat(args));\n                    }\n                  });\n\n                  iterator(next);\n                } else {\n                  callback(null);\n                }\n              };\n\n              async.doWhilst = function (iterator, test, callback) {\n                var calls = 0;\n                return async.whilst(function () {\n                  return ++calls <= 1 || test.apply(this, arguments);\n                }, iterator, callback);\n              };\n\n              async.until = function (test, iterator, callback) {\n                return async.whilst(function () {\n                  return !test.apply(this, arguments);\n                }, iterator, callback);\n              };\n\n              async.doUntil = function (iterator, test, callback) {\n                return async.doWhilst(iterator, function () {\n                  return !test.apply(this, arguments);\n                }, callback);\n              };\n\n              async.during = function (test, iterator, callback) {\n                callback = callback || noop;\n\n                var next = _restParam(function (err, args) {\n                  if (err) {\n                    callback(err);\n                  } else {\n                    args.push(check);\n                    test.apply(this, args);\n                  }\n                });\n\n                var check = function check(err, truth) {\n                  if (err) {\n                    callback(err);\n                  } else if (truth) {\n                    iterator(next);\n                  } else {\n                    callback(null);\n                  }\n                };\n\n                test(check);\n              };\n\n              async.doDuring = function (iterator, test, callback) {\n                var calls = 0;\n                async.during(function (next) {\n                  if (calls++ < 1) {\n                    next(null, true);\n                  } else {\n                    test.apply(this, arguments);\n                  }\n                }, iterator, callback);\n              };\n\n              function _queue(worker, concurrency, payload) {\n                if (concurrency == null) {\n                  concurrency = 1;\n                } else if (concurrency === 0) {\n                  throw new Error('Concurrency must not be zero');\n                }\n\n                function _insert(q, data, pos, callback) {\n                  if (callback != null && typeof callback !== \"function\") {\n                    throw new Error(\"task callback must be a function\");\n                  }\n\n                  q.started = true;\n\n                  if (!_isArray(data)) {\n                    data = [data];\n                  }\n\n                  if (data.length === 0 && q.idle()) {\n                    // call drain immediately if there are no tasks\n                    return async.setImmediate(function () {\n                      q.drain();\n                    });\n                  }\n\n                  _arrayEach(data, function (task) {\n                    var item = {\n                      data: task,\n                      callback: callback || noop\n                    };\n\n                    if (pos) {\n                      q.tasks.unshift(item);\n                    } else {\n                      q.tasks.push(item);\n                    }\n\n                    if (q.tasks.length === q.concurrency) {\n                      q.saturated();\n                    }\n                  });\n\n                  async.setImmediate(q.process);\n                }\n\n                function _next(q, tasks) {\n                  return function () {\n                    workers -= 1;\n                    var removed = false;\n                    var args = arguments;\n\n                    _arrayEach(tasks, function (task) {\n                      _arrayEach(_workersList, function (worker, index) {\n                        if (worker === task && !removed) {\n                          _workersList.splice(index, 1);\n\n                          removed = true;\n                        }\n                      });\n\n                      task.callback.apply(task, args);\n                    });\n\n                    if (q.tasks.length + workers === 0) {\n                      q.drain();\n                    }\n\n                    q.process();\n                  };\n                }\n\n                var workers = 0;\n                var _workersList = [];\n                var q = {\n                  tasks: [],\n                  concurrency: concurrency,\n                  payload: payload,\n                  saturated: noop,\n                  empty: noop,\n                  drain: noop,\n                  started: false,\n                  paused: false,\n                  push: function push(data, callback) {\n                    _insert(q, data, false, callback);\n                  },\n                  kill: function kill() {\n                    q.drain = noop;\n                    q.tasks = [];\n                  },\n                  unshift: function unshift(data, callback) {\n                    _insert(q, data, true, callback);\n                  },\n                  process: function process() {\n                    while (!q.paused && workers < q.concurrency && q.tasks.length) {\n                      var tasks = q.payload ? q.tasks.splice(0, q.payload) : q.tasks.splice(0, q.tasks.length);\n\n                      var data = _map(tasks, function (task) {\n                        return task.data;\n                      });\n\n                      if (q.tasks.length === 0) {\n                        q.empty();\n                      }\n\n                      workers += 1;\n\n                      _workersList.push(tasks[0]);\n\n                      var cb = only_once(_next(q, tasks));\n                      worker(data, cb);\n                    }\n                  },\n                  length: function length() {\n                    return q.tasks.length;\n                  },\n                  running: function running() {\n                    return workers;\n                  },\n                  workersList: function workersList() {\n                    return _workersList;\n                  },\n                  idle: function idle() {\n                    return q.tasks.length + workers === 0;\n                  },\n                  pause: function pause() {\n                    q.paused = true;\n                  },\n                  resume: function resume() {\n                    if (q.paused === false) {\n                      return;\n                    }\n\n                    q.paused = false;\n                    var resumeCount = Math.min(q.concurrency, q.tasks.length); // Need to call q.process once per concurrent\n                    // worker to preserve full concurrency after pause\n\n                    for (var w = 1; w <= resumeCount; w++) {\n                      async.setImmediate(q.process);\n                    }\n                  }\n                };\n                return q;\n              }\n\n              async.queue = function (worker, concurrency) {\n                var q = _queue(function (items, cb) {\n                  worker(items[0], cb);\n                }, concurrency, 1);\n\n                return q;\n              };\n\n              async.priorityQueue = function (worker, concurrency) {\n                function _compareTasks(a, b) {\n                  return a.priority - b.priority;\n                }\n\n                function _binarySearch(sequence, item, compare) {\n                  var beg = -1,\n                      end = sequence.length - 1;\n\n                  while (beg < end) {\n                    var mid = beg + (end - beg + 1 >>> 1);\n\n                    if (compare(item, sequence[mid]) >= 0) {\n                      beg = mid;\n                    } else {\n                      end = mid - 1;\n                    }\n                  }\n\n                  return beg;\n                }\n\n                function _insert(q, data, priority, callback) {\n                  if (callback != null && typeof callback !== \"function\") {\n                    throw new Error(\"task callback must be a function\");\n                  }\n\n                  q.started = true;\n\n                  if (!_isArray(data)) {\n                    data = [data];\n                  }\n\n                  if (data.length === 0) {\n                    // call drain immediately if there are no tasks\n                    return async.setImmediate(function () {\n                      q.drain();\n                    });\n                  }\n\n                  _arrayEach(data, function (task) {\n                    var item = {\n                      data: task,\n                      priority: priority,\n                      callback: typeof callback === 'function' ? callback : noop\n                    };\n                    q.tasks.splice(_binarySearch(q.tasks, item, _compareTasks) + 1, 0, item);\n\n                    if (q.tasks.length === q.concurrency) {\n                      q.saturated();\n                    }\n\n                    async.setImmediate(q.process);\n                  });\n                } // Start with a normal queue\n\n\n                var q = async.queue(worker, concurrency); // Override push to accept second parameter representing priority\n\n                q.push = function (data, priority, callback) {\n                  _insert(q, data, priority, callback);\n                }; // Remove unshift function\n\n\n                delete q.unshift;\n                return q;\n              };\n\n              async.cargo = function (worker, payload) {\n                return _queue(worker, 1, payload);\n              };\n\n              function _console_fn(name) {\n                return _restParam(function (fn, args) {\n                  fn.apply(null, args.concat([_restParam(function (err, args) {\n                    if ((typeof console === \"undefined\" ? \"undefined\" : _typeof(console)) === 'object') {\n                      if (err) {\n                        if (console.error) {\n                          console.error(err);\n                        }\n                      } else if (console[name]) {\n                        _arrayEach(args, function (x) {\n                          console[name](x);\n                        });\n                      }\n                    }\n                  })]));\n                });\n              }\n\n              async.log = _console_fn('log');\n              async.dir = _console_fn('dir');\n              /*async.info = _console_fn('info');\n              async.warn = _console_fn('warn');\n              async.error = _console_fn('error');*/\n\n              async.memoize = function (fn, hasher) {\n                var memo = {};\n                var queues = {};\n                var has = Object.prototype.hasOwnProperty;\n                hasher = hasher || identity;\n\n                var memoized = _restParam(function memoized(args) {\n                  var callback = args.pop();\n                  var key = hasher.apply(null, args);\n\n                  if (has.call(memo, key)) {\n                    async.setImmediate(function () {\n                      callback.apply(null, memo[key]);\n                    });\n                  } else if (has.call(queues, key)) {\n                    queues[key].push(callback);\n                  } else {\n                    queues[key] = [callback];\n                    fn.apply(null, args.concat([_restParam(function (args) {\n                      memo[key] = args;\n                      var q = queues[key];\n                      delete queues[key];\n\n                      for (var i = 0, l = q.length; i < l; i++) {\n                        q[i].apply(null, args);\n                      }\n                    })]));\n                  }\n                });\n\n                memoized.memo = memo;\n                memoized.unmemoized = fn;\n                return memoized;\n              };\n\n              async.unmemoize = function (fn) {\n                return function () {\n                  return (fn.unmemoized || fn).apply(null, arguments);\n                };\n              };\n\n              function _times(mapper) {\n                return function (count, iterator, callback) {\n                  mapper(_range(count), iterator, callback);\n                };\n              }\n\n              async.times = _times(async.map);\n              async.timesSeries = _times(async.mapSeries);\n\n              async.timesLimit = function (count, limit, iterator, callback) {\n                return async.mapLimit(_range(count), limit, iterator, callback);\n              };\n\n              async.seq = function ()\n              /* functions... */\n              {\n                var fns = arguments;\n                return _restParam(function (args) {\n                  var that = this;\n                  var callback = args[args.length - 1];\n\n                  if (typeof callback == 'function') {\n                    args.pop();\n                  } else {\n                    callback = noop;\n                  }\n\n                  async.reduce(fns, args, function (newargs, fn, cb) {\n                    fn.apply(that, newargs.concat([_restParam(function (err, nextargs) {\n                      cb(err, nextargs);\n                    })]));\n                  }, function (err, results) {\n                    callback.apply(that, [err].concat(results));\n                  });\n                });\n              };\n\n              async.compose = function ()\n              /* functions... */\n              {\n                return async.seq.apply(null, Array.prototype.reverse.call(arguments));\n              };\n\n              function _applyEach(eachfn) {\n                return _restParam(function (fns, args) {\n                  var go = _restParam(function (args) {\n                    var that = this;\n                    var callback = args.pop();\n                    return eachfn(fns, function (fn, _, cb) {\n                      fn.apply(that, args.concat([cb]));\n                    }, callback);\n                  });\n\n                  if (args.length) {\n                    return go.apply(this, args);\n                  } else {\n                    return go;\n                  }\n                });\n              }\n\n              async.applyEach = _applyEach(async.eachOf);\n              async.applyEachSeries = _applyEach(async.eachOfSeries);\n\n              async.forever = function (fn, callback) {\n                var done = only_once(callback || noop);\n                var task = ensureAsync(fn);\n\n                function next(err) {\n                  if (err) {\n                    return done(err);\n                  }\n\n                  task(next);\n                }\n\n                next();\n              };\n\n              function ensureAsync(fn) {\n                return _restParam(function (args) {\n                  var callback = args.pop();\n                  args.push(function () {\n                    var innerArgs = arguments;\n\n                    if (sync) {\n                      async.setImmediate(function () {\n                        callback.apply(null, innerArgs);\n                      });\n                    } else {\n                      callback.apply(null, innerArgs);\n                    }\n                  });\n                  var sync = true;\n                  fn.apply(this, args);\n                  sync = false;\n                });\n              }\n\n              async.ensureAsync = ensureAsync;\n              async.constant = _restParam(function (values) {\n                var args = [null].concat(values);\n                return function (callback) {\n                  return callback.apply(this, args);\n                };\n              });\n\n              async.wrapSync = async.asyncify = function asyncify(func) {\n                return _restParam(function (args) {\n                  var callback = args.pop();\n                  var result;\n\n                  try {\n                    result = func.apply(this, args);\n                  } catch (e) {\n                    return callback(e);\n                  } // if result is Promise object\n\n\n                  if (_isObject(result) && typeof result.then === \"function\") {\n                    result.then(function (value) {\n                      callback(null, value);\n                    })[\"catch\"](function (err) {\n                      callback(err.message ? err : new Error(err));\n                    });\n                  } else {\n                    callback(null, result);\n                  }\n                });\n              }; // async.parallel with timeout\n              // http://davidbcalhoun.com/2014/async.parallel-with-a-simple-timeout-node-js/\n\n\n              async.parallelWithTimeout = function (action, timeoutInMilliseconds, tasks, callback) {\n                // tasks[]: name, callback\n                // create wrapper functions to track completion of callback\n                logger.log('tasks: ', tasks);\n                var trackedTasks = tasks.map(function (task) {\n                  return function (trackedCallback) {\n                    task.callback(function (err, result) {\n                      task.isCompleted = true;\n                      logger.log('executing module trackedCallback.', task);\n                      trackedCallback(err, result);\n                    });\n                  };\n                });\n                window.async.parallel(trackedTasks, function (err, result) {\n                  // after all tasks are complete\n                  // if timeout occurred (and was cleared), callback has already been called\n                  // otherwise, clear the timeout and return the results\n                  if (timeout) {\n                    // cancel timeout (if timeout was set longer, and all parallel tasks finished sooner)\n                    clearTimeout(timeout); // passthrough the data to the callback\n\n                    logger.log('executing callback on all task completion.');\n                    callback(err, result);\n                  }\n                });\n                var timeout = setTimeout(function () {\n                  // remove timeout, indicating errored out\n                  timeout = null;\n                  var timedOutCallbacks = []; // log all non-completed callbacks\n\n                  for (var i = 0; i < tasks.length; i++) {\n                    if (tasks[i].isCompleted === false) {\n                      logger.log({\n                        task: tasks[i]\n                      });\n                      timedOutCallbacks.push(tasks[i].name + ' ' + tasks[i].event);\n                    }\n                  }\n\n                  if (timedOutCallbacks.length > 0) {\n                    logger.log('executing callback on timeout.', timedOutCallbacks);\n                    callback(timedOutCallbacks.length + ' callback(s) timed out out after ' + timeoutInMilliseconds + 'ms.', null, {\n                      callbacks: timedOutCallbacks,\n                      tasks: tasks\n                    });\n                  } else {\n                    callback(null);\n                  } // timeout error\n\n                }, timeoutInMilliseconds);\n              };\n\n              window.async = async;\n              /* eslint-enable */\n            })();\n\n            if (window.AdFuelUtils.getURLParam('debug')) _addDebugListeners();\n\n            _setSlotRenderedClass();\n\n            logger.log('Checking for AdsQA...');\n\n            _checkForAdsQA();\n\n            logger.log('Binding dispatch to DOMContentLoaded and window.load...');\n\n            _bindReady();\n\n            _googleApi.executeWhenAvailable('set ad iframe title', _setAdIFrameTitle);\n\n            _dispatchAllQueues();\n\n            try {\n              // trigger AdFuelCreated event, so pre-loaded modules can register\n              var adFuelCreatedEvent = new CustomEvent('AdFuelCreated', {\n                detail: {\n                  AdFuel: window.AdFuel\n                }\n              });\n              document.dispatchEvent(adFuelCreatedEvent);\n            } catch (ex) {\n              logger.error('error dispatching custom Event: AdFuelCreated', {\n                error: ex\n              });\n            }\n          }\n        });\n      }\n    }\n\n    function getQueuedSlots() {\n      return window.AdFuelUtils.clone(_queuedSlots);\n    }\n\n    function getSlotDetails(slotId) {\n      var matchingRocketeerSlot;\n\n      for (var i = 0; i < window.AdFuel.registry.length; i++) {\n        var reg = window.AdFuel.registry[i];\n\n        for (var j = 1; j < reg.length; j++) {\n          var rocketeerSlot = reg[j];\n\n          if (rocketeerSlot.rktr_slot_id === slotId) {\n            matchingRocketeerSlot = window.AdFuelUtils.clone(rocketeerSlot);\n          }\n        }\n      }\n\n      var adUnitPath;\n      var slotTargeting = {};\n      var slot = _pageSlots[slotId];\n\n      if (slot) {\n        // get adUnit\n        adUnitPath = slot.getAdUnitPath(); // get targeting keys\n\n        var currentTargetingKeys = slot.getTargetingKeys();\n\n        for (var keyId in currentTargetingKeys) {\n          if (currentTargetingKeys.hasOwnProperty(keyId)) {\n            var keyName = currentTargetingKeys[keyId];\n            slotTargeting[keyName] = slot.getTargeting(keyName);\n          }\n        }\n      }\n\n      return {\n        adUnit: adUnitPath,\n        slot: matchingRocketeerSlot,\n        slotTargeting: slotTargeting\n      };\n    }\n\n    function registerModule(name, callbacks, version, options) {\n      getFilterValue().then(function (shouldFilter) {\n        if (shouldFilter) {\n          logger.log('GDPR Consent Not Granted or Not Found. Not Registering Module.');\n        } else {\n          logger.log('registering module: ' + name);\n          perf.mark('Registering Module: ' + name);\n          var index = -1;\n\n          for (var i = 0; i < _registeredModules.length; i++) {\n            if (_registeredModules[i].name === name) {\n              index = i;\n            }\n          }\n\n          version = version || 'Unspecified';\n          options = options || {};\n\n          if (index >= 0) {\n            // replace callbacks\n            _registeredModules[index] = {\n              name: name,\n              version: version,\n              callbacks: callbacks,\n              options: options\n            };\n          } else {\n            // add module\n            _registeredModules.push({\n              name: name,\n              version: version,\n              callbacks: callbacks,\n              options: options\n            });\n          }\n        }\n      });\n    }\n\n    function unregisterModule(name) {\n      // remove module, if it's found\n      var indexToRemove = -1;\n\n      for (var i = 0; i < _registeredModules.length; i++) {\n        if (_registeredModules[i].name === name) {\n          indexToRemove = i;\n        }\n      }\n\n      if (indexToRemove >= 0) {\n        _registeredModules.splice(indexToRemove, 1);\n      }\n    }\n\n    function setOptions(options) {\n      if (options) {\n        // apply options\n        if (options.exclude && options.exclude.length > 0) {\n          // add non-duplicating exclude slotIds\n          for (var i = 0; i < options.exclude.length; i++) {\n            var slotId = options.exclude[i];\n\n            if (_excludedSlotIds.indexOf(slotId) < 0) {\n              logger.log('Excluding Slot Id: ', slotId);\n\n              _excludedSlotIds.push(slotId);\n            }\n          }\n        }\n\n        for (var key in options) {\n          if (options.hasOwnProperty(key)) {\n            _options[key] = options[key];\n          }\n        }\n      }\n    }\n\n    function updateCorrelator() {\n      return _googleApi.updateCorrelator();\n    }\n\n    var normalizeUrl = function _normalizeUrl(urlString) {\n      var options = Object.assign({\n        normalizeProtocol: false,\n        normalizeHttps: true,\n        normalizeHttp: false,\n        stripFragment: true,\n        stripWWW: true,\n        removeQueryParameters: true,\n        removeTrailingSlash: true,\n        removeDirectoryIndex: false\n      }, {});\n      var urlStringInput = urlString.trim();\n      var hasRelativeProtocol = urlString[0] === '/' && urlString[1] === '/';\n      var isRelativeUrl = !hasRelativeProtocol && /^\\.*\\//.test(urlString); // Prepend protocol\n\n      if (!isRelativeUrl) {\n        urlStringInput = urlString.replace(/^(?!(?:\\w+:)?\\/\\/)|^\\/\\//, 'http://');\n      }\n\n      var urlObj = document.createElement('a');\n      urlObj.href = urlStringInput;\n\n      if (options.normalizeHttps && options.normalizeHttp) {\n        throw new Error('The `normalizeHttp` and `normalizeHttps` options cannot be used together');\n      }\n\n      if (options.normalizeHttp && urlObj.protocol === 'http:') {\n        urlObj.protocol = 'https:';\n      }\n\n      if (options.normalizeHttps && urlObj.protocol === 'https:') {\n        urlObj.protocol = 'http:';\n      } // Remove fragment\n\n\n      if (options.stripFragment) {\n        urlObj.hash = '';\n      } // Remove duplicate slashes if not preceded by a protocol\n\n\n      if (urlObj.pathname) {\n        // TODO: Use the following instead when targeting Node.js 10\n        // `urlObj.pathname = urlObj.pathname.replace(/(?<!https?:)\\/{2,}/g, '/');`\n        urlObj.pathname = urlObj.pathname.replace(/((?![https?:]).)\\/{2,}/g, function _pathnameReplace(_, p1) {\n          if (/^(?!\\/)/g.test(p1)) {\n            return p1 + '/';\n          }\n\n          return '/';\n        });\n      } // Decode URI octets\n\n\n      if (urlObj.pathname) {\n        urlObj.pathname = decodeURI(urlObj.pathname);\n      }\n\n      if (urlObj.hostname) {\n        // Remove trailing dot\n        urlObj.hostname = urlObj.hostname.replace(/\\.$/, ''); // Remove `www.`\n\n        if (options.stripWWW) {\n          urlObj.hostname = urlObj.hostname.replace(/^www\\./, '');\n        }\n      } // Remove query unwanted parameters\n\n\n      if (options.removeQueryParameters) {\n        urlObj.search = '';\n      } // Take advantage of many of the Node `url` normalizations\n\n\n      urlStringInput = urlObj.href; // Remove ending `/`\n\n      if (options.removeTrailingSlash || urlObj.pathname === '/') {\n        urlStringInput = urlString.replace(/\\/$/, '');\n      } // Restore relative protocol, if applicable\n\n\n      if (hasRelativeProtocol && !options.normalizeProtocol) {\n        urlStringInput = urlString.replace(/^http:\\/\\//, '//');\n      }\n\n      return urlStringInput;\n    };\n\n    return {\n      init: init,\n      setOptions: setOptions,\n      addEvent: window.AdFuelUtils.addEvent,\n      dynamicTargeting: _dynamicTargeting,\n      setBulkTargeting: setBulkTargeting,\n      dispatchQueue: dispatchQueue,\n      queueRegistry: queueRegistry,\n      getQueuedSlots: getQueuedSlots,\n      getSlotDetails: getSlotDetails,\n      refresh: refresh,\n      destroySlots: destroySlots,\n      clearSlots: clearSlots,\n      removePageLevelTarget: removePageLevelTarget,\n      removeSlotLevelTarget: removeSlotLevelTarget,\n      addPageLevelTarget: addPageLevelTarget,\n      addSlotLevelTarget: addSlotLevelTarget,\n      registry: new RegistryArray(),\n      requestScriptText: '',\n      updateCorrelator: updateCorrelator,\n      // module registration\n      registerModule: registerModule,\n      unregisterModule: unregisterModule,\n      registeredModules: _registeredModules,\n      // for debug\n      __VERSION__: function () {\n        return VERSION;\n      }(),\n      __OPTIONS__: function () {\n        return _options;\n      }(),\n      rocketeerSlots: _rocketeerSlots,\n      pageSlots: _pageSlots,\n      builtSLots: _builtSlots,\n      queuedSlots: _queuedSlots,\n      cachedRegistries: _cachedRegistries // /////////////////////////////////////////////////\n\n    };\n  }();\n\n  window.AdFuel.init();\n}"},191:function(n,e){!function(){"use strict";var n;try{CNN.INJECTOR.createDeferredForFeature("header1"),CNN.INJECTOR.createDeferredForFeature("header2"),CNN.INJECTOR.createDeferredForFeature("footer"),CNN.INJECTOR.createDeferredForFeature("videodemanddust"),n=["onZonesAndDomReady","onZoneRendered"],CNN.INJECTOR.registerEvents(n),CNN.INJECTOR.scriptComplete("header1"),CNN.INJECTOR.scriptComplete("header2")}catch(n){console.log(n)}}()},246:function(n,e){jQuery(document).onZonesAndDomReady(function(){"use strict";fastdom.measure(function(){var n,e,t=jQuery(".js__image--expandable").width(),i=!1,o=700,r=30,a=!(!Modernizr||Modernizr.phone||Modernizr.mobile||Modernizr.tablet),s=0!==jQuery("html.mobile").length,l=jQuery(window),d=!0,u="36px",c=CNN.Utils.exists;function g(n,e,t){fastdom.mutate(function(){jQuery(n).off(e).on(e,t)})}function p(n,t,i,r){var s,l,d,c=!!i;!0!==c&&!0!==r||(l=t.find(".media__video--responsive"),s=l.attr("id"),"fave"===CNN.VideoPlayer.getLibraryName(s)&&FAVE.player.getInstance(s).resume()),d=function(){var i,d=t.parents(".el__embedded"),g=t.find(".media__video--thumbnail"),p=t.find(".el__storyelements--close"),f=d.find(".video-red-spinner"),m=l||t.find(".media__video--responsive"),h=m.find("object").get(0),_=m.find("video").get(0),v=s||m.attr("id"),I=navigator.userAgent.toLowerCase();void 0===e&&(e=t.width()),!1===c&&!0!==r&&"fave"===CNN.VideoPlayer.getLibraryName(v)&&FAVE.player.getInstance(v).resume(),i=function(){g.css("position",""),t.stop().animate({width:"100%","margin-top":u,"margin-right":0},o,function(){fastdom.mutate(function(){"videoLoader"===CNN.VideoPlayer.getLibraryName(v)&&(a?(f.show(),-1===I.indexOf("msie")&&-1===I.indexOf("trident")||void 0===h||h.replayContent()):void 0!==_&&_.play(),t.find(".el__video__play-button").triggerHandler("click")),d.addClass("el__embedded--open")})}),t.show().addClass("el__video--expandfull").removeClass(n),m.show(),window.innerWidth>CNN.minWidthForExpandElements?(p.show(),p.css("display","block")):(p.hide(),p.css("display","none")),FAVE.settings.enabled&&jQuery(window).on("orientationchange",function(){fastdom.mutate(function(){window.innerWidth>CNN.minWidthForExpandElements?(p.show(),p.css("display","block")):(p.hide(),p.css("display","none"))})})},!0===r?i():fastdom.mutate(i)},!0===r?d():fastdom.measure(d)}function f(n,t,i){fastdom.measure(function(){var i,r=t.parents(".el__embedded"),s=r.find(".media__video--thumbnail"),l=r.find(".media__video--responsive"),d=r.find(".video-red-spinner"),u=l.find("object").get(0),c=l.find("video").get(0),g=l.attr("id"),p=navigator.userAgent.toLowerCase();t=t.parent(),fastdom.mutate(function(){r.removeClass("el__embedded--open"),t.stop().animate({width:e,"margin-top":"10px","margin-right":"30px"},o,function(){fastdom.mutate(function(){t.css("width","")})}),t.find(".el__video__close--expandable").hide(),t.addClass(n).removeClass("el__video--expandfull"),l.hide(),s.show(),s.css("position","relative"),"fave"===CNN.VideoPlayer.getLibraryName(g)?FAVE.player.getInstance(g).pause():a?(d.hide(),-1===p.indexOf("msie")&&-1===p.indexOf("trident")||void 0===u||u.stopContent()):void 0!==c&&c.pause()}),i=r.find(".js-media__video .js-video__end-slate").eq(0),fastdom.mutate(function(){i.removeClass("video__end-slate--active").addClass("video__end-slate--inactive"),r.find(".js-video-demand").show()})}),i.stopPropagation()}function m(){FAVE.settings.enabled?function(){fastdom.measure(function(){g(".js__video--standard .media__video--thumbnail","click",function(n){p("el__video--standard",jQuery(this).parents(".js__video--standard"),n)}),g(".js__video--expandable .media__video--thumbnail","click",function(n){p("el__video--expandable",jQuery(this).parents(".js__video--expandable"),n)}),g(".js__video__close--standard","click",function(n){f("el__video--standard",jQuery(this),n)}),g(".js__video__close--expandable","click",function(n){f("el__video--expandable",jQuery(this),n)}),fastdom.mutate(function(){jQuery(".el__video--expandfull .el__video__close--standard").show(),jQuery(".el__video--expandfull .el__video__close--expandable").show(),jQuery(".el__video--expandable .el__video__expand--expandable").show(),jQuery(".el__video--standard .el__video__expand--standard").show(),jQuery(".js-video-demand").show()}),d=!1}.bind(this))}():function(){fastdom.measure(function(){CNN.CurrentSize.getClientWidth()>CNN.minWidthForExpandElements?(g(".js__video--standard","click",function(n){p("el__video--standard",jQuery(this),n)}),g(".js__video--expandable","click",function(n){p("el__video--expandable",jQuery(this),n)}),g(".js__video__close--standard","click",function(n){f("el__video--standard",jQuery(this),n)}),g(".js__video__close--expandable","click",function(n){f("el__video--expandable",jQuery(this),n)}),fastdom.mutate(function(){jQuery(".el__video--expandfull .el__video__close--standard").show(),jQuery(".el__video--expandfull .el__video__close--expandable").show(),jQuery(".el__video--expandable .el__video__expand--expandable").show(),jQuery(".el__video--standard .el__video__expand--standard").show(),jQuery(".js-video-demand").show()})):fastdom.mutate(function(){jQuery(".el__video__close--standard").hide(),jQuery(".el__video__expand--standard").hide(),jQuery(".el__video__close--expandable").hide(),jQuery(".el__video__expand--expandable").hide(),!0===CNN.orientationLandscape?jQuery(".js-video-demand").show():jQuery(".js-video-demand").hide()}),!1===d&&!0===CNN.orientationLandscape&&(jQuery(".js__video--standard").each(function(){var n,e=jQuery(this),t=e.find(".js-video-demand");0===e.find(".js-el__video__play-button").length()?(n=e.find(".el__video__expand--standard"),fastdom.mutate(function(n,e){n.hide(),!0===CNN.orientationLandscape&&p("el__video--standard",e,null,!0)}.bind(this,t,n))):fastdom.mutate(function(n){n.show()}.bind(this,t))}),jQuery(".js__video--expandable").each(function(){var n,e=jQuery(this),t=e.find(".js-video-demand");0===e.find(".js-el__video__play-button").length()?(n=e.find(".el__video__expand--expandable"),fastdom.mutate(function(n,e){n.hide(),!0===CNN.orientationLandscape&&p("el__video--expandable",e,null,!0)}.bind(this,t,n))):fastdom.mutate(function(n){n.show()}.bind(this,t))})),d=!1}.bind(this))}()}function h(e,t,i){t.is(".el__gallery--expandfull")||(void 0===n&&(n=t.width()),CNN.CurrentSize.getClientWidth()>CNN.minWidthForExpandElements?fastdom.measure(function(){var n,i,a=t.parents(".el__embedded"),s=t,l=t.find(".el__gallery--teaseimage"),d=t.find(".el-carousel__wrapper"),c=d.find(".js-owl-carousel"),g=d.find(".js-owl-filmstrip"),p=!!d.attr("data-initialized");i=function(n){n.css({opacity:"1",position:"relative","z-index":"0"}),d.attr("data-initialized","true")},fastdom.mutate(function(){d.css({display:"block",visibility:"visible",opacity:"0"}),s.stop().animate({width:a.width()+"px","margin-top":u,"margin-right":0},o,function(){fastdom.mutate(function(){s.css("width","100%"),n=9*a.width()/16/2-r,c.siblings(".ad-slide").find(".ad-slide__prev, .ad-slide__next").css("top",n+"px"),a.addClass("el__embedded--open"),a.css("overflow","hidden"),s.css({"min-height":l.height()+"px","max-height":l.height()+"px"}),setTimeout(function(n,e){fastdom.mutate(function(){n.css({"max-height":1.5*e.height()+"px"}),CNN.Carousel.refreshCarousels()})},100,s,c),!1===p||c.data("owl.carousel").width()!==s.width()?(c.on("resized.owl.carousel",{$wrapper:d},function(n){fastdom.mutate(function(){i(n.data.$wrapper),jQuery(this).off("resized.owl.carousel")}.bind(this))}),g.on("resized.owl.carousel",function(n){fastdom.mutate(function(){CNN.Carousel.owl().setNumberOfItems(n),n.relatedTarget.to(0),jQuery(this).off("resized.owl.carousel")}.bind(this))}),c.data("owl.carousel").onResize(),g.data("owl.carousel").onResize()):i(d),s.addClass("el__gallery--expandfull").removeClass(e),void 0!==d.attr("isExtended")&&"false"!==d.attr("isExtended")||(setTimeout(function(){fastdom.mutate(function(){I(jQuery(d.find(".owl-wrapper-outer")),!0,!0)})},2e3),d.attr("isExtended","true"))}.bind(this))})}.bind(this))}):i.stopPropagation())}function _(e,t,i){fastdom.measure(function(){var i=t.parents(".el__embedded"),r=i.find(".el-carousel__wrapper"),a=r.find(".owl-wrapper-outer").find(".el__gallery-caption"),s=t.parents(".el__gallery--expandfull");fastdom.mutate(function(){i.css({"max-height":"",overflow:""}),r.css({position:"absolute",opacity:0}),i.removeClass("el__embedded--open"),s.css({"min-height":"","max-height":""}),s.stop().animate({width:n,"margin-top":"10px","margin-right":"30px"},o,function(){fastdom.mutate(function(){jQuery(this).addClass(e).removeClass("el__gallery--expandfull")}.bind(this))}),r.attr("isExtended","false"),s.addClass(e).removeClass("el__gallery--expandfull"),a.hasClass("el__gallery-caption--closed")&&(a.toggleClass("el__gallery-caption--closed"),a.text(s.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption"))}.bind(this))}.bind(this)),i.stopPropagation()}function v(){window.innerWidth>CNN.minWidthForExpandElements?(g(".js__gallery--standard","click",function(n){h("el__gallery--standard",jQuery(this),n)}),g(".js__gallery--expandable","click",function(n){h("el__gallery--expandable",jQuery(this),n)}),g(".js__gallery__close--standard","click",function(n){_("el__gallery--standard",jQuery(this),n)}),g(".js__gallery__close--expandable","click",function(n){_("el__gallery--expandable",jQuery(this),n)}),jQuery(".js__gallery__close--standard, .js__gallery__close--expandable").trigger("click"),fastdom.mutate(function(){jQuery(".el-carousel__wrapper").not(jQuery(".zn-large-media .el-carousel__wrapper, .el__embedded--fullstandardwidth .el-carousel__wrapper,.pg-special-article__head .el-carousel__wrapper")).css({opacity:"0",position:"","z-index":""})})):fastdom.mutate(function(){jQuery(".el-carousel__wrapper").css({opacity:"1",position:"relative","z-index":"0"})}),!1===i&&window.innerWidth<=CNN.showGalleryCaptionWidth&&fastdom.measure(function(){jQuery(".js__leafmedia--gallery").each(function(n,e){fastdom.mutate(function(n,e){n.hide(),e.addClass("el__gallery-caption--closed").text("Show Caption")}.bind(this,jQuery(".el__gallery_image-title",e),jQuery(".el__gallery-caption",e)))})})}function I(n,e,t){var i=0,o=0,r=jQuery(".owl-item",n).each(function(){o=jQuery(this).height(),e&&jQuery(this).attr("owlItemHeight",o),o>i&&(i=o)});e&&jQuery(n).attr("max",i),r.each(function(){var i=jQuery(this),o=jQuery(".el__gallery-showhide",i);e||t?o.css("bottom",i.attr("owlItemHeight")-jQuery(n).attr("max")+"px"):o.css("bottom","0px")})}function w(){CNN.CurrentSize.getClientWidth()>CNN.minWidthForExpandElements?(g(".js__image--expandable","click",function(){var n=jQuery(this);fastdom.mutate(function(){var e=n.parents(".el__embedded");e.find(".el__image__close--expandable").show(),n.stop().animate({width:"100%","margin-top":u,"margin-right":0},o,function(){fastdom.mutate(function(){CNN.ResponsiveImages.processChildrenImages(this),e.addClass("el__embedded--open").height(n.outerHeight())}.bind(this))}).show().addClass("el__image--expandfull").removeClass("el__image--expandable")})}),g(".js__image__close--expandable","click",function(n){var e=jQuery(this),i=e.parents(".el__embedded");fastdom.mutate(function(){i.removeClass("el__embedded--open").css("height","auto"),e.hide(),i.find(".js__image--expandable").stop().animate({width:t,"margin-top":"10px","margin-right":"30px"},o,function(){fastdom.mutate(function(){CNN.ResponsiveImages.processChildrenImages(this)}.bind(this))}).show().addClass("el__image--expandable").removeClass("el__image--expandfull")}),n.stopPropagation()}),fastdom.mutate(function(){jQuery(".el__image--expandable .el__image__expand--expandable").show(),jQuery(".el__image--expandfull .el__image__close--expandable").show()})):fastdom.mutate(function(){jQuery(".el__image__close--expandable").hide(),jQuery(".el__image__expand--expandable").hide(),jQuery(".js__image--expandable").off()}),m(),v()}CNN.contentModel=CNN.contentModel||{},CNN.CurrentSize=CNN.CurrentSize||{},CNN.CurrentSize.getClientWidth=CNN.CurrentSize.getClientWidth||jQuery.noop,CNN.minWidthForExpandElements=480,CNN.showGalleryCaptionWidth=640,CNN.orientationLandscape=!1,CNN.adLockingDisableWidth=960,CNN.adLockEnable=!!(c(CNN.AdsConfig)&&!0===CNN.AdsConfig.enableAdLock&&CNN.CurrentSize.getClientWidth()>=CNN.adLockingDisableWidth&&0!==jQuery(".pg-rail.pg-rail-tall__rail").length&&0!==jQuery(".pg-rail-tall__head").length),w(),s?l.on("orientationchange",function(){"function"==typeof CNN.Carousel.resetOnResize&&CNN.Carousel.resetOnResize()}):jQuery(window).resize(function(){i=!0,w(),setTimeout(function(){var n;(n=jQuery(".owl-wrapper-outer"))&&fastdom.mutate(function(){var e,t;for(e=0,t=n.length;e<t;e++)I(n[e],!0,!0)})},2e3)}),function(){var n=0,e=[];function t(t,i){!function(n,e){var t=jQuery(n).children().last(),i=CNN.eventListenerWithOptions&&CNN.eventListenerWithOptions.addListener;function o(){t.removeClass(e)}i(n,"touchstart",function(){t.addClass(e)},{passive:!0}),i(n,"touchcancel",o,{passive:!0}),i(n,"touchend",o,{passive:!0})}(i,e[n].className)}for(e=[{selector:".js__image--expandable",className:"el__image--touchhover"},{selector:".js__video--standard",className:"el__video--touchhover"},{selector:".js__video--expandable",className:"el__video--touchhover"},{selector:".js__gallery--standard",className:"el__gallery--touchhover"},{selector:".js__gallery--expandable",className:"el__gallery--touchhover"}],n=0;n<e.length;n++)jQuery(e[n].selector).each(t)}(),jQuery(".js-el__gallery-caption").on("click",function(){fastdom.measure(function(){var n,e,t;n=jQuery(this).closest(".owl-stage"),e=n.find(".el__gallery_image-title"),t=n.find(".el__gallery-caption"),fastdom.mutate(function(){CNN.CurrentSize.getClientWidth()>CNN.minWidthForExpandElements?t.hasClass("el__gallery-caption--closed")?(t.removeClass("el__gallery-caption--closed"),e.show()):(t.addClass("el__gallery-caption--closed"),e.hide()):(t.toggleClass("el__gallery-caption--closed"),e.toggle()),CNN.Carousel.refreshCarousels(),t.text(t.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption")})}.bind(this))})})}),function(n){"use strict";var e=document.getElementsByTagName("html")[0];e&&e.dataset&&Modernizr&&(Modernizr.phone||Modernizr.mobile?e.dataset.formfactor="mobile":e.dataset.formfactor=Modernizr.tablet?"tablet":"desktop")}()},247:function(n,e){var t,i,o={},r=!1;function a(){"use strict";var n=jQuery(".js-pg-sponsor .owl-stage-outer .owl-stage"),e=n.find(".owl-item").length;n.css("width",70*e)}!function(){"use strict";function n(n){var t=jQuery(".js-pg-sponsor .owl-stage-outer .owl-stage .owl-item.synced"),i=t.next(),o=t.prev();"prev"===n?void 0!==o&&o.length>0&&e(o):void 0!==i&&i.length>0&&e(i)}function e(n){var e=jQuery(".js-pg-sponsor").find(".cnngo-bigPicture"),t=e.find("img"),i=n.find(".link").attr("data-img-full");t.attr("src",i),n.parent().find(".owl-item").removeClass("synced"),n.addClass("synced"),e.find(".js-active-count").html(n.closest(".owl-item").index()+1),e.find(".image__caption").html(n.find(".link").attr("data-value"))}(o={fbFeed:"",twFeed:"",social_hub:{icons:{twitter:"",facebook:"",linkedin:"",google:"",pinterest:"",instagram:""},fb_like:"",tw_follow:""}}).renderAuthor=function(){"string"==typeof o.authorName&&o.authorName.length>0&&((t=jQuery(".js-sponsor-article-author")).find(".js-author_name").text(o.authorName+","),t.show())},o.renderEpic=function(){var n="international"===CNN.contentModel.edition?"cnni":"cnn";"string"!=typeof o.epicAdName||0===o.epicAdName.length||r||(window.AdFuel.queueRegistry(CNN.epicAdRegistry+"/"+n+"_native_"+o.epicAdName+".js"),jQuery(".js-epicAd_Render").show(),r=!0)},o.renderFacebook=function(){var n;"string"==typeof o.fbFeed&&o.fbFeed.length>0&&(n=encodeURIComponent(o.fbFeed),document.getElementById("fb-likebox").innerHTML='<iframe src="//www.facebook.com/plugins/likebox.php?href='+n+'&amp;width=300&amp;height=590&amp;show_faces=true&amp;colorscheme=light&amp;stream=true&amp;show_border=true&amp;header=true&amp;appId=70673860847" scrolling="no" frameborder="0" class="sponsor-content-fb" allowTransparency="true"></iframe>')},o.renderTwitter=function(){var n,e;"string"==typeof o.twFeed&&o.twFeed.length>0&&(jQuery(document.getElementById("tw-feedbox")).html(o.twFeed),jQuery(".js-right-rail-tw").show()),e=document.getElementsByTagName("script")[0],document.getElementById("twitter-wjs")||((n=document.createElement("script")).id="twitter-wjs",n.src="//platform.twitter.com/widgets.js",e.parentNode.insertBefore(n,e)),"string"==typeof o.twitterImage&&o.twitterImage.length>0&&((i=jQuery(".js-twitterImage")).find("img").attr("src",o.twitterImage),i.show())},o.renderGallery=function(){setTimeout(function(){var e,t,i,o,r,s,l,d,u;jQuery(".js-pg-sponsor .owl-carousel").owlCarousel({slideSpeed:300,pagination:!0,paginationSpeed:400,items:9,nav:!0,navText:["",""],dots:!1,lazyLoad:!0,loop:!1,autoWidth:!0,autoHeight:!1}),e=jQuery(".js-pg-sponsor"),t=e.find(".cnngo-bigPicture"),i=t.find("img"),r=(o=e.find(".owl-carousel").find(".link")).first().attr("data-img-full"),s=o.first().attr("data-value"),l=t.attr("data-title"),u=(d=e.find(".owl-stage-outer .owl-stage")).find(".owl-item").length,0===t.find("img").length&&t.append("<img/>"),i.attr("src",r),t.append(e.find(".js-galleryCaption")),t.append(e.find(".js-owl-nav")),u>=1&&(t.find(".js-active-count").html(1),t.find(".js-total-count").html(u),t.find(".js-gallery-title").html(l),t.find(".el__storyelement__gray").html(" "+u+" Photos"),d.find(".owl-item").first().addClass("synced"),t.find(".image__caption").html(s)),o.on("click",function(n){var e=jQuery(this);i.attr("src",e.data("imgFull")),e.parent().parent().find(".owl-item").removeClass("synced"),e.parent().addClass("synced"),t.find(".js-active-count").html(e.closest(".owl-item").index()+1),t.find(".image__caption").html(e.attr("data-value"))}),t.find(".js-el__gallery-caption").click(function(){!function(n,e){var t=jQuery(n).closest(document.getElementById("bigPicture")),i=t.find(".media__caption"),o=t.find(".el__gallery-caption");CNN.CurrentSize=CNN.CurrentSize||{},CNN.CurrentSize.getClientWidth=CNN.CurrentSize.getClientWidth||jQuery.noop,CNN.CurrentSize.getClientWidth()>CNN.minWidthForExpandElements?o.hasClass("el__gallery-caption--closed")?o.removeClass("el__gallery-caption--closed"):o.addClass("el__gallery-caption--closed"):o.toggleClass("el__gallery-caption--closed");i.toggle(e),o.text(o.hasClass("el__gallery-caption--closed")?"Show Caption":"Hide Caption")}(this,"slow")}),t.find(".js-owl-prev").click(function(){n("prev")}),t.find(".js-owl-next").click(function(){n("next")}),a()},800)},jQuery(window).resize(function(){setTimeout(function(){a()},300)})}()},397:function(n,e,t){t(398),t(150),t(151),t(9),t(13),t(188),t(152),t(246),t(247),t(191),document.addEventListener("DOMContentLoaded",function(){window.COMPONENTS&&window.COMPONENTS.length>0&&Promise.all([t.e(38),t.e(39)]).then(t.bind(null,426))})},398:function(n,e,t){!function(n){"use strict";var e,t=Object.prototype,i=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(n,e,t,i){var o=e&&e.prototype instanceof m?e:m,r=Object.create(o.prototype),a=new S(i||[]);return r._invoke=function(n,e,t){var i=u;return function(o,r){if(i===g)throw new Error("Generator is already running");if(i===p){if("throw"===o)throw r;return D()}for(t.method=o,t.arg=r;;){var a=t.delegate;if(a){var s=T(a,t);if(s){if(s===f)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(i===u)throw i=p,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);i=g;var l=d(n,e,t);if("normal"===l.type){if(i=t.done?p:c,l.arg===f)continue;return{value:l.arg,done:t.done}}"throw"===l.type&&(i=p,t.method="throw",t.arg=l.arg)}}}(n,t,a),r}function d(n,e,t){try{return{type:"normal",arg:n.call(e,t)}}catch(n){return{type:"throw",arg:n}}}n.wrap=l;var u="suspendedStart",c="suspendedYield",g="executing",p="completed",f={};function m(){}function h(){}function _(){}var v={};v[r]=function(){return this};var I=Object.getPrototypeOf,w=I&&I(I(C([])));w&&w!==t&&i.call(w,r)&&(v=w);var y=_.prototype=m.prototype=Object.create(v);function b(n){["next","throw","return"].forEach(function(e){n[e]=function(n){return this._invoke(e,n)}})}function E(n){var e;this._invoke=function(t,o){function r(){return new Promise(function(e,r){!function e(t,o,r,a){var s=d(n[t],n,o);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(n){e("next",n,r,a)},function(n){e("throw",n,r,a)}):Promise.resolve(u).then(function(n){l.value=n,r(l)},function(n){return e("throw",n,r,a)})}a(s.arg)}(t,o,e,r)})}return e=e?e.then(r,r):r()}}function T(n,t){var i=n.iterator[t.method];if(i===e){if(t.delegate=null,"throw"===t.method){if(n.iterator.return&&(t.method="return",t.arg=e,T(n,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var o=d(i,n.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,f;var r=o.arg;return r?r.done?(t[n.resultName]=r.value,t.next=n.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,f):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function O(n){var e={tryLoc:n[0]};1 in n&&(e.catchLoc=n[1]),2 in n&&(e.finallyLoc=n[2],e.afterLoc=n[3]),this.tryEntries.push(e)}function A(n){var e=n.completion||{};e.type="normal",delete e.arg,n.completion=e}function S(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(O,this),this.reset(!0)}function C(n){if(n){var t=n[r];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,a=function t(){for(;++o<n.length;)if(i.call(n,o))return t.value=n[o],t.done=!1,t;return t.value=e,t.done=!0,t};return a.next=a}}return{next:D}}function D(){return{value:e,done:!0}}h.prototype=y.constructor=_,_.constructor=h,_[s]=h.displayName="GeneratorFunction",n.isGeneratorFunction=function(n){var e="function"==typeof n&&n.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,_):(n.__proto__=_,s in n||(n[s]="GeneratorFunction")),n.prototype=Object.create(y),n},n.awrap=function(n){return{__await:n}},b(E.prototype),E.prototype[a]=function(){return this},n.AsyncIterator=E,n.async=function(e,t,i,o){var r=new E(l(e,t,i,o));return n.isGeneratorFunction(t)?r:r.next().then(function(n){return n.done?n.value:r.next()})},b(y),y[s]="Generator",y[r]=function(){return this},y.toString=function(){return"[object Generator]"},n.keys=function(n){var e=[];for(var t in n)e.push(t);return e.reverse(),function t(){for(;e.length;){var i=e.pop();if(i in n)return t.value=i,t.done=!1,t}return t.done=!0,t}},n.values=C,S.prototype={constructor:S,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!n)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function o(i,o){return s.type="throw",s.arg=n,t.next=i,o&&(t.method="next",t.arg=e),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),d=i.call(a,"finallyLoc");if(l&&d){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(n,e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===n||"continue"===n)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=n,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(a)},complete:function(n,e){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&e&&(this.next=e),f},finish:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===n)return this.complete(t.completion,t.afterLoc),A(t),f}},catch:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===n){var i=t.completion;if("throw"===i.type){var o=i.arg;A(t)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(n,t,i){return this.delegate={iterator:C(n),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=e),f}}}(n.exports)},5:function(n,e){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(n){"object"==typeof window&&(t=window)}n.exports=t},8:function(n,e){var t,i,o=n.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(n){if(t===setTimeout)return setTimeout(n,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(n,0);try{return t(n,0)}catch(e){try{return t.call(null,n,0)}catch(e){return t.call(this,n,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(n){i=a}}();var l,d=[],u=!1,c=-1;function g(){u&&l&&(u=!1,l.length?d=l.concat(d):c=-1,d.length&&p())}function p(){if(!u){var n=s(g);u=!0;for(var e=d.length;e;){for(l=d,d=[];++c<e;)l&&l[c].run();c=-1,e=d.length}l=null,u=!1,function(n){if(i===clearTimeout)return clearTimeout(n);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(n);try{i(n)}catch(e){try{return i.call(null,n)}catch(e){return i.call(this,n)}}}(n)}}function f(n,e){this.fun=n,this.array=e}function m(){}o.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];d.push(new f(n,e)),1!==d.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(n){return[]},o.binding=function(n){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(n){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},9:function(n,e){function t(n){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}var i=window.CNN||{};i.Utils=i.Utils||function(n,e,o,r){"use strict";var a=36e5,s="Thu, 01 Jan 1970 00:00:00 UTC";function l(n){var e,t,i=!0;for(e=0;e<arguments.length;e++)if((t=arguments[e])===r||null===t){i=!1;break}return i}function d(n){return null!==u(n)}function u(n){var e=new RegExp("(^|;)\\s*"+n+"\\s*=\\s*([^;]+)"),t=o.cookie.match(e);return t?t.pop():null}function c(n,e,t,i,r,s){var d,u,c="";l(n)&&l(e)&&(u=null,"string"==typeof(d=t)&&Date.parse(d)?u=d:"number"==typeof d&&(u=new Date(Date.now()+d*a).toGMTString()),t=u,i=l(i)?i:"/",r=l(r)?r:"",s=!!l(s)&&s,c+=n+"="+encodeURIComponent(e),l(t)&&(c+=";expires="+t),i&&(c+=";path="+i),r&&(c+=";domain="+r),s&&(c+="; secure"),o.cookie=c)}function g(n,e,t){var i="";l(n)&&(e=l(e)?e:"/",t=l(t)?t:"",i+=n+"=;expires="+s,e&&(i+=";path="+e),t&&(i+=";domain="+t),o.cookie=i)}function p(n){if("string"==typeof n&&n.length>0)if(!1===i.hasLocalStorage)g(n);else{try{e.localStorage.removeItem(n),e.localStorage.removeItem(n+"__expires")}catch(n){}try{e.sessionStorage.removeItem(n)}catch(n){}}}return i.hasLocalStorage=function(){var n="__test_it";try{return e.localStorage.setItem(n,n),e.localStorage.removeItem(n),e.sessionStorage.setItem(n,n),e.sessionStorage.removeItem(n),!0}catch(n){return!1}}(),{b64Decode:function(n){var t,i,o,r,a,s,l,d,u=n;if("function"==typeof e.atob)try{t=e.atob(u)}catch(n){console.log(n.message,"\nString to decode: "+u)}else{for(i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),o={},d=0;d<i.length;d++)o[i[d]]=d;for(a="="===(u=u.replace(new RegExp("[^"+i.join("")+"=]","g"),"")).charAt(u.length-1)?"="===u.charAt(u.length-2)?"AA":"A":"",r="",u=u.substr(0,u.length-a.length)+a,s=0;s<u.length;s+=4)l=(o[u.charAt(s)]<<18)+(o[u.charAt(s+1)]<<12)+(o[u.charAt(s+2)]<<6)+o[u.charAt(s+3)],r+=String.fromCharCode(l>>>16&255,l>>>8&255,255&l);t=r.substring(0,r.length-a.length)}return t},b64Encode:function(n){var t,i,o,r,a,s,l=n;if("function"==typeof e.btoa)try{t=e.btoa(l)}catch(i){t=e.btoa(n.replace(/[^\w\+\/]/g,"+"))}else{if(i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),o="",r="",(a=l.length%3)>0)for(;a<3;a++)r+="=",l+="\0";for(a=0;a<l.length;a+=3)a>0&&a/3*4%76==0&&(o+="\r\n"),o+=i[(s=[(s=(l.charCodeAt(a)<<16)+(l.charCodeAt(a+1)<<8)+l.charCodeAt(a+2))>>>18&63,s>>>12&63,s>>>6&63,63&s])[0]]+i[s[1]]+i[s[2]]+i[s[3]];t=o.substring(0,o.length-r.length)+r}return t},cookieExists:d,deleteCNNCookie:function(n){g(n,"/",".cnn.com")},deleteCookie:g,deleteLocalValue:p,exists:l,existsObject:function(n){var e,i,o=!0;for(e=0;e<arguments.length;e++)if("object"!==t(i=arguments[e])||null===i){o=!1;break}return o},existsString:function(n){var e,t,i=!0;for(e=0;e<arguments.length;e++)if(!("string"==typeof(t=arguments[e])&&t.length>0)){i=!1;break}return i},getCookie:u,getCookies:function(){var n,e,t={},i=0;if(o.cookie)for(n=o.cookie.split("; ");i<n.length;i++)t[(e=n[i].split("="))[0]]=decodeURIComponent(e[1])||null;return t},getLocalValue:function(n){var t,o=null;if("string"==typeof n&&n.length>0)try{!1===i.hasLocalStorage?o=u(n):null!==(t=e.localStorage.getItem(n+"__expires"))?parseInt(t,10)>Date.now()?o=e.localStorage.getItem(n):p(n):l(o=e.sessionStorage.getItem(n))||(o=e.localStorage.getItem(n))}catch(n){}return o},hasLocalValue:function(n){if("string"==typeof n&&n.length>0){if(!1===i.hasLocalStorage)return d(n);try{if(l(e.sessionStorage.getItem(n))||l(e.localStorage.getItem(n+"__expires")))return!0}catch(n){}}return!1},isPhone:function(){return e.Modernizr.phone},isWindows7:function(){return/(Windows 7|Windows NT 6.1)/.test(navigator.userAgent)},setCNNCookie:function(n,e,t,i){c(n,e,t,"/",".cnn.com",i)},setCookie:c,storeLocalValue:function(n,t,o){var r;if("string"==typeof n&&n.length>0&&"string"==typeof t)if(!1===i.hasLocalStorage)c(n,t,"session"===o?null:o,"/",".cnn.com",!1);else try{"session"===o?e.sessionStorage.setItem(n,t):(e.localStorage.setItem(n,t),"number"==typeof o?(r=new Date(Date.now()+o*a),e.localStorage.setItem(n+"__expires",r.getTime().toString(10))):"string"==typeof o&&"session"!==o&&(r=new Date(o)).getTime()>Date.now()&&e.localStorage.setItem(n+"__expires",r.getTime().toString(10)))}catch(n){}},stripHash:function(n){return n.replace("#","")},throttle:function(n,e,t){var i=t||this,o=null;return function(){o||(n.apply(i,arguments),o=setTimeout(function(){o=null},e))}}}}(jQuery,window,document)}});